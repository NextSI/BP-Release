define([],function(){return function(a){"use strict";var o=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title=App.lang.agenda_ativos.agenda_ativos_detalhes,this.onclose=null,this.params={agenda_ativo_id:null,tipo:FORMULARIO.NOVO},this.cbo_motivo=this.dialog.find(".cbo_motivo"),this.cbo_local=this.dialog.find(".cbo_local"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.edt_nome=this.dialog.find(".edt_nome"),this.edt_codigo=this.dialog.find(".edt_codigo"),this.chk_bloqueado=this.dialog.find(".chk_bloqueado"),this.show=function(a){switch(o.params=extender_parametros(o.params,a),o.inicializar_componentes(),o.params.tipo){case FORMULARIO.NOVO:o.btn_salvar.show(),o.btn_excluir.hide(),o.permite_alterar(!0),set_focus(o.edt_codigo);break;case FORMULARIO.EDITAR:o.btn_salvar.show(),o.btn_excluir.hide(),o.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:o.btn_salvar.hide(),o.btn_excluir.hide(),o.permite_alterar(!1);break;case FORMULARIO.EXCLUIR:o.btn_salvar.hide(),o.btn_excluir.show(),o.permite_alterar(!1)}null!=o.params.agenda_ativo_id&&o.preencher()},this.preencher=function(){WS.get({route:"agenda_ativo/objeto/",data:{agenda_ativo_id:o.params.agenda_ativo_id},func_response:function(a){if(a){var i=extender_parametros({codigo:"",nome:"",agenda_motivo_id:0,agenda_local_id:0,bloqueado:!1},a);o.edt_codigo.val(i.codigo),o.edt_nome.val(i.nome),o.listar_tipo_agenda(i.agenda_motivo_id),o.listar_local_agenda(i.agenda_local_id),o.chk_bloqueado.prop("checked",i.bloqueado).trigger("change")}}})},this.permite_alterar=function(a){o.edt_nome.prop("readonly",!a),o.edt_codigo.prop("readonly",!a),o.cbo_local.prop("disabled",!a),o.cbo_motivo.prop("disabled",!a),o.chk_bloqueado.prop("disabled",!a)},this.close=function(){void 0!==o.onclose&&o.onclose&&o.onclose()},this.unload=function(){o.close(),View.unload(this.html_id)},this.listar_tipo_agenda=function(a){o.cbo_motivo.find("option").remove(),WS.get("tipo_agenda/listar/",null,function(i){for(var e=0;e<i.length;e++){var t=i[e];add_option(o.cbo_motivo,t.tipo_agenda_id,t.nome)}a&&o.cbo_motivo.val(a),o.cbo_motivo.selectpicker("refresh")})},this.listar_local_agenda=function(a){o.cbo_local.find("option").remove(),WS.get("local_agenda/listar/",null,function(i){for(var e=0;e<i.data.length;e++){var t=i.data[e];add_option(o.cbo_local,t.id,t.nome)}a&&o.cbo_local.val(a),o.cbo_local.selectpicker("refresh")})},this.inicializar_componentes=function(){o.listar_local_agenda(),o.listar_tipo_agenda()},this.btn_salvar.unbind("click").click(function(a){var i={agenda_ativo_id:o.params.agenda_ativo_id,nome:o.edt_nome.val(),codigo:o.edt_codigo.val(),agenda_motivo_id:o.cbo_motivo.val(),agenda_local_id:o.cbo_local.val(),bloqueado:o.chk_bloqueado.prop("checked")},e=extender_parametros({agenda_ativo_id:null,nome:null,codigo:null,agenda_motivo_id:null,agenda_local_id:null,bloqueado:!1},i);WS.post({route:"agenda_ativo/salvar",data:e,type:"POST",func_response:function(a){a&&(alert_saved(e.nome+" "+App.lang.alert_saved.salvo),o.unload())},disable_buttons:[o.btn_salvar,o.btn_cancelar]})}),this.btn_excluir.unbind("click").click(function(a){WS.post({route:"agenda_ativo/excluir",data:{agenda_ativo_id:o.params.agenda_ativo_id},type:"POST",func_response:function(a){a&&(alert_saved(o.edt_nome.val()+" "+App.lang.alert_saved.excluido),o.unload())},disable_buttons:[o.btn_excluir,o.btn_cancelar]})}),this.btn_cancelar.unbind("click").click(function(a){o.unload()})}});