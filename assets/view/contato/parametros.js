define([],function(){return function(i){"use strict";var o=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.onselect=null,this.onclose=null,this.modal_body=this.dialog.find(".modal-body"),this.edt_nome=this.dialog.find(".edt_nome"),this.edt_email=this.dialog.find(".edt_email"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_pesquisar=this.dialog.find(".btn_pesquisar"),this.campo_dinamico=[],this.show=function(i,e,t,l){void 0!==e&&""!=e.trim()&&null!=e&&o.edt_nome.val(e.trim()),void 0!==t&&""!=t.trim()&&null!=t&&o.edt_email.val(t.trim()),o.onselect=i,show_modal(o.modal.attr("id")),o.render_campo_pesquisa(l),set_focus(o.edt_nome)},this.render_campo_pesquisa=function(i){var e="",t="";WS.get("formulario_contato/get_formulario/",null,function(l){$(l.grupos).each(function(l,n){$(n.elementos).each(function(l,n){if(n.tipo!=ELEMENTO_TIPO.OPCOES?(e=n.tipo==ELEMENTO_TIPO.DATA?"date":"text",t='<input type="'+e+'" class="'+n.id_elemento+' form-control" id="'+n.id_elemento+'" maxlength="50" placeholder="Filtro por '+n.nome+'">'):t=n.tipo_lista_opcoes==TIPO_LISTA_OPCOES.OPTION_MULTIPLAS?'<select title="" type="select" class="formulario_campo form-control selectpicker vld_lista_option_multiplas '+n.id_elemento+'"  multiple id="'+n.id_elemento+'">':'<select type="select" class="formulario_campo form-control id_elemento vld_lista_option '+n.id_elemento+'" id="'+n.id_elemento+'">',"S"==n.utiliza_filtro){var a=$('<div class="row"><div class="col-md-12 col-sm-12"><div class="form-group"><label for="'+n.id_elemento+'">'+n.nome+"</label>"+t+"</div></div></div>");if(a.appendTo(o.modal_body),o.campo_dinamico.push({id_elemento:n.id_elemento,option:n.tipo==ELEMENTO_TIPO.OPCOES}),n.tipo==ELEMENTO_TIPO.OPCOES){var d=a.find("select");add_option(d,"",""),$(n.opcoes).each(function(i,o){add_option(d,o,o)}),n.tipo_lista_opcoes==TIPO_LISTA_OPCOES.OPTION_MULTIPLAS&&d.selectpicker("refresh")}App.aplicar_mascaras(a),i&&$(i).each(function(i,o){o.id_elemento==n.id_elemento&&o.valor&&(n.tipo_lista_opcoes==TIPO_LISTA_OPCOES.OPTION_MULTIPLAS?$(document).find("."+o.id_elemento).val(o.valor).trigger({type:"change",execute:!0}).selectpicker("refresh"):$(document).find("."+o.id_elemento).val(o.valor))})}})})})},this.close=function(){close_modal(o.modal.attr("id")),void 0!==o.onclose&&o.onclose&&o.onclose()},this.unload=function(){o.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){o.unload()}),this.btn_pesquisar.unbind("click"),this.btn_pesquisar.click(function(){$(o.campo_dinamico).each(function(i,e){o.campo_dinamico[i].valor=o.modal_body.find("#"+e.id_elemento).val()});var i={nome:o.edt_nome.val(),email:o.edt_email.val(),campo_dinamico:o.campo_dinamico};o.onselect(i),o.unload()})}});