define([],function(){return function(t){var o=this;this.html_id=t,this.dialog=$("#"+this.html_id),this.title="Status de Projeto",this.dx_grid_projeto_status=this.dialog.find(".dx_grid_projeto_status"),this.arr_projeto_status=[],this.datagrid=null,this.show=function(){o.listar()},this.listar=function(){var t=function(){WS.get("projeto_status/listar/",null,function(t){o.arr_projeto_status=t,o.monta_grid()})};o.datagrid&&o.datagrid.getController("editing").getChanges().length?alert_modal("Aviso","Você possui alterações no grid. Deseja atualizar mesmo assim?","Sim",function(){t()},!0,"Cancelar",null,function(){}):t()},this.monta_grid=function(){var t=document.createElement("div");t.className="div_grid_projeto_status",t.style="min-width: 100%;",o.dx_grid_projeto_status.find(".div_grid_projeto_status").remove(),o.dx_grid_projeto_status[0].appendChild(t);var a=detectmob()?"select":"dragAndDrop",e=get_icon_class();o.dx_grid_projeto_status.find(".div_grid_projeto_status").css("height","calc(100vh - 42px)"),o.datagrid=o.dx_grid_projeto_status.find(".div_grid_projeto_status").dxDataGrid({dataSource:o.arr_projeto_status,allowColumnReordering:!0,showBorders:!0,columnResizingMode:"widget",rowAlternationEnabled:!1,searchPanel:{visible:!detectmob(),width:200,placeholder:"Pesquisa geral"},paging:{pageSize:20},pager:{showPageSizeSelector:!0,allowedPageSizes:[20,50,100],showInfo:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnChooser:{enabled:!0,allowSearch:!0,mode:a},focusedRowEnabled:!1,editing:{useIcons:!0,mode:"batch",allowUpdating:!0},stateStoring:{enabled:!0,type:"custom",customLoad:function(){return App.get_parametro_usuario("listagem_projeto_status")},customSave:function(t){App.set_parametro_usuario("listagem_projeto_status",t)}},selection:{mode:"multiple"},export:{enabled:!0,fileName:"Relatório de status de projetos "+agora(),allowExportSelectedData:!0},filterRow:{visible:!0,applyFilter:"auto"},headerFilter:{visible:!0},filterPanel:{visible:!0},sorting:{mode:"multiple"},onInitNewRow:function(t){t.data.posicionamento_diario=!1,t.data.utilizado_timeline=!1},onEditingStart:function(t){"S"===t.data.padrao&&(t.cancel=!0)},onToolbarPreparing:function(t){var a=[{widget:"dxButton",options:{icon:"fa fa-plus",hint:"Adicionar um status de projeto",text:"Adicionar um status de projeto",onClick:function(){o.datagrid.addRow()}},location:"after",name:"BtnNovoRegistro",locateInMenu:"auto"},{widget:"dxButton",options:{icon:"fa fa-sync",hint:"Recarregar listagem de status de projeto",text:"Recarregar listagem de status de projeto",onClick:function(){o.listar()}},showText:"inMenu",location:"after",name:"BtnRefresh",locateInMenu:"auto"}];t.toolbarOptions.items=add_botao_dx_toolbar(a,t.toolbarOptions.items);for(var e=0;e<t.toolbarOptions.items.length;e++){var i=t.toolbarOptions.items[e];"saveButton"===i.name&&(i.options.onClick=function(t){var a=o.datagrid.getController("editing").getChanges();o.salvar(a)})}},onContentReady:function(t){add_filtro_cor_tema(t)},columns:[{caption:"Descrição",dataField:"descricao"},{caption:"Cor de Fundo",dataField:"cor",width:180,cellTemplate:function(t,a){$("<div>").dxColorBox({onInitialized:function(t){t.component.option("disabled","S"==a.data.padrao),t.component.option("value",a.data.cor)},onValueChanged:function(t){o.datagrid.cellValue(a.rowIndex,"cor",t.value)}}).appendTo(t)},alignment:"center",allowEditing:!1},{caption:"Cor da Fonte",dataField:"cor_fonte",width:180,cellTemplate:function(t,a){$("<div>").dxColorBox({onInitialized:function(t){t.component.option("disabled","S"==a.data.padrao),t.component.option("value",a.data.cor_fonte)},onValueChanged:function(t){o.datagrid.cellValue(a.rowIndex,"cor_fonte",t.value)}}).appendTo(t)},alignment:"center",allowEditing:!1},{caption:"Utilizado na Timeline ?",dataField:"utilizado_timeline",width:180,alignment:"center",dataType:"boolean"},{caption:"Enviar no posicionamento diário do usuário",dataField:"posicionamento_diario",width:200,alignment:"center",dataType:"boolean"},{type:"buttons",buttons:[{hint:"Apagar registro",icon:"fa fa-trash",cssClass:e,visible:function(t){return!t.row.removed&&"N"==t.row.data.padrao},onClick:function(t){o.datagrid.deleteRow(t.row.rowIndex)}},{hint:"Recuperar registro",icon:"fa fa-undo",cssClass:e,visible:function(t){return t.row.removed},onClick:function(t){o.datagrid.undeleteRow(t.row.rowIndex),t.event.preventDefault()}}]}]}).dxDataGrid("instance")},event_salvar(o.dialog,o.dx_grid_projeto_status),event_desfazer(o.dialog,o.dx_grid_projeto_status),this.salvar=function(t){WS.post("projeto_status/salvar",{arr_projeto_status:CircularJSON.stringify(t)},function(t){alert_tooltip("Todos os status foram salvos com sucesso!","success",500),o.datagrid.saveEditData(),o.listar()})}}});