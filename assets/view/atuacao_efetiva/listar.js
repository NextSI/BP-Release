define([],function(){return function(a){"use strict";var o=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Atuação Efetiva",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_limpar_filtro=this.dialog.find(".btn_limpar_filtro"),this.edt_pesq_codigo=this.dialog.find(".edt_pesq_codigo"),this.btn_pesquisa_codigo=this.dialog.find(".btn_pesquisa_codigo"),this.div_cbo_autor=this.dialog.find(".div_cbo_autor"),this.cbo_autor=this.dialog.find(".cbo_autor"),this.cbo_status=this.dialog.find(".cbo_status"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_competencias=this.dialog.find(".btn_competencias"),this.btn_nova_versao=this.dialog.find(".btn_nova_versao"),this.btn_listar=this.dialog.find(".btn_listar"),this.box_atuacao=this.dialog.find(".box_atuacao"),this.boxes=this.dialog.find(".boxes"),this.btn_tutorial=this.dialog.find(".btn_tutorial"),this.btn_help=this.dialog.find(".btn_help"),this.btn_tela_aprovacao=this.dialog.find(".btn_tela_aprovacao"),this.div_aprovacao=this.dialog.find(".div_aprovacao"),this.filtro={},this.atuacao_efetiva_escolha_funcao=null,this.listar=function(){var a=$("<div class='row' style='padding-left: 28px; padding-right: 28px;'></div>"),t=0;o.tab_listagem.find("tbody").find("tr:first"),1==App.sessao.dados.admin||"S"==App.sessao.dados.supervisor_empenho?o.div_aprovacao.removeClass("hidden"):o.div_cbo_autor.addClass("hidden");var i=o.box_atuacao;o.boxes.empty(),a.remove(),WS.get("atuacao_efetiva/listar/",{filtro:o.filtro},function(e){$(e).each(function(e,s){!function(e){var s=i.clone();s.removeAttr("template-box"),s.attr("data-atuacao-efetiva-id",e.atuacao_efetiva_id),s.attr("data-indicador-id",e.indicador),s.css("display","");var n=$(s.find("[template-field='indicador']"));$(s.find("[template-titulo-atuacao]")).text(null!=e.nome_funcao?e.nome_funcao:""),WS.get("atuacao_efetiva_indicador/listar/",{atuacao_efetiva_id:e.atuacao_efetiva_id,indicador_escolhido:"S"},function(a){var t=0,i=a.length;a.length>0?$.each(a,function(a,i){var e="";if("S"==i.finalizado)t++,e=" - Finalizado";else if("S"==i.iniciado)e=" - Em Andamento";else switch(i.status){case STATUS_INDICADORES.NAO_INICIADO:e=" - Não Iniciado";break;case STATUS_INDICADORES.PARCIAL:e=" - Parcial";break;case STATUS_INDICADORES.EM_ANDAMENTO:e=" - Em Andamento";break;case STATUS_INDICADORES.EM_APROVACAO:e=" - Em Aprovação";break;case STATUS_INDICADORES.NAO_APROVADO:e=" - Não Aprovado";break;default:e=" - Não Iniciado"}var c=$('<button class="btn btn-link btn-block truncate">'+i.nome+e+"</button>");c.click(function(a){View.load("atuacao_efetiva/passos_indicador",function(a,t){t.show(i.atuacao_efetiva_id,i.id),t.onclose=function(){o.listar(),o.listar_filtro_responsavel()}},View.ABA.MULTIPLAS)}),s.find(".box-loader").fadeOut(1e3),n.append(c)}):s.find(".box-loader").fadeOut(1e3);var c=$(s.find(".btn_concluir"));t==i&&i>0&&(c.css("display",""),"S"==e.concluida&&c.addClass("hidden"),c.unbind("click"),c.click(function(){alert_modal("Atuação Efetiva",'Tem certeza que deseja marcar esta Matriz como "Concluída".',"Sim",function(){WS.post("atuacao_efetiva/concluir_matriz",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){alert_saved("salvo com sucesso"),o.listar()})},!0,"Não")}))});var c,r=$(s.find("[template-field='id']"));c="N. #"+(+e.versao_base>0?e.versao_base:e.atuacao_efetiva_id)+" - Ver. #"+(+e.versao_controle>0?e.versao_controle:1),r.text(c),$(s.find("[template-field='autor']")).html("<b>Autor:</b> "+e.autor),$(s.find("[template-field='data_inicio']")).html(""==e.data_inicio?"-":"<b>Início: </b>"+e.data_inicio.format_date()),$(s.find("[template-field='data_conclusao']")).text(""==e.data_conclusao?"-":e.data_conclusao.format_date());var d=s.find(".box .box-info, .box .box-header");d.css("cursor","pointer").unbind("click").click(function(a){View.load("atuacao_efetiva/passos_atuacao_efetiva",function(a,t){t.show(e.indicador_id,e.atuacao_efetiva_id),t.onclose=function(){o.listar()}},View.ABA.MULTIPLAS)});var l=$(s.find(".btn_editar"));$(s.find(".actions")),l.unbind("click"),l.click(o.acoes_metas),s.dblclick(o.acoes_metas);var u=$(s.find(".btn_nova_versao"));"S"==e.concluida&&0==!!e.versao_base&&(u.css("display",""),u.unbind("click"),u.click(function(a){alert_modal("Atuação Efetiva","Tem certeza que deseja gerar uma nova versão para esta matriz?.","Sim",function(){WS.post("atuacao_efetiva/nova_versao/",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){alert_saved("versão gerada com sucesso."),o.listar()})},!0,"Não")}));var _=$(s.find(".btn_excluir"));_.unbind("click"),_.click(function(){alert_modal("Atuação Efetiva","Tem certeza que deseja excluir esta Matriz de Atuação Efetiva? Esta ação não poderá ser desfeita.","Sim",function(){WS.post("atuacao_efetiva/excluir",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){alert_saved("Excluído com sucesso"),o.listar()})},!0,"Não")}),(App.sessao.dados.admin||"S"==App.sessao.dados.supervisor_empenho)&&App.sessao.dados.usuario_id==e.usuario_id&&(s.append("<span style='position: absolute;top: 5px;left: 20px;color: white;'class='glyphicon glyphicon-star'></span>"),d.css({background:"rgb(100, 69, 69)"})),3==t?((a=a.clone()).children().remove(),t=0,s.appendTo(a),t++):(t++,s.appendTo(a)),a.appendTo(o.boxes)}(s)})}),WS.get("atuacao_efetiva/get_parametros/",null,function(a){o.atuacao_efetiva_escolha_funcao="S"==a.atuacao_efetiva_escolha_funcao})},this.acoes_metas=function(a){var t=$(this).closest(".box_atuacao"),i=t.attr("data-atuacao-efetiva-id"),e=t.attr("data-indicador-id");View.load("atuacao_efetiva/passos_atuacao_efetiva",function(a,t){t.show(e,i),t.onclose=function(){o.listar()}},View.ABA.MULTIPLAS)},this.listar_filtro_responsavel=function(a){o.cbo_autor.find("option").remove(),add_option(o.cbo_autor,"-1","Todos"),WS.get("supervisor/listar_supervisionados/",{usuario_supervisor:App.sessao.dados.usuario_id,modulo:"empenho"},function(t){for(var i=0;i<t.length;i++){var e=t[i];add_option(o.cbo_autor,e.supervisionado_id,e.supervisionado_nome)}a&&o.cbo_autor.val(a).trigger("change"),o.cbo_autor.selectpicker("refresh")})},o.cbo_autor.unbind("change"),o.cbo_autor.change(function(a){o.filtro.usuario_id=o.cbo_autor.val(),o.listar()}),o.edt_pesq_codigo.unbind("click"),o.edt_pesq_codigo.keypress(function(a){13==a.keyCode&&o.btn_pesquisa_codigo.click()}),o.btn_limpar_filtro.unbind("click"),o.btn_limpar_filtro.click(function(){o.filtro={},o.cbo_autor.val("-1"),o.cbo_autor.selectpicker("refresh"),o.cbo_status.val("-1"),o.cbo_status.selectpicker("refresh"),o.edt_pesq_codigo.val(""),o.listar()}),o.cbo_status.unbind("change"),o.cbo_status.change(function(a){o.filtro.status=o.cbo_status.val(),o.listar()}),o.btn_pesquisa_codigo.unbind("click"),o.btn_pesquisa_codigo.click(function(){o.filtro.codigo_atuacao=o.edt_pesq_codigo.val(),o.listar()}),o.btn_tela_aprovacao.unbind("click"),o.btn_tela_aprovacao.click(function(a){View.load("aprovacao_metas/listar",function(a,o){o.listar()},View.ABA.SIM)}),this.btn_novo.unbind("click"),this.btn_novo.click(function(){o.atuacao_efetiva_escolha_funcao?View.load("atuacao_efetiva/escolha_funcao",function(a,t){t.show(),t.onclose=function(){o.listar()}},View.ABA.NAO):alert_modal("Atuação Efetiva","Deseja iniciar o preenchimento da matriz de atuação efetiva? (a sua primeira ou uma nova se for o caso).","Sim",function(){WS.post("atuacao_efetiva/salvar",null,function(a){alert_saved("Salvo com sucesso"),View.load("atuacao_efetiva/passos_atuacao_efetiva",function(t,i){i.show(a.atuacao_efetiva_indicador_id,a.id),i.onclose=function(){o.listar()}},View.ABA.MULTIPLAS),void 0!==o.onsave&&o.onsave&&o.onsave(a)})},!0,"Não",null,function(){o.listar()})}),this.btn_competencias.unbind("click"),this.btn_competencias.click(function(a){View.load("competencias_essenciais/listar",function(a,o){o.listar()},View.ABA.SIM)}),this.btn_tutorial.unbind("click"),this.btn_tutorial.click(function(a){var o=$('<h3 style="text-align: center; background: #cecece; padding: 10px;">INTRODUÇÃO</h3>                <p><strong style="font-size: 25px;">S</strong>eja muito bem-vindo ao processo de gestão efetiva de empenho e potencial humano. Este processo tem como objetivo, criar uma sinergia e simetria de ações entre você seu Superior Imediato, que juntos, poderão descobrir novas formas de fazer mais, melhor, mais rápido e com menos.                <br><br><strong style="font-size: 25px;">P</strong>or isso, entre de cabeça e se dedique ao Maximo, procurando ser o mais ESPECIFICO,  transparente e real possível, pois só assim, o processo irá lhe ajudar verdadeiramente.                <br><br><strong style="font-size: 25px;">B</strong>oa sorte! Lembrando que sorte é o encontro de oportunidade com preparação! <br><br>                 <strong>Time Net Profit Brasil</strong></p>                <br><br>Caso queira abrir novamente esta tela, Clique no botão:                <button type="button" class="btn btn-default btn_tutorial">                    <span class="glyphicon glyphicon-info-sign"></span>                </button>                Na canto superior direito da tela                ');View.load("atuacao_efetiva/tutorial",function(a,t){t.show(o,"Atuacão Efetiva","atuacao")},View.ABA.NAO)}),this.btn_help.unbind("click"),this.btn_help.click(function(a){var o=$('<h3 style="text-align: center; background: #cecece; padding: 10px;">COMEÇANDO...</h3>                 <p><strong style="font-size: 25px;">E</strong>sse é o primeiro passo!                  <br><br><p><strong style="font-size: 25px;">E</strong>ntre e aprenda a fazer um mapa da sua atuação efetiva e o ajudará a elaborar planos de ações rápidas, simples, mas que poderão fazer toda a diferença em seus resultados a curto, médio e longo prazo.                 <br><br><p><strong style="font-size: 25px;">L</strong>embrando que este é uma “FOTO DENTRO DE UM FILME.”. O que quer dizer que deverá ser alinhada com seu superior imediato (caso tenha) e revisada a cada 30 dias no máximo, ou em alguns casos de mudança de função ou de alterações significativas em suas responsabilidades, deverá ser refeita totalmente do zero.                <br><br><p><strong style="font-size: 25px;">V</strong>ocê levará em torno de 30 minutos para criação da mesma. Em caso de dúvidas, consulte o tutorial ou entre em contato com seu Superior Imediato ou suporte técnico que iremos lhe ajudar.</p>                 <br><br>Caso queira abrir novamente esta tela, Clique no botão:                <button type="button" class="btn btn-default btn_tutorial">                    <span class="glyphicon glyphicon-question-sign"></span>                </button>                Na canto superior direito da tela                ');View.load("atuacao_efetiva/tutorial",function(a,t){t.show(o,"Atuacão Efetiva")},View.ABA.NAO)}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){o.listar()}),this.unload=function(){o.close(),View.unload(this.html_id)},this.close=function(){void 0!==o.onclose&&o.onclose&&o.onclose()},o.listar(),o.listar_filtro_responsavel(),App.get_parametro_usuario("empenho").exibir_tutorial_atuacao_efetiva&&this.btn_tutorial.trigger("click")}});