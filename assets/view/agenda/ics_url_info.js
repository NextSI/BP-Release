define([],function(){return function(i){"use strict";var n=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.btn_ok=this.dialog.find(".btn_ok"),this.btn_copiar=this.dialog.find(".btn_copiar"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_redefinir=this.dialog.find(".btn_redefinir"),this.input_url_agenda=this.dialog.find(".input_url_agenda"),this.usuario_id=!1,this.show=function(i){n.usuario_id=i,n.get_chave(),show_modal(n.modal.attr("id")),set_focus(n.edt_nome)},this.get_chave=function(){WS.get("agenda_evento/get_ics_url/",{usuario_id:n.usuario_id},function(i){""!=i.url?n.input_url_agenda.val(i.url):WS.post("agenda_evento/gerar_ics_url/",{usuario_id:n.usuario_id},function(i){n.input_url_agenda.val(i.url)})})},this.close=function(){close_modal(n.modal.attr("id")),void 0!==n.onclose&&n.onclose&&n.onclose()},this.btn_ok.unbind("click"),this.btn_ok.click(function(i){n.unload()}),this.btn_copiar.unbind("click"),this.btn_copiar.click(function(i){n.input_url_agenda.select(),document.execCommand("copy"),alert_saved("Texto copiado para área de transferência.")}),this.btn_redefinir.click(function(i){alert_modal("Aviso","Atenção, ao redefinir a URL, todas suas agendas com a URL atual, serão invalidadas, deseja continuar?","Sim",function(){WS.post("agenda_evento/gerar_ics_url/",{usuario_id:n.usuario_id},function(i){n.input_url_agenda.val(i.url)})},!0,"Não",null,function(){})}),this.btn_ok.unbind("click"),this.btn_ok.click(function(){n.unload()}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){n.unload()}),this.unload=function(){n.close(),View.unload(this.html_id)}}});