var t;define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Grupo",this.div_com_sessao=this.dialog.find(".div_com_sessao"),this.div_social=this.dialog.find(".div_social"),this.logo_titulo_social=this.dialog.find(".logo_titulo_social"),this.lbl_img_titulo_social=this.dialog.find(".lbl_img_titulo_social"),this.lbl_titulo_social=this.dialog.find(".lbl_titulo_social"),this.nome_grupo_titulo=this.dialog.find(".nome_grupo_titulo"),this.carrega_img_grupo=this.dialog.find(".carrega_img_grupo"),this.btn_editar_grupo=this.dialog.find(".btn_editar_grupo"),this.btn_participar=this.dialog.find(".btn_participar"),this.btn_sair_grupo=this.dialog.find(".btn_sair_grupo"),this.privacidade_grupo=this.dialog.find(".privacidade_grupo"),this.div_administradores=this.dialog.find(".div_administradores"),this.administrador_grupo=this.dialog.find(".administrador_grupo"),this.corpo_publicacao=this.dialog.find(".corpo_publicacao"),this.div_membros=this.dialog.find(".div_membros"),this.div_solicitacao=this.dialog.find(".div_solicitacao"),this.texto_aprovacao=this.dialog.find(".texto_aprovacao"),this.div_pesquisa_perfil=this.dialog.find(".div_pesquisa_perfil"),this.cbo_pesquisa_perfil=this.dialog.find(".cbo_pesquisa_perfil"),this.edt_pesquisa_perfil=null,this.btn_todos_membro_grupo=this.dialog.find(".btn_todos_membro_grupo"),this.div_membros_grupo=this.dialog.find(".div_membros_grupo"),this.div_solicitacoes=this.dialog.find(".div_solicitacoes"),this.div_listas_discussao=this.dialog.find(".div_listas_discussao"),this.btn_nova_lista_discussao=this.dialog.find(".btn_nova_lista_discussao"),this.btn_listas_discussao=this.dialog.find(".btn_listas_discussao"),this.div_btn_listas_discussao=this.dialog.find(".div_btn_listas_discussao"),this.btn_todos_solicitacao=this.dialog.find(".btn_todos_solicitacao"),this.btn_todos_solicitacao_grupo=this.dialog.find(".btn_todos_solicitacao_grupo"),this.painel_mensagem_mural=this.dialog.find(".painel_mensagem_mural"),this.list_mural=this.dialog.find(".list_mural"),this.div_load=this.dialog.find(".div_load"),this.edt_mensagem=this.dialog.find(".edt_mensagem"),this.div_btn_publicacao=this.dialog.find(".div_btn_publicacao"),this.btn_cancelar_publicacao=this.dialog.find(".btn_cancelar_publicacao"),this.btn_publicacao=this.dialog.find(".btn_publicacao"),this.btn_refresh=this.dialog.find(".btn_refresh"),this.div_mural_nova_votacao=this.dialog.find(".div_mural_nova_votacao"),this.div_nova_votacao=this.dialog.find(".div_nova_votacao"),this.react_component_nova_votacao=null,this.btn_menu_editar_mensagem=this.dialog.find(".btn_menu_editar_mensagem"),this.div_publicacao=this.dialog.find(".div_publicacao"),this.lbl_count_membros=this.dialog.find(".lbl_count_membros"),this.lbl_count_listas_discussao=this.dialog.find(".lbl_count_listas_discussao"),this.lbl_count_solicitacao=this.dialog.find(".lbl_count_solicitacao"),this.div_forum=this.dialog.find(".div_forum"),this.btn_todas_listas_discussao=this.dialog.find(".btn_todas_listas_discussao"),this.div_marcar=this.dialog.find(".div_marcar"),this.div_marcar_resposta=this.dialog.find(".div_marcar_resposta"),this.div_mensagem_publica=this.dialog.find(".div_mensagem_publica"),this.chk_mensagem_publica=this.dialog.find(".chk_mensagem_publica"),this.chk_permite_comentario=this.dialog.find(".chk_permite_comentario"),this.chk_votacao=this.dialog.find(".chk_votacao"),this.btn_anexo_perfil=this.dialog.find(".btn_anexo_perfil"),this.div_anexos_publicacao=this.dialog.find(".div_anexos_publicacao"),this.div_anexos_row=this.dialog.find(".div_anexos_row"),this.panel_anexos=this.dialog.find(".panel_anexos"),this.div_mostrar_anexo=this.dialog.find(".div_mostrar_anexo"),this.btn_mostrar_mais_mensagem=this.dialog.find(".btn_mostrar_mais_mensagem"),this.logo_id=null,this.usuario_id_logado=null,this.grupo_id=null,this.privacidade=null,this.arr_mural=[],this.arr_mural_comentario=[],this.arr_time_line=[],this.ultima_mensagem_mural_id=null,this.nova_mensagem_mural=!1,this.maior_id=null,this.mensagem_id=null,this.numero_anexo=null,this.anexo_array=[],this.anexo_fotos=[],this.anexo=[],this.usuario_logado_grupo=null,this.usuario_logado_membro=null,this.admin_logado=null,this.count_membro=null,this.count_solicitacao=null,this.flag=null,this.logado_por_grupo_usuario=null,this.logado_por_motivo_chamado=null,this.count_listas=null,this.autorizado_publicar_logado=null,this.arr_usuario_marcado=[],this.arr_usuario_marcado_aux=[],this.grupo_nome=null,this.nova_votacao=null;var o=zebra_color();this.show=function(a,o){App.sessao?(i.div_com_sessao.show(),i.lbl_img_titulo_social.show(),i.lbl_titulo_social.text("Social")):(i.logo_titulo_social.show(),i.div_social.removeClass("col-md-7 col-lg-7")),void 0===o||""==o?(i.grupo_id=a,i.usuario_id_logado=App.sessao?App.sessao.usuario_id:null,i.listar_dados_grupo(a),i.usuario_id_logado>0&&(i.edt_mensagem.attr("id","edt_mensagem"+i.html_id),null==i.edt_pesquisa_perfil&&(create_combobox(i.cbo_pesquisa_perfil,i.listar_perfil),i.edt_pesquisa_perfil=i.cbo_pesquisa_perfil.parent().find(".edt_combobox"),i.edt_pesquisa_perfil.keypress(function(a){if(13==a.keyCode){var o=i.cbo_pesquisa_perfil.parent().find(".ncbo_scroll").find(".row_selected").attr("id_registro");i.usuario_id_selecionado=o;var s=$(this);"U"==(s.attr("dados-adicionais")?s.attr("dados-adicionais"):null)?View.load("perfil/listar",function(a,o){o.show(i.usuario_id_selecionado,!0)},View.ABA.MULTIPLAS):View.load("grupo_rede_social_pagina/listar",function(a,o){o.show(i.usuario_id_selecionado)},View.ABA.MULTIPLAS)}})))):WS.get("grupos_rede_social/obter_id/",{link_sufixo:o},function(a){i.show(a.id)})},this.listar_dados_grupo=function(a,o){var s="",e=[],n=[],t=[];1==(o=o)&&(i.div_membros_grupo.find(".class-rows-membros").remove(),i.div_solicitacoes.find(".class-rows-solicitacao").remove(),i.div_forum.find(".class-rows-listas-discussao").remove(),i.count_solicitacao=0,i.count_membro=0),WS.get("grupos_rede_social/listar_info_grupo/",{grupo_id:a,limite:0},function(a){i.privacidade=a.privado,i.usuario_logado_membro=a.usuario_logado_membro,i.usuario_logado_grupo=a.usuario_logado_grupo,i.admin_logado=a.admin_logado,i.count_membro=a.count_membro,i.count_solicitacao=a.count_solicitacao,i.logado_por_motivo_chamado=a.logado_por_motivo_chamado,i.logado_por_grupo_usuario=a.logado_por_grupo_usuario,i.count_listas=a.count_listas,i.autorizado_publicar_logado=a.autorizado_publicar_logado,App.sessao&&"S"==a.listas_discussao?(i.div_listas_discussao.hasClass("hidden")&&i.div_listas_discussao.removeClass("hidden"),i.btn_listas_discussao.hasClass("hidden")&&i.btn_listas_discussao.removeClass("hidden"),i.btn_nova_lista_discussao.hasClass("hidden")||i.btn_nova_lista_discussao.addClass("hidden")):(i.div_listas_discussao.hasClass("hidden")||i.div_listas_discussao.addClass("hidden"),i.btn_listas_discussao.hasClass("hidden")||i.btn_listas_discussao.addClass("hidden"),i.btn_nova_lista_discussao.hasClass("hidden")||i.btn_nova_lista_discussao.addClass("hidden")),App.sessao&&"S"==a.listas_discussao&&1==a.admin_logado?i.btn_nova_lista_discussao.hasClass("hidden")&&i.btn_nova_lista_discussao.removeClass("hidden"):i.div_btn_listas_discussao.hasClass("hidden")||i.div_btn_listas_discussao.removeClass("hidden"),App.sessao?i.div_pesquisa_perfil.show():(i.div_pesquisa_perfil.hide(),i.lbl_titulo_social.text(a.grupo_nome)),a&&App.titulo_aba(i.html_id,a.grupo_nome),"S"==a.privado?i.privacidade_grupo.text("Privado"):"N"==a.privado?(i.corpo_publicacao.css("-webkit-filter",""),i.corpo_publicacao.css("-filter",""),i.privacidade_grupo.text("Interno")):App.sessao&&"P"==a.privado&&(i.corpo_publicacao.css("-webkit-filter",""),i.corpo_publicacao.css("-filter",""),i.privacidade_grupo.text("PÃºblico")),i.nome_grupo_titulo.text(a.grupo_nome),i.grupo_nome=a.grupo_nome,App.sessao?(i.carrega_img_grupo.css("height","80px"),i.lbl_img_titulo_social.show(),i.btn_refresh.show()):i.carrega_img_grupo.css("height","30px"),i.carrega_img_grupo.attr("src","assets/img/icones_bp/grupo_no_img.svg"),null!=a.logo_id&&(i.logo_id=a.logo_id,i.carrega_img_grupo.attr("src",WS_URI+"documento/midia_imagens_menores/?&tamanho=80&documento_id="+a.logo_id+"&token_midia="+(App.sessao?App.sessao.token_midia:"")+"&anticache="+(new Date).getTime()).on("error",function(){i.carrega_img_grupo.attr("src","assets/img/icones_bp/grupo_no_img.svg")})),"S"==a.privado?1==a.usuario_logado_grupo&&1==a.usuario_logado_membro?(1==a.logado_por_grupo_usuario||1==a.logado_por_motivo_chamado||1==a.logado_por_tipo_usuario?(i.btn_sair_grupo.hide(),i.btn_participar.hide(),i.texto_aprovacao.hide(),i.div_publicacao.hasClass("hidden")&&i.div_publicacao.removeClass("hidden")):(i.btn_sair_grupo.show(),i.btn_participar.hide(),i.texto_aprovacao.hide(),1==i.autorizado_publicar_logado?i.div_publicacao.hasClass("hidden")&&i.div_publicacao.removeClass("hidden"):i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden")),i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!1),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!1)):1==a.usuario_logado_grupo&&0==a.usuario_logado_membro?(i.texto_aprovacao.show(),i.btn_sair_grupo.hide(),i.btn_participar.hide(),i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden"),i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!0),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!0)):(i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!0),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!0),App.sessao&&i.btn_participar.show(),i.btn_sair_grupo.hide(),i.texto_aprovacao.hide(),i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden")):1==a.usuario_logado_grupo&&1==a.usuario_logado_membro?(1==a.logado_por_grupo_usuario||1==a.logado_por_motivo_chamado||1==a.logado_por_tipo_usuario?(i.btn_sair_grupo.hide(),i.btn_participar.hide(),i.texto_aprovacao.hide(),1==i.autorizado_publicar_logado?i.div_publicacao.hasClass("hidden")&&i.div_publicacao.removeClass("hidden"):i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden")):(i.btn_sair_grupo.show(),i.btn_participar.hide(),i.texto_aprovacao.hide(),1==i.autorizado_publicar_logado?i.div_publicacao.hasClass("hidden")&&i.div_publicacao.removeClass("hidden"):i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden")),i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!1),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!1)):(i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!0),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!0),App.sessao&&i.btn_participar.show(),i.btn_sair_grupo.hide(),i.texto_aprovacao.hide(),1==i.autorizado_publicar_logado?i.div_publicacao.hasClass("hidden")&&i.div_publicacao.removeClass("hidden"):i.div_publicacao.hasClass("hidden")||i.div_publicacao.addClass("hidden")),1==a.usuario_logado_grupo&&1==a.admin_logado&&1==a.usuario_logado_membro?i.btn_editar_grupo.show():i.btn_editar_grupo.hide(),App.sessao?i.div_membros.show():i.div_membros.hide(),1==a.usuario_logado_grupo&&1==a.admin_logado&&1==a.usuario_logado_membro&&"S"==a.privado?i.div_solicitacao.show():i.div_solicitacao.hide(),a.count_membro>5?i.btn_todos_membro_grupo.hasClass("hidden")&&i.btn_todos_membro_grupo.removeClass("hidden"):i.btn_todos_membro_grupo.hasClass("hidden")||i.btn_todos_membro_grupo.addClass("hidden"),a.count_solicitacao>5&&1==a.admin_logado?i.btn_todos_solicitacao_grupo.hasClass("hidden")&&i.btn_todos_solicitacao_grupo.removeClass("hidden"):i.btn_todos_solicitacao_grupo.hasClass("hidden")||i.btn_todos_solicitacao_grupo.addClass("hidden"),$.each(a.usuarios,function(a,i){"S"==i.administrador_grupo&&(s=""==s?i.nome:s+", "+i.nome)});var o="",d="";$.each(a.grupo_usuario,function(a,i){"S"==i.administrador_grupo&&(o=""==o?i.nome:o+", "+i.nome)});var r="";$.each(a.chamado_motivo,function(a,i){"S"==i.administrador_grupo&&(r=""==r?i.nome:r+", "+i.nome)});var _="";$.each(a.tipo_usuario,function(a,i){"S"==i.administrador_grupo&&(_=""==_?i.nome:_+", "+i.nome)}),d=s.length>0&&0==o.length&&0==r.length&&0==_.length?s:0==s.length&&o.length>0&&0==r.length&&0==_.length?o:0==s.length&&0==o.length&&r.length>0&&0==_.length?r:0==s.length&&0==o.length&&0==r.length&&_.length>0?_:s.length>0&&o.length>0&&0==r.length&&0==_.length?s+", "+o:s.length>0&&0==o.length&&r.length>0&&0==_.length?s+", "+r:s.length>0&&0==o.length&&0==r.length&&_.length>0?s+", "+r:0==s.length&&o.length>0&&r.length>0&&0==_.length?o+", "+r:0==s.length&&o.length>0&&r.length>0&&_.length>0?o+", "+r+", "+_:s.length>0&&o.length>0&&r.length>0&&0==_.length?s+", "+o+", "+r:s.length>0&&0==o.length&&r.length>0&&_.length>0?s+", "+r+", "+_:s+", "+o+", "+r+", "+_,i.administrador_grupo.text(d),App.sessao&&i.div_administradores.show(),i.verifica_grupo_usuario(),a.usuarios&&(a.usuarios.length+a.grupo_usuario.length<=5&&a.grupo_usuario&&(e=a.grupo_usuario),a.usuarios.length+a.chamado_motivo.length+a.grupo_usuario.length<=5&&a.chamado_motivo&&(n=a.chamado_motivo),a.usuarios.length+a.chamado_motivo.length+a.grupo_usuario.length+a.tipo_usuario.length<=5&&a.tipo_usuario&&(t=a.tipo_usuario),i.listar_membros(a.usuarios,a.admin_logado,e,n,t),i.listar_solicitacao(a.usuarios,a.admin_logado)),i.listar_listas_discussao()})},this.verifica_grupo_usuario=function(){i.nova_mensagem_mural=!1,"S"==i.privacidade?1==i.usuario_logado_membro&&1==i.usuario_logado_grupo?(i.carregar_mural_perfil(!0,!0),i.corpo_publicacao.removeClass("hidden")):i.corpo_publicacao.addClass("hidden"):i.carregar_mural_perfil(!0,!0)},this.limpar_dados_grupo=function(){i.privacidade_grupo.text(""),i.nome_grupo_titulo.text(""),i.administrador_grupo.text(""),i.btn_sair_grupo.hide(),i.texto_aprovacao.hide(),i.btn_participar.hide(),i.corpo_publicacao.css("-webkit-filter",""),i.corpo_publicacao.css("-filter",""),i.corpo_publicacao.find(".btn").not(".btn_mostrar_mais_mensagem").not(".btn_mostrar_respostas").prop("disabled",!1),i.corpo_publicacao.find(".edt_mensagem").prop("disabled",!1)},this.listar_listas_discussao=function(){if(App.sessao){var a=i.dialog.find("[template-listas-discussao]");WS.get("listas_discussao/listar/",{grupo_id:i.grupo_id},function(s){s&&$.each(s,function(s,e){!function(s,e){var n=a.clone();n.removeAttr("template-listas-discussao"),n.removeClass("hidden"),n.addClass("class-rows-listas-discussao"),e%2!=0&&n.css("background",o),n.attr("id",s.lista_id),$(n.find(".lbl_listas_discussao")).text(s.titulo);var t=$(n.find(".btn_pagina_lista_discussao")),d=$(n.find(".field_lb_tipo"));(t=$(n.find(".btn_pagina_lista_discussao"))).css("text-decoration","none"),n.appendTo(i.div_forum);var r=null,_=null;"N"==s.topico_fechado?(d.addClass("label-success"),_="Aberta",r="A"):(d.addClass("label-danger"),_="Fechada",r="F"),d.tooltip({title:_,placement:"right",html:!0}),d.tooltip(),d.text(r),t.unbind("click"),t.click(function(){View.load("grupo_rede_social_pagina/lista_discussao",function(a,o){o.show(s.lista_id,i.grupo_id)},View.ABA.MULTIPLAS)})}(e,s)})}),i.count_listas>0?(i.lbl_count_listas_discussao.hasClass("hidden")&&i.lbl_count_listas_discussao.removeClass("hidden"),i.lbl_count_listas_discussao.text("( "+i.count_listas+" )")):i.lbl_count_listas_discussao.hasClass("hidden")||i.lbl_count_listas_discussao.addClass("hidden"),i.count_listas>3?i.btn_todas_listas_discussao.hasClass("hidden")&&i.btn_todas_listas_discussao.removeClass("hidden"):i.btn_todas_listas_discussao.hasClass("hidden")||i.btn_todas_listas_discussao.addClass("hidden"),i.btn_todas_listas_discussao.unbind("click"),i.btn_todas_listas_discussao.click(function(){View.load("grupo_rede_social_pagina/todas_listas_discussao",function(a,o){o.listar(i.grupo_id,i.admin_logado)},View.ABA.MULTIPLAS)}),i.btn_listas_discussao.unbind("click"),i.btn_listas_discussao.click(function(){View.load("grupo_rede_social_pagina/todas_listas_discussao",function(a,o){o.listar(i.grupo_id,i.admin_logado)},View.ABA.MULTIPLAS)})}},this.listar_solicitacao=function(a,o){var s=i.dialog.find("[template-solicitacao]"),e=o;$.each(a,function(a,o){"N"==o.membro_grupo&&function(a){var o=s.clone();o.removeAttr("template-solicitacao"),o.removeClass("hidden"),o.addClass("class-rows-solicitacao"),o.attr("id",a.usuario_id);var n=$(o.find(".carrega_img_mensagem_solicitacao")),t=$(o.find(".lbl_solicitacao_nome")),d=$(o.find(".btn_aprovar")),r=$(o.find(".btn_reprovar"));$(o.find(".btn_perfil_usuario_solicitacao")),n.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"),null!=a.foto_id&&(n.attr("data-original",WS_URI+"documento/midia_imagens_menores/?documento_id="+a.foto_id+"&tamanho=30&token_midia="+(App.sessao?App.sessao.token_midia:"")),n.lazyload()),t.text(a.nome),1==e&&(d.hasClass("hidden")&&d.removeClass("hidden"),r.hasClass("hidden")&&r.removeClass("hidden")),o.appendTo(i.div_solicitacoes),r.unbind("click"),r.click(function(){alert_modal("Sair Grupo","Deseja realmente sair do grupo?","Remover",function(){WS.post("grupos_rede_social/excluir_usuario_grupo/",{grupo_id:i.grupo_id,usuario_id:a.usuario_id},function(a){a&&(alert_saved("SolicitaÃ§Ã£o efetuada com sucesso"),i.listar_dados_grupo(i.grupo_id,!0))},[r],null,!0)},!0)}),d.unbind("click"),d.click(function(){alert_modal("Aprovar SolicitaÃ§Ã£o","Deseja realmente aprovar SolicitaÃ§Ã£o?","Aceitar",function(){WS.post("grupos_rede_social/aprovar_usuario_grupo/",{grupo_id:i.grupo_id,usuario_id:a.usuario_id,membro_grupo:"S"},function(a){a&&(alert_saved("SolicitaÃ§Ã£o efetuada com sucesso"),i.listar_dados_grupo(i.grupo_id,!0))},[d],null,!0)},!0)}),i.btn_todos_solicitacao_grupo.unbind("click"),i.btn_todos_solicitacao_grupo.click(function(){View.load("perfil/listar",function(i,o){o.show(a.usuario_id,!1)},View.ABA.MULTIPLAS)})}(o),$(document).trigger("scroll")}),i.btn_todos_solicitacao_grupo.unbind("click"),i.btn_todos_solicitacao_grupo.click(function(){View.load("grupo_rede_social_pagina/todos_membros_grupo",function(a,o){o.onclose=function(){i.listar_dados_grupo(i.grupo_id,!0),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.carregar_mural_perfil(!0,!0)},o.show(i.grupo_id,!1)})}),i.count_solicitacao>0?(i.lbl_count_solicitacao.hasClass("hidden")&&i.lbl_count_solicitacao.removeClass("hidden"),i.lbl_count_solicitacao.text("( "+i.count_solicitacao+" )")):i.lbl_count_solicitacao.hasClass("hidden")||i.lbl_count_solicitacao.addClass("hidden")},this.listar_membros=function(a,o,s,e,n){i.div_membros_grupo.find(".class-rows-membros").remove();var t=i.dialog.find("[template-grupo]"),d=o,r=function(a){var o=t.clone();o.removeAttr("template-grupo"),o.removeClass("hidden"),o.addClass("class-rows-membros"),o.attr("id",a.usuario_id);var s=$(o.find(".carrega_img_membro_grupo")),e=$(o.find(".lbl_membro_grupo")),n=$(o.find(".btn_remover_grupo")),r=$(o.find(".btn_perfil_usuario_grupo"));1==d&&"U"==a.tipo&&n.hasClass("hidden")&&n.removeClass("hidden"),s.css("width","30px"),null!=a.foto_id&&"U"==a.tipo?(s.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"),s.attr("data-original",WS_URI+"documento/midia_imagens_menores/?documento_id="+a.foto_id+"&tamanho=30&token_midia="+(App.sessao?App.sessao.token_midia:"")),s.lazyload()):null==a.foto_id&&"U"==a.tipo?s.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"):null==a.foto_id&&"G"==a.tipo?s.attr("src","assets/img/icones_bp/pesquisa_grupo.svg"):"CM"==a.tipo?s.attr("src","assets/img/icones_bp/comunication.svg"):s.attr("src","assets/img/icones_bp/group.svg"),e.text(a.nome),o.appendTo(i.div_membros_grupo),n.unbind("click"),n.click(function(){alert_modal("Sair Grupo","Deseja realmente sair do grupo?","Remover",function(){"U"==a.tipo?WS.post("grupos_rede_social/excluir_usuario_grupo/",{grupo_id:i.grupo_id,usuario_id:a.usuario_id},function(a){a&&(alert_saved("SolicitaÃ§Ã£o efetuada com sucesso"),i.div_membros_grupo.find(".class-rows-membros").remove(),i.listar_dados_grupo(i.grupo_id,!0))},[n],null,!0):WS.post("grupos_rede_social/excluir_usuario_grupo_grupo/",{grupo_id:i.grupo_id,grupo_usuario_id:a.grupo_usuario_id},function(a){a&&(alert_saved("SolicitaÃ§Ã£o efetuada com sucesso"),i.div_membros_grupo.find(".class-rows-membros").remove(),i.listar_dados_grupo(i.grupo_id,!0))},[n],null,!0)},!0)}),"U"==a.tipo&&(r.unbind("click"),r.click(function(){View.load("perfil/listar",function(i,o){o.show(a.usuario_id,!1)},View.ABA.MULTIPLAS)})),"G"==a.tipo&&1==i.admin_logado&&(r.unbind("click"),r.click(function(){View.load("grupo_rede_social_pagina/todos_grupo_usuarios",function(i,o){o.show(a.grupo_usuario_id)})}))};$.each(a,function(a,i){"S"==i.membro_grupo&&r(i)}),$.each(s,function(a,i){r(i)}),$.each(e,function(a,i){r(i)}),$.each(n,function(a,i){r(i)}),$(document).trigger("scroll"),i.btn_todos_membro_grupo.unbind("click"),i.btn_todos_membro_grupo.click(function(){View.load("grupo_rede_social_pagina/todos_membros_grupo",function(a,o){o.onclose=function(){i.listar_dados_grupo(i.grupo_id,!0),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.carregar_mural_perfil(!0,!0),i.div_solicitacoes.find(".class-rows-solicitacao").remove(),i.div_membros_grupo.find(".class-rows-membros").remove()},o.show(i.grupo_id,!0)})}),i.count_membro>0?(i.lbl_count_membros.hasClass("hidden")&&i.lbl_count_membros.removeClass("hidden"),i.lbl_count_membros.text("( "+i.count_membro+" )")):i.lbl_count_membros.hasClass("hidden")||i.lbl_count_membros.addClass("hidden")},this.listar_perfil=function(a){WS.get("grupos_rede_social/listagem_usuario_grupo/",{nome:i.edt_pesquisa_perfil.val()},function(o){limpar_combobox(i.cbo_pesquisa_perfil),$(o).each(function(a,o){var s=[];s.Nome=o.nome;var e=$('<img class="carrega_img" style="margin-right: 4px;"/>&nbsp;');null!=o.foto_id?e.attr("src",WS_URI+"documento/midia_imagens_menores/?documento_id="+o.foto_id+"&tamanho=30&token_midia="+(App.sessao?App.sessao.token_midia:"")).on("error",function(){e.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg")}):"U"==o.tipo?e.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"):e.attr("src","assets/img/icones_bp/grupo_no_img.svg"),add_option_combobox(i.cbo_pesquisa_perfil,a,o.id,s,e,o.tipo)}),i.cbo_pesquisa_perfil.next().find(".ul_row").bind("mousedown",function(){i.cbo_pesquisa_perfil.parent().find(".ncbo_scroll").find(".row_selected");var a=$(this).parent().attr("id_registro");i.usuario_id_selecionado=a;var o=$(this).parent();"U"==(o.attr("dados-adicionais")?o.attr("dados-adicionais"):null)?View.load("perfil/listar",function(a,o){o.show(i.usuario_id_selecionado,!0)},View.ABA.MULTIPLAS):View.load("grupo_rede_social_pagina/listar",function(a,o){o.show(i.usuario_id_selecionado)},View.ABA.MULTIPLAS)}),a(!0)})},this.carregar_mural_perfil=function(a,o){WS.get({route:"mural_mensagem/listar/",data:{ultima_mensagem_mural_id:i.ultima_mensagem_mural_id,parametro_limitador:!0,usuario_id:i.usuario_id_logado,maior_id:i.maior_id,perfil:PERFIL_REDE_SOCIAL.MENSAGENS_DO_GRUPO,grupo_id:i.grupo_id,privacidade:i.privacidade},func_response:function(a){a&&(o&&i.list_mural.find(".class-rows").remove(),i.arr_mural=a,i.render_mural(),i.flag=!0)},ignore_error:a})},this.incAnexo=function(){if(App.is_nativo()){var a=i.div_anexos_row.clone();i.numero_anexo=1+i.numero_anexo;var o=a.find(".btn_input");a.find('input[type="file"]').addClass("hidden"),a.find(".capture_photo").removeClass("hidden").addClass("text-primary");var s=a.find(".capture_photo");o.attr("id_localizacao",i.numero_anexo-1),s.attr("id_localizacao",i.numero_anexo-1),o.unbind("click"),o.bind("click",function(){var a=$(this),s=parseInt($(a).attr("id_localizacao"));PhoneGapFile.getFile(function(a){a.state==PhoneGapFile.STATE.SUCCESS?(void 0!==i.anexo[s]&&null!=i.anexo[s]&&""!=i.anexo[s]?i.anexo[s]=a.file:i.anexo.push(a.file),o.find("*:contains('text')").next().next().text("Arquivo selecionado!").addClass("text-success")):a.state==PhoneGapFile.STATE.FAIL&&(null==i.anexo[s]&&""==i.anexo[s]?o.find("*:contains('text')").next().next().text("Nenhum Arquivo selecionado!").removeClass("text-success"):null!=i.anexo[s]&&""!=i.anexo[s]&&o.find("*:contains('text')").next().next().text("Arquivo selecionado!").addClass("text-success"))})}),s.unbind("click"),s.bind("click",function(){var a=$(this),o=parseInt($(a).attr("id_localizacao"));PhoneGapFile.camera(function(a){a.state==PhoneGapFile.STATE.SUCCESS?(void 0!==i.anexo[o]&&null!=i.anexo[o]&&""!=i.anexo[o]?i.anexo[o]=a.file:i.anexo.push(a.file),s.find("*:contains('text')").next().next().text("Arquivo selecionado!").addClass("text-success")):a.state==PhoneGapFile.STATE.FAIL&&(null==i.anexo[o]&&""==i.anexo[o]?s.find("*:contains('text')").next().next().text("Nenhum Arquivo selecionado!").removeClass("text-success"):null!=i.anexo[o]&&""!=i.anexo[o]&&s.find("*:contains('text')").next().next().text("Arquivo selecionado!").addClass("text-success"))})}),a.find(".anexo_base_label").text("Anexo #"+i.numero_anexo),a.removeClass("hidden"),a.appendTo(i.div_anexos_publicacao)}else a=i.div_anexos_row.clone(),i.numero_anexo=1+i.numero_anexo,a.find(".anexo_base_label").text("Anexo #"+i.numero_anexo),o=a.find(".mobile_inputfile"),a.removeClass("hidden"),a.appendTo(i.div_anexos_publicacao),o.unbind("change"),o.change(function(){0===$(this).get(0).files.length?$(this).next().next().find(".anexo_base_input_text").text("Nenhum arquivo selecionado!"):$(this).next().next().find(".anexo_base_input_text").text($(this).val().split("fakepath\\").length>1?$(this).val().split("fakepath\\")[1].toString():$(this).val().split("fakepath\\")[0].toString())})},this.limpar_anexo=function(){i.anexo_fotos=[],i.anexo=[],i.numero_anexo=0,i.anexo_array=[],i.div_anexos_publicacao.find(".div_anexos_row").remove(),i.incAnexo()},this.var_mural_mensagem_id=null,this.render_mural=function(a){var s=i.dialog.find("[template-mensagem]");i.edt_mensagem.unbind("click"),i.edt_mensagem.click(function(){"P"==i.privacidade?(i.div_mensagem_publica.show(),i.chk_mensagem_publica.prop("checked",!0).trigger("change")):i.chk_mensagem_publica.hide(),i.chk_permite_comentario.prop("checked",!0).trigger("change"),i.chk_votacao.prop("checked",!1).trigger("change"),tinymce.remove(),i.div_btn_publicacao.removeClass("hidden"),i.div_mostrar_anexo.removeClass("hidden"),set_tinymce(i.edt_mensagem,""),i.limpar_anexo(),$("html, body").animate({scrollTop:0},"slow")}),i.btn_cancelar_publicacao.unbind("click"),i.btn_cancelar_publicacao.click(function(){set_tinymce(i.edt_mensagem,""),$("html, body").animate({scrollTop:0},"slow"),tinymce.remove(),i.div_btn_publicacao.addClass("hidden"),i.div_mostrar_anexo.addClass("hidden")});var e=function(a){var o=s.clone();o.removeAttr("template-mensagem"),o.css("display",""),o.addClass("class-rows"),o.attr("id",a.mural_mensagem_id);var e=!0,n=$(o.find(".lbl_mensagem"));n.html(a.mensagem).find("img").css("max-width","100%"),a.votacao_id>0&&function(a,i,o){const s=$("<div></div>");a.find(".lbl_mensagem").parent().append(s),ReactDOM.render(React.createElement(window.components.Votacao.default,o),s[0])}(o,0,{votacao_id:a.votacao_id,pergunta:a.votacao_pergunta,expiracao:a.votacao_expiracao}),$(o.find(".lbl_data_publicacao")).text(a.data_publicacao?a.data_publicacao.format_date_time():"");var t=$(o.find(".img_mensagem_publica"));App.sessao&&"S"==a.publica&&t.show();var d=$(o.find(".carrega_img_mensagem"));d.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"),null!=a.foto_id&&(d.attr("data-original",WS_URI+"documento/midia_imagens_menores/?documento_id="+a.foto_id+"&tamanho=30&token_midia="+(App.sessao?App.sessao.token_midia:"")),d.lazyload()),$(o.find(".lbl_autor")).text(a.autor_nome);var r=$(o.find(".imagens_mensagem"));a.anexos&&a.anexos.length>0&&$.each(a.anexos,function(a,i){if(cripto(WS.token),"image/png"==i.mime_type||"image/bmp"==i.mime_type||"image/jpeg"==i.mime_type||"image/jpg"==i.mime_type||"image/gif"==i.mime_type){var o=WS_URI+"documento/midia_social/?documento_id="+i.documento_id+"&tipo=v&tamanho=400&token_midia="+(App.sessao?App.sessao.token_midia:""),s=$("<img />",{id:i.documento_id}).attr("data-original",o).addClass("text-center row-mensagem-img");s.lazyload(),s.appendTo(r),s.css("max-width","100%"),r.css("text-align","center"),$("<p/>").appendTo(r)}});var _=$(o.find(".div_enviar_comentario")),l=$(o.find(".edt_enviar_comentario")),c=$('<div class="form-inline">'),u=$(o.find(".div_curtidas")),m=$(o.find(".mural_curtir")),p=$(o.find(".mural_descurtir")),g=$(o.find(".mural_comentar")),h=$(o.find(".img_enviar_comentario")),f=($(o.find(".div_comentario")),$(o.find(".div_mostar_mais_comentarios"))),v=$(o.find(".btn_mostrar_mais_comentarios")),b=$(o.find(".btn_menu_editar")),x=$(o.find(".btn_menu_editar_mensagem")),C=$(o.find(".btn_menu_excluir")),w=2;0==i.autorizado_publicar_logado?g.hasClass("hidden")||g.addClass("hidden"):g.hasClass("hidden")&&g.removeClass("hidden"),i.usuario_id_logado!=a.autor_id&&1!=i.admin_logado||1!=i.autorizado_publicar_logado?x.hasClass("hidden")||x.addClass("hidden"):x.hasClass("hidden")&&x.removeClass("hidden"),function(a){$(o.find(".div_marcacao_usuario"));var s=function(n,t,d,r,_){if(a.mural_mensagem_id==n.mural_mensagem_id){var l=$(o.find("[template-comentario]")).clone();l.removeAttr("template-comentario"),l.removeClass("hidden"),l.attr("id",n.comentario_id),l.attr("id_mural_mensagem",n.mural_mensagem_id),$(l.find(".btn_editar_comentario")),$(l.find(".div_marcacao_usuario_resposta"));var c=$(l.find(".btn_excluir")),u=$(l.find(".div_mostrar_respostas")),m=$(l.find(".btn_mostrar_respostas")),p=$(l.find(".carrega_img_comentario"));p.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg"),null!=n.foto_id&&(p.attr("data-original",WS_URI+"documento/midia_imagens_menores/?documento_id="+n.foto_id+"&tamanho=30&token_midia="+(App.sessao?App.sessao.token_midia:"")),p.lazyload()),$(l.find(".lbl_comentario_autor")).text(n.usuario_autor_nome);var g=$(l.find(".lbl_comentario_comentarios"));g.html(n.comentario).find("img").css("max-width","100%");var h=$(l.find(".div_curtir_comentar_comentario")),f=$(l.find(".btn_mural_curtir_comentario")),b=$(l.find(".btn_mural_descurtir_comentario")),x=$(l.find(".mural_comentar_comentario")),C=$(l.find(".div_enviar_comentario_resposta")),k=$(l.find(".edt_enviar_comentario_resposta")),A=$(l.find(".img_enviar_comentario_resposta")),S=$(l.find(".lbl_count_curtida_comentario"));n.mensagem_curtida.length>0?S.text("("+n.mensagem_curtida.length+")"):S.text("");var y=$(l.find(".btn_perfil_usuario_comentario"));0==i.autorizado_publicar_logado?x.hasClass("hidden")||x.addClass("hidden"):x.hasClass("hidden")&&x.removeClass("hidden"),n.usuario_autor_comentario!=i.usuario_id_logado&&(y.unbind("click"),y.click(function(){View.load("perfil/listar",function(a,i){i.show(n.usuario_autor_comentario,!0)},View.ABA.MULTIPLAS)})),App.sessao&&h.show();var V="",I=n.mensagem_curtida.length;I-=10,""==n.mensagem_curtida&&null==n.mensagem_curtida||$.each(n.mensagem_curtida,function(a,i){1==n.usuario_logado_curtida_comentario?(f.hasClass("hidden")||f.addClass("hidden"),b.hasClass("hidden")&&b.removeClass("hidden")):S.removeClass("text-info"),a<9?V=""!=V?V+"<br>"+i.usuario_curtida_nome:i.usuario_curtida_nome:10==a&&(V+="<br>e mais "+I+" ...")}),S.tooltip({title:V,placement:"top",html:!0}),f.unbind("click"),f.click(function(){var a=n.comentario_id;WS.post("mural_mensagem/curtir_comentario",{mural_mensagem_id:n.mural_mensagem_id,usuario_id:App.sessao.usuario_id,comentario_id:n.comentario_id},function(i){$.each(i,function(i,o){a==o.comentario_id&&(S.text("("+o.count_curtida_comentario+")"),f.addClass("hidden"),b.removeClass("hidden"),S.addClass("text-info"))})},[f])}),b.unbind("click"),b.click(function(){var a=n.comentario_id;WS.post("mural_mensagem/descurtir_comentario",{mural_mensagem_id:n.mural_mensagem_id,usuario_id:App.sessao.usuario_id,comentario_id:n.comentario_id},function(i){-1!=i?$.each(i,function(i,o){a==o.comentario_id&&(S.text(o.count_curtida_comentario>0?"("+o.count_curtida_comentario+")":""),f.removeClass("hidden"),b.addClass("hidden"),S.removeClass("text-info"))}):(S.text(""),f.removeClass("hidden"),b.addClass("hidden"),S.removeClass("text-info"))},[b])}),S.unbind("click"),S.click(function(){e=!1,View.load("menu/usuario_curtida",function(a,i){i.show(n.comentario_id,e)})}),x.unbind("click"),x.click(function(){A.attr("src",App.img_perfil.attr("src")),C.removeClass("hidden"),k.val(""),k.unbind("keypress"),set_focus(k),k.keydown(function(o){if(13==o.which){if(1==k.prop("disabled"))return;var e=k.val();k.prop("disabled",!0),null==e&&""==e||WS.post("mural_mensagem/comentar",{mural_mensagem_id:a.mural_mensagem_id,usuario_id:App.sessao.usuario_id,comentario:e,predecessor_id:n.comentario_id,grupo_id:i.grupo_id},function(a){alert_saved("comentÃ¡rio salvo com sucesso"),C.addClass("hidden"),k.val(""),i.list_mural.find('[id_mural_mensagem="'+a[0].mural_mensagem_id+'"]').remove(),$.each(a,function(a,i){s(i)}),$(document).trigger("scroll")})}else 27==o.which&&C.addClass("hidden")})}),App.sessao&&App.sessao.usuario_id==n.usuario_autor_comentario&&1==i.autorizado_publicar_logado&&(A.attr("src",App.img_perfil.attr("src")),g.dblclick(function(){C.removeClass("hidden");var o=k.val(n.comentario);k.unbind("keypress"),set_focus(k),k.keydown(function(e){13==e.which?null==(o=k.val())&&""==o||WS.post("mural_mensagem/alterar_comentario",{mural_mensagem_id:a.mural_mensagem_id,comentario:o,comentario_id:n.comentario_id,grupo_id:i.grupo_id},function(a){alert_saved("comentÃ¡rio salvo com sucesso"),C.addClass("hidden"),i.list_mural.find('[id_mural_mensagem="'+a[0].mural_mensagem_id+'"]').remove(),$.each(a,function(a,i){s(i,!1)}),$(document).trigger("scroll")}):27==e.which&&C.addClass("hidden")})}));var U=n.resposta_comentario.length;App.sessao&&(App.sessao.dados.admin||"1"==i.admin_logado||App.sessao.usuario_id==n.usuario_autor_comentario||App.sessao.usuario_id==a.autor_id)?(c.removeClass("hidden"),c.unbind("click"),c.click(function(){n.comentario_id,alert_modal("ValidaÃ§Ã£o","Deseja excluir comentÃ¡rio?","Ok",function(){WS.post("mural_mensagem/excluir_comentario",{mural_mensagem_id:a.mural_mensagem_id,comentario_id:n.comentario_id,grupo_id:i.grupo_id},function(a){(U-=1)>1?i.list_mural.find(".btn_mostrar_respostas").html('<span class="small span_mostrar_resposta">Mostrar respostas ('+U+")</span>"):1==U?i.list_mural.find(".btn_mostrar_respostas").html('<span class="small span_mostrar_resposta">Mostrar resposta ('+U+")</span>"):i.list_mural.find(".div_mostrar_respostas").addClass("hidden"),a.length>0&&(a[0].count_comentario>2?i.list_mural.find(".div_mostar_mais_comentarios").removeClass("hidden"):i.list_mural.find(".div_mostar_mais_comentarios").addClass("hidden")),l.remove()})},!0)})):c.hasClass("hidden")||c.addClass("hidden"),!n.predecessor_id&&U>0&&u.removeClass("hidden"),!0===t?($.each(n.resposta_comentario,function(a,i){s(i,!0,o.find(".comentario"),r,!0)}),$(document).trigger("scroll"),1==_?l.css("padding-left","75px"):l.css("padding-left","45px"),$(d.find('[id = "'+r+'"]')).after(l)):l.appendTo(o.find(".comentario"));var T=!1;U>1?m.html('<span class="small span_mostrar_resposta">Mostrar respostas ('+U+")</span>"):m.html('<span class="small span_mostrar_resposta">Mostrar resposta ('+U+")</span>"),m.unbind("click"),m.click(function(){var a=l.attr("id");T||($.each(n.resposta_comentario,function(i,e){s(e,!0,o.find(".comentario"),a)}),$(document).trigger("scroll")),T=!0})}v.unbind("click"),v.click(function(){var i=n.comentario_id;w+=25,WS.get("mural_mensagem/listar_comentario/",{mural_mensagem_id:a.mural_mensagem_id,limite_comentario:w,ultimo_comentario_id:i},function(a){$(a).each(function(a,i){s(i,!1)}),$(document).trigger("scroll")})}),g.find(".span_marcado")&&g.find(".span_marcado").each(function(a,i){g.find(".span_marcado").replaceWith(function(){return $("<a class='perfil_marcado' id_usuario = "+$(this).attr("id_usuario")+" style='padding-left: 1px; cursor:pointer;'>"+$(this).html()+"</a>")})}),g.find(".perfil_marcado").unbind("click"),g.find(".perfil_marcado").click(function(){var a=$(this).attr("id_usuario");View.load("perfil/listar",function(i,o){o.show(a,!0)},View.ABA.MULTIPLAS)})};"S"!=a.permite_comentario?g.addClass("hidden"):g.removeClass("hidden"),g.unbind("click"),g.click(function(){h.attr("src",App.img_perfil.attr("src")),_.removeClass("hidden"),l.unbind("keypress"),l.prop("disabled",!1),l.val(""),set_focus(l),l.keydown(function(o){if(13==o.which){if(1==l.prop("disabled"))return;var e=l.val();if(l.prop("disabled",!0),null!=e||""!=e){if("S"!=a.permite_comentario){var n=new Validation;return n.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Esta postagem nÃ£o pode ser comentada.")),void alert_modal("ValidaÃ§Ã£o",n)}WS.post("mural_mensagem/comentar",{mural_mensagem_id:a.mural_mensagem_id,usuario_id:App.sessao.usuario_id,comentario:e,grupo_id:i.grupo_id},function(a){alert_saved("comentÃ¡rio salvo com sucesso"),_.addClass("hidden"),l.val(""),i.list_mural.find('[id_mural_mensagem="'+a[0].mural_mensagem_id+'"]').remove(),a[0].count_comentario>2?i.list_mural.find(".div_mostar_mais_comentarios").removeClass("hidden"):i.list_mural.find(".div_mostar_mais_comentarios").addClass("hidden"),$.each(a,function(a,i){s(i,!1)}),$(document).trigger("scroll")})}}else 27==o.which&&_.addClass("hidden")})}),a.count_comentario>2&&f.removeClass("hidden"),$(a.resposta_comentario).each(function(a,i){s(i,!1)})}(a),App.sessao&&u.show();var k="",A=a.count_curtida;A-=10,""==a.mensagem_curtida&&null==a.mensagem_curtida||$.each(a.mensagem_curtida,function(i,o){1==a.usuario_logado_curtida&&(m.hasClass("hidden")||m.addClass("hidden"),p.hasClass("hidden")&&p.removeClass("hidden")),i<9?k=""!=k?k+"<br>"+o.usuario_curtida_nome:o.usuario_curtida_nome:k+="<br>e mais "+A+" ..."});var S=$(o.find(".lbl_mensagem_curtir")),y=$(o.find(".div_mensagem_curtir"));a.mensagem_curtida.length>0?(y.removeClass("hidden"),S.text("("+a.count_curtida+")")):y.addClass("hidden"),S.tooltip({title:k,placement:"top",html:!0}),S.unbind("click"),S.click(function(){e=!0,View.load("menu/usuario_curtida",function(i,o){o.show(a.mural_mensagem_id,e)})}),m.unbind("click"),m.click(function(){WS.post("mural_mensagem/curtir",{mural_mensagem_id:a.mural_mensagem_id,usuario_id:App.sessao.usuario_id},function(a){var i;i=null!=a.count_curtida?a.count_curtida:0,y.removeClass("hidden"),S.text("("+i+")"),m.addClass("hidden"),p.removeClass("hidden")},[m])}),p.unbind("click"),p.click(function(){WS.post("mural_mensagem/descurtir",{mural_mensagem_id:a.mural_mensagem_id,usuario_id:App.sessao.usuario_id},function(a){var i;(i=null!=a.count_curtida?a.count_curtida:0)>0?(y.removeClass("hidden"),S.text("("+i+")")):y.addClass("hidden"),m.removeClass("hidden"),p.addClass("hidden")},[m])}),null!=a.anexos&&$.each(a.anexos,function(i,s){var e=s.documento_revisao_id;$(o.find(".div_anexos")).removeClass("hidden");var n=$('<div class="input-group" style="margin-top: 0px; margin-right: 5px;">');if("application/pdf"==s.mime_type)(t=$("<button>")).addClass("btn btn-link"),t.html($('<span><span class="glyphicon glyphicon-paperclip"></span>&nbsp;'+FileShortName(s.revisao_nome)+"</span>")),t.css("padding-left","4px"),t.css("padding-right","0px"),t.unbind("click"),t.click(function(){View.load("central_documentos/visualizar_pdf",function(a,i){i.show(e)})}),(r=$("<a>")).attr("type","button"),r.addClass("btn btn-link"),r.attr("title","Download "+s.revisao_nome),r.attr("value",s.documento_revisao_id),(d=$("<span>")).addClass("glyphicon glyphicon-download-alt"),r.append(d),n.append(t),n.append(r);else if("video/mp4"==s.mime_type||"video/ogg"==s.mime_type)(t=$("<button>")).addClass("btn btn-link"),t.html($('<span><span class="glyphicon glyphicon-paperclip"></span>&nbsp;'+FileShortName(s.revisao_nome)+"</span>")),t.css("padding-left","4px"),t.css("padding-right","0px"),t.unbind("click"),t.click(function(){View.load("central_documentos/visualizar_video",function(a,i){i.show(e)})}),(r=$("<a>")).attr("type","button"),r.addClass("btn btn-link"),r.attr("title","Download "+s.revisao_nome),r.attr("value",s.documento_revisao_id),(d=$("<span>")).addClass("glyphicon glyphicon-download-alt"),r.append(d),n.append(t),n.append(r);else if("image/png"==s.mime_type||"image/bmp"==s.mime_type||"image/jpeg"==s.mime_type||"image/jpg"==s.mime_type||"image/gif"==s.mime_type){var t,d;(t=$("<button>")).addClass("btn btn-link"),t.html($('<span><span class="glyphicon glyphicon-paperclip"></span>&nbsp;'+FileShortName(s.revisao_nome)+"</span>")),t.css("padding-left","4px"),t.css("padding-right","0px"),t.unbind("click"),t.click(function(){View.load("central_documentos/visualizar_documento",function(a,i){i.show(e)})}),(r=$("<a>")).attr("type","button"),r.addClass("btn btn-link"),r.attr("title","Download "+s.revisao_nome),r.attr("value",s.documento_revisao_id),(d=$("<span>")).addClass("glyphicon glyphicon-download-alt"),r.append(d),n.append(t),n.append(r)}else{var r;(r=$("<a>")).attr("type","button"),r.addClass("btn btn-link"),r.attr("title","Download "+s.revisao_nome),r.html($('<span><span class="glyphicon glyphicon-paperclip"></span>&nbsp;'+FileShortName(s.revisao_nome)+"</span>")),r.attr("value",s.documento_revisao_id),r.css("padding-left","4px"),r.css("padding-right","0px"),n.append(r)}c.append(n),c.append("&nbsp;&nbsp;&nbsp;"),s.revisao_nome,r.unbind("click"),r.click(function(){App.sessao||"S"!=a.publica?App.obter_token_publico(function(a){App.download(WS_URI+"documento/download/?documento_revisao_id="+e+"&token_publico="+a)}):App.download(WS_URI+"documento/download/?documento_revisao_id="+e+"&social=S")}),(s=$(o.find(".anexos"))).addClass("remove_anexo"),s.append(c)}),0==i.nova_mensagem_mural?o.appendTo(i.list_mural):(i.nova_mensagem_mural=!1,i.list_mural.find('[id="'+a.segundo_maior_id+'"]').before(o)),(App.sessao&&App.sessao.usuario_id==a.autor_id&&1==i.autorizado_publicar_logado||1==i.admin_logado)&&(n.unbind("dblclick"),n.dblclick(function(){View.load("mural_mensagem/nova",function(o,s){s.onsave=function(a){i.list_mural.find('[id="'+a.id+'"]').find(".class-rows").remove(),i.list_mural.find('[id="'+a.id+'"]').addClass(".class-rows"),i.list_mural.find('[id="'+a.id+'"]').find(".lbl_mensagem").html(a.mensagem).find("img").css("max-width","100%"),a.anexos&&a.anexos.length>0?$.each(a.anexos,function(o,s){if("image/png"==s.mime_type||"image/bmp"==s.mime_type||"image/jpeg"==s.mime_type||"image/jpg"==s.mime_type||"image/gif"==s.mime_type){var e=WS_URI+"documento/midia_social/?documento_id="+s.documento_id+"&tipo=v&tamanho=400&token_midia="+(App.sessao?App.sessao.token_midia:""),n=$("<img />",{id:s.documento_id}).attr("data-original",e).addClass("text-center row-mensagem-img");n.lazyload(),n.appendTo(i.list_mural.find('[id="'+a.id+'"]').find(".imagens_mensagem")),n.css("max-width","100%"),r.css("text-align","center"),$("<p/>").appendTo(i.list_mural.find('[id="'+a.id+'"]').find(".imagens_mensagem"))}}):(i.list_mural.find('[id="'+a.id+'"]').find(".row-mensagem-img").remove(),i.list_mural.find('[id="'+a.id+'"]').find(".remove_anexo").remove())},s.show(a.mural_mensagem_id,FORMULARIO.EDITAR,!1,i.grupo_id,i.privacidade)},View.ABA.MULTIPLAS)}),b.unbind("click"),b.click(function(){View.load("mural_mensagem/nova",function(o,s){s.onsave=function(a){i.list_mural.find('[id="'+a.id+'"]').find(".class-rows").remove(),i.list_mural.find('[id="'+a.id+'"]').addClass(".class-rows"),i.list_mural.find('[id="'+a.id+'"]').find(".lbl_mensagem").html(a.mensagem).find("img").css("max-width","100%"),a.anexos&&a.anexos.length>0?$.each(a.anexos,function(o,s){if("image/png"==s.mime_type||"image/bmp"==s.mime_type||"image/jpeg"==s.mime_type||"image/jpg"==s.mime_type||"image/gif"==s.mime_type){var e=WS_URI+"documento/midia_social/?documento_id="+s.documento_id+"&tipo=v&tamanho=400&token_midia="+(App.sessao?App.sessao.token_midia:""),n=$("<img />",{id:s.documento_id}).attr("data-original",e).addClass("text-center row-mensagem-img");n.lazyload(),n.appendTo(i.list_mural.find('[id="'+a.id+'"]').find(".imagens_mensagem")),n.css("max-width","100%"),r.css("text-align","center"),$("<p/>").appendTo(i.list_mural.find('[id="'+a.id+'"]').find(".imagens_mensagem"))}}):(i.list_mural.find('[id="'+a.id+'"]').find(".row-mensagem-img").remove(),i.list_mural.find('[id="'+a.id+'"]').find(".remove_anexo").remove())},s.show(a.mural_mensagem_id,FORMULARIO.EDITAR,!1,i.grupo_id,i.privacidade)},View.ABA.MULTIPLAS)})),C.unbind("click"),C.click(function(){View.load("mural_mensagem/nova",function(o,s){s.onsave=function(a){i.list_mural.find('[id="'+a.id+'"]').remove()},s.show(a.mural_mensagem_id,FORMULARIO.EXCLUIR,!1,i.grupo_id,i.privacidade)},View.ABA.MULTIPLAS)})};a?(i.maior_id=a.maior_id,i.list_mural.find("li.media:nth-of-type(even)").css("background",""),e(a),$(document).trigger("scroll")):($(i.arr_mural).each(function(a,o){e(o),a==i.arr_mural.length-1&&0==i.nova_mensagem_mural&&(i.ultima_mensagem_mural_id=o.mural_mensagem_id,i.maior_id=o.maior_id)}),$(document).trigger("scroll")),i.list_mural.find("li.media:nth-of-type(odd)").css("background",o);var n=i.list_mural.find("li.media:nth-of-type(even)");n.find(".div_comentario_mensagem").css("background",o),n.find(".div_enviar_comentario_mensagem").css("background",o),n.find(".div_enviar_comentario_resposta_mensagem").css("background",o)},i.btn_publicacao.unbind("click"),i.btn_publicacao.click(function(){var a=i.div_anexos_publicacao.find('input[type="file"]');$.each(a,function(a,o){o.files[0]&&(i.anexo_array[a]=o.files[0])}),WS.post("mural_mensagem/salvar",{mural_mensagem_id:i.mensagem_id,mensagem:get_tinymce(i.edt_mensagem),tipo:null,documentos:i.anexo_array,mobile:App.is_nativo()?"sim":"nao",administrativo:"N",publica:"P"==i.privacidade?i.chk_mensagem_publica.prop("checked"):null,permite_comentario:i.chk_permite_comentario.prop("checked"),votacao:CircularJSON.stringify(i.nova_votacao),grupo_id:i.grupo_id},function(a){alert_saved("Mensagem publicada com sucesso"),a&&(i.ultima_mensagem_mural_id=null,i.maior_id=null,set_tinymce(i.edt_mensagem,""),tinymce.remove(),i.limpar_anexo(),i.div_btn_publicacao.addClass("hidden"),i.div_mostrar_anexo.addClass("hidden"),i.carregar_mural_perfil(!0,!0))},[i.btn_cancelar_publicacao,i.btn_publicacao],null,!0)}),i.btn_editar_grupo.unbind("click"),i.btn_editar_grupo.click(function(){View.load("grupo_rede_social/detalhes",function(a,o){o.onclose=i.listar,o.onclose=function(){i.listar_dados_grupo(i.grupo_id,!0),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.carregar_mural_perfil(!0,!0)},o.show(i.grupo_id,FORMULARIO.EDITAR)})}),i.btn_participar.unbind("click"),i.btn_participar.click(function(){var a=null;a="S"==i.privacidade?"N":"S",WS.post("grupos_rede_social/salvar_usuario_solicitacao/",{grupo_id:i.grupo_id,membro_grupo:a,usuario_id:i.usuario_id_logado},function(a){a&&(i.grupo_id=a.grupo_id,alert_saved("SolicitaÃ§Ã£o enviada com sucesso"),i.limpar_dados_grupo(),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.privacidade=a.privado,i.listar_dados_grupo(i.grupo_id,!0))},[i.btn_participar],null,!0)}),i.btn_sair_grupo.unbind("click"),i.btn_sair_grupo.click(function(){alert_modal("Sair Grupo","Deseja realmente sair do grupo?","Remover",function(){WS.post("grupos_rede_social/excluir_usuario_grupo/",{grupo_id:i.grupo_id,usuario_id:i.usuario_id_logado},function(a){alert_saved("SolicitaÃ§Ã£o efetuada com sucesso"),i.limpar_dados_grupo(),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.privacidade=a.privado,i.listar_dados_grupo(i.grupo_id,!0),i.div_solicitacoes.find(".class-rows-solicitacao").remove(),i.div_membros_grupo.find(".class-rows-membros").remove()},[i.btn_sair_grupo],null,!0)},!0)}),i.btn_anexo_perfil.unbind("click"),i.btn_anexo_perfil.click(function(){i.incAnexo()}),i.chk_votacao.unbind("change"),i.chk_votacao.change(function(){if($(this).prop("checked")){i.div_publicacao_hidden=i.div_publicacao.hasClass("hidden"),i.div_mural_nova_votacao.show();const a=a=>{i.div_mural_nova_votacao.hide(),ReactDOM.unmountComponentAtNode(i.div_nova_votacao[0]),i.nova_votacao=null},o=a=>{i.nova_votacao=a};i.react_component_nova_votacao=React.createElement(window.components.NovaVotacao.default,{origem:"grupo_rede_social",origem_id:i.grupo_id,onClose:a,aoAlterar:o}),ReactDOM.render(i.react_component_nova_votacao,i.div_nova_votacao[0])}else i.div_mural_nova_votacao.hide(),ReactDOM.unmountComponentAtNode(i.div_nova_votacao[0])}),i.btn_refresh.unbind("click"),i.btn_refresh.click(function(){i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.verifica_grupo_usuario(),i.div_solicitacoes.find(".class-rows-solicitacao").remove(),i.div_membros_grupo.find(".class-rows-membros").remove(),i.div_forum.find(".class-rows-listas-discussao").remove(),i.listar_dados_grupo(i.grupo_id)}),i.btn_nova_lista_discussao.unbind("click"),i.btn_nova_lista_discussao.click(function(){View.load("grupo_rede_social_pagina/nova_lista",function(a,o){o.onclose=i.listar,o.onclose=function(){i.listar_dados_grupo(i.grupo_id,!0),i.ultima_mensagem_mural_id=null,i.maior_id=null,i.nova_mensagem_mural=!1,i.carregar_mural_perfil(!0,!0)},o.show(i.grupo_id,FORMULARIO.NOVO)})}),this.unload=function(){View.unload(this.html_id)},i.flag=!0,i.btn_mostrar_mais_mensagem.unbind("click").click(function(){i.div_load.removeClass("hidden"),1==i.flag&&(i.flag=!1,i.carregar_mural_perfil())})}});