define([],function(){return function(i){"use strict";var t=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.grupo_id=null,this.lista_id=null,this.admin_logado=null,this.listar=function(i,n){var o=t.tab_listagem.find("tbody"),a=o.find("tr:first");t.admin_logado=n,t.grupo_id=i,0==t.admin_logado?t.btn_novo.hasClass("hidden")||t.btn_novo.addClass("hidden"):t.btn_novo.hasClass("hidden")&&t.btn_novo.removeClass("hidden"),t.tab_listagem.find("tr:gt(1)").remove(),WS.get("listas_discussao/listar_todas/",{grupo_id:t.grupo_id},function(i){i&&$(i).each(function(i,n){App.titulo_aba(t.html_id,"Listas de Discuss√£o Grupo "+n.grupo_nome),function(i){var n=a.clone();n.removeAttr("template-row"),n.css("display",""),t.lista_id=i,$(n.find("[template-field='titulo']")).text(i.titulo),$(n.find("[template-field='autor']")).text(i.nome_criador_lista);var s=$(n.find(".div_btn_admin")),d=$(n.find(".field_lb_tipo")),l=$(n.find(".btn_visualizar"));l.unbind("click"),l.click(function(){View.load("grupo_rede_social_pagina/lista_discussao",function(t,n){n.show(i.lista_id)},View.ABA.MULTIPLAS)});var e=$(n.find(".btn_editar")),_=function(){View.load("grupo_rede_social_pagina/nova_lista",function(n,o){o.onclose=t.listar,o.onclose=function(){t.listar(t.grupo_id)},o.show(i.grupo_id,FORMULARIO.EDITAR,i.lista_id)})},c=$(n.find(".btn_excluir"));c.unbind("click"),c.click(function(){View.load("grupo_rede_social_pagina/nova_lista",function(n,o){o.onclose=t.listar,o.onclose=function(){t.listar(t.grupo_id)},o.show(i.grupo_id,FORMULARIO.EXCLUIR,i.lista_id)})}),0==i.admin_logado?(s.hasClass("hidden")||s.addClass("hidden"),t.btn_novo.hasClass("hidden")||t.btn_novo.addClass("hidden")):(s.hasClass("hidden")&&s.removeClass("hidden"),t.btn_novo.hasClass("hidden")&&t.btn_novo.removeClass("hidden"),e.unbind("click"),e.click(_),n.dblclick(_));var r=null,u=null;"N"==i.topico_fechado?(d.addClass("label-success"),u="Aberta",r="Aberta"):(d.addClass("label-danger"),u="Fechada",r="Fechada"),d.tooltip({title:u,placement:"right",html:!0}),d.tooltip(),d.text(r),n.appendTo(o)}(n)})})},this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("grupo_rede_social_pagina/nova_lista",function(i,n){n.onclose=function(){t.listar(t.grupo_id)},n.show(t.grupo_id,FORMULARIO.NOVO)})}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){t.listar(t.grupo_id)}),this.unload=function(){View.unload(this.html_id)}}});