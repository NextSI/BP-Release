define([],function(){return function(o){"use strict";var a=this;this.html_id=o,this.dialog=$("#"+this.html_id),this.popup=null,this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.ondelete=null,this.carrega_img=this.dialog.find(".carrega_img"),this.div_viewer=this.dialog.find(".div_viewer"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_download=this.dialog.find(".btn_download"),this.doc_bloqueado=this.dialog.find(".doc_bloqueado"),this.doc_rev_reprovado=this.dialog.find(".doc_rev_reprovado"),this.doc_rev_pendente=this.dialog.find(".doc_rev_pendente"),this.doc_rev_obsoleto=this.dialog.find(".doc_rev_obsoleto"),this.arquivo=null,this.documento_id=null,this.documento_revisao_id=null,this.token=null,this.documento_bloqueado=null,this.controle_distribuicao=null,this.show=function(o,i,e,t,n,d,l,r){void 0===d&&(d=!0),void 0===l&&(l=!0),a.documento_id=i,a.documento_revisao_id=o,a.token=cripto(WS.token),a.revisao_ativa=e,a.revisao_aprovada=t,a.documento_bloqueado=n,a.controle_distribuicao=d,!a.documento_revisao_id&&r?a.carrega_img.attr("src",r):(a.arquivo=WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id+"&token_publico="+a.token+"&tipo=S&acao=abrir&login_anonimo="+(!0===WS.login_anonimo?"true":"false"),a.carrega_img.attr("src",a.arquivo)),show_modal(a.modal.attr("id")),"S"==n&&a.doc_bloqueado.removeClass("hidden"),"S"==a.revisao_ativa&&"S"==a.revisao_aprovada||("N"===a.revisao_aprovada?a.doc_rev_reprovado.removeClass("hidden"):null===a.revisao_aprovada||"N"==a.controle_distribuicao?a.doc_rev_pendente.removeClass("hidden"):"N"===a.revisao_ativa&&a.doc_rev_obsoleto.removeClass("hidden")),wheelzoom(a.carrega_img),$(document).keydown(function(o){o.shiftKey&&a.carrega_img.css("pointer-events","auto")}),$(document).keyup(function(o){"Shift"===o.key&&a.carrega_img.css("pointer-events","none")}),alertaPopUp("Documento",(o,i)=>{a.popup=i,o.replaceWith(a.dialog)},"Download",()=>{var o=function(){App.sessao?App.obter_token_publico(function(o){App.download(WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id+"&token_publico="+o),"safari"!=getBrowser()&&a.unload()}):(App.download(WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id),"safari"!=getBrowser()&&a.unload())};void 0===a.revisao_ativa||void 0===a.revisao_aprovada||void 0===a.documento_bloqueado||"S"==a.revisao_ativa&&"S"==a.revisao_aprovada&&"S"!=a.documento_bloqueado?o():"N"==a.revisao_aprovada?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>reprovada,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):null===a.revisao_aprovada||"N"==a.controle_distribuicao?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-info" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>pendente,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):"N"==a.revisao_ativa?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-warning" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>obsoleta,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):"S"==a.documento_bloqueado&&alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar um documento </strong>bloqueado,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0)},"Cancelar",()=>{a.unload()},"80%"),l&&a.documento_revisao_id||(a.btn_download.addClass("hidden"),a.modal.bind("contextmenu",function(o){return alert_warning("Você não possui permissão para realizar esta ação."),!1}))},this.close=function(){close_modal(a.modal.attr("id")),void 0!==a.onclose&&a.onclose&&a.onclose()},this.unload=function(){a.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){a.unload()}),this.btn_download.unbind("click"),this.btn_download.click()}});