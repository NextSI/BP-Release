define([],function(){var i=function(i){"use strict";var e=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Unidade de Medida",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.btn_configuracoes=this.dialog.find(".btn_configuracoes"),this.td_bloqueado=this.dialog.find(".td_bloqueado"),this.somente_leitura=this.dialog.find(".somente_leitura"),this.somente_visualizar=this.dialog.find(".somente_visualizar"),this.somente_consulta_unidade_medida="N",this.show=function(){e.listar(),e.verifica_config()},this.verifica_config=function(){!0===App.sessao.dados.admin?e.btn_configuracoes.removeClass("hidden"):e.btn_configuracoes.addClass("hidden"),WS.get("unidade_medida/get_parametros/",null,function(i){e.somente_consulta_unidade_medida=i.somente_consulta_unidade_medida,"S"==e.somente_consulta_unidade_medida?(e.somente_leitura.addClass("hidden"),e.somente_visualizar.removeClass("hidden")):(e.somente_leitura.removeClass("hidden"),e.somente_visualizar.addClass("hidden"))})},this.listar=function(){var i=e.tab_listagem.find("tbody"),d=i.find("tr:first");WS.get("unidade_medida/listar/",null,function(t){e.tab_listagem.find("tr:gt(1)").remove(),$(t).each(function(t,n){!function(t){var n=d.clone();n.removeAttr("template-row"),n.css("display",""),$(n.find("[template-field='codigo']")).text(t.codigo),$(n.find("[template-field='descricao']")).text(t.descricao),$(n.find("[template-field='qtde_casas_decimal']")).text(t.qtde_casas_decimal);var a=$(n.find("[template-field='bloqueado']"));"S"==t.bloqueado?a.addClass("glyphicon-ok text-success"):a.addClass("glyphicon-remove text-danger"),$(n.find(".btn_editar")).click(function(){"N"==e.somente_consulta_unidade_medida&&View.load("unidade_medida/detalhes",function(i,d){d.onclose=e.listar,d.show(t.unidade_medida_id,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS)}),$(n.find(".btn_visualizar")).click(function(){View.load("unidade_medida/detalhes",function(i,d){d.onclose=e.listar,d.show(t.unidade_medida_id,FORMULARIO.VISUALIZAR)},View.ABA.MULTIPLAS)}),$(n.find(".btn_excluir")).click(function(){"N"==e.somente_consulta_unidade_medida&&View.load("unidade_medida/detalhes",function(i,d){d.onclose=e.listar,d.show(t.unidade_medida_id,FORMULARIO.EXCLUIR)},View.ABA.MULTIPLAS)}),n.appendTo(i)}(n)})})},this.btn_novo.unbind("click"),this.btn_novo.click(function(){"N"==e.somente_consulta_unidade_medida&&View.load("unidade_medida/detalhes",function(i,d){d.onclose=e.listar,d.show(null,FORMULARIO.NOVO)},View.ABA.MULTIPLAS)}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){e.listar()}),this.btn_configuracoes.unbind("click"),this.btn_configuracoes.click(function(){View.load("unidade_medida/configuracoes",function(i,d){d.onclose=function(){e.verifica_config(),e.listar()},d.show()})}),this.unload=function(){View.unload(this.html_id)}};return i});