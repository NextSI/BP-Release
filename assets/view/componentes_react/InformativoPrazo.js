"use strict";define(["react","react-dom"],function(e,a){return class extends e.Component{constructor(e){super(e),this.state={DiferencaHorasUteis:"00:00",DiferencaDias:0,DiferencaHorasUteisSegundos:0,PrazoEstourado:!1,Percentual:0,DataPrazoSegundos:0,DataPrazoParaCalendarioDoUsuarioLogado:""},this.props.Configuracoes={ViewParent:null,Alinhamento:"left",TipoGestaoTempo:GESTAO_TEMPO.HORAS_UTEIS,HorasEstimadas:null,DiasEstimados:null,DataPrazo:"",CalendarioTrabalhoId:null,LabelExcedente:"Atrasado",LabelRestante:"Restante",TituloDataPrazo:"Prazo",StyleWidth:"200px",ExibirTituloDataPrazo:!1,ExibirDataPrazo:!0,ExibirBarraProgresso:!0,ExibirDiferencaHorasUteis:!0,IntervalId:0,chamadoEncerrado:!1},this.props.setConfiguracoes=(e=>{this.props.Configuracoes=spread(this.props.Configuracoes,e),this.props.Configuracoes.ViewParent&&(this.props.IntervalId=View.setInterval(this.props.Configuracoes.ViewParent,()=>{this.processarDados()},6e4)),this.processarDados()}),this.props.desativarRefreshAutomatico=(()=>{View.removeInterval(this.props.IntervalId)})}processarDados(){if(!this.props.Configuracoes.DataPrazo)return null;let e=new Date,a=e.now(),r={DiferencaHorasUteis:"00:00",DiferencaDias:0,DiferencaHorasUteisSegundos:0,PrazoEstourado:!1,Percentual:0,DataPrazo:0,DataPrazoParaCalendarioDoUsuarioLogado:""};a>this.props.Configuracoes.DataPrazo&&(r.PrazoEstourado=!0);let s=0;if(s=r.PrazoEstourado?fn_segundos_uteis(this.props.Configuracoes.CalendarioTrabalhoId,this.props.Configuracoes.DataPrazo,a):fn_segundos_uteis(this.props.Configuracoes.CalendarioTrabalhoId,a,this.props.Configuracoes.DataPrazo),r.DiferencaHorasUteis=fn_converter_segundos_para_horas(s),r.DataPrazo=date_create(this.props.Configuracoes.DataPrazo),r.DataPrazo.setMilliseconds(0),r.DataPrazo.setSeconds(0),r.DataPrazo.setMinutes(0),r.DataPrazo.setHours(0),e.setMilliseconds(0),e.setSeconds(0),e.setMinutes(0),e.setHours(0),r.DiferencaDias=date_diff(r.DataPrazo,e.getTime()),r.PrazoEstourado)r.Percentual=100;else if(+this.props.Configuracoes.TipoGestaoTempo==GESTAO_TEMPO.HORAS_UTEIS&&this.props.Configuracoes.HorasEstimadas&&"00:00:00"!=this.props.Configuracoes.HorasEstimadas){let e=fn_converter_horas_para_segundos(this.props.Configuracoes.HorasEstimadas);r.Percentual=(e-s)/e*100}else+this.props.Configuracoes.TipoGestaoTempo==GESTAO_TEMPO.DIAS_CORRIDOS&&this.props.Configuracoes.DataPrazo&&this.props.Configuracoes.DiasEstimados&&(r.Percentual=(+this.props.Configuracoes.DiasEstimados-r.DiferencaDias)/+this.props.Configuracoes.DiasEstimados*100);r.Percentual>100&&(r.Percentual=100),r.Percentual<0&&(r.Percentual=0),this.setState(r)}renderDataPrazo(){let a=null;this.props.Configuracoes.ExibirTituloDataPrazo&&(a=e.createElement("div",{style:{whiteSpace:"nowrap"},className:"right"==this.props.Configuracoes.Alinhamento?"text-right":""},this.props.Configuracoes.TituloDataPrazo));let r=null;return+this.props.Configuracoes.TipoGestaoTempo==GESTAO_TEMPO.DIAS_CORRIDOS?r=e.createElement("div",{style:{whiteSpace:"nowrap"},className:"right"==this.props.Configuracoes.Alinhamento?"text-right":"",title:this.props.Configuracoes.TituloDataPrazo},this.props.Configuracoes.DataPrazo?this.props.Configuracoes.DataPrazo.format_date():""):+this.props.Configuracoes.TipoGestaoTempo==GESTAO_TEMPO.HORAS_UTEIS&&(r=e.createElement("div",{style:{whiteSpace:"nowrap"},className:"right"==this.props.Configuracoes.Alinhamento?"text-right":"",title:this.props.Configuracoes.TituloDataPrazo},this.props.Configuracoes.DataPrazo?this.props.Configuracoes.DataPrazo.format_date_time():"")),e.createElement("div",null,a,r)}renderDiferencaHorasUteis(){let a=null,r=this.state.PrazoEstourado||0===this.state.DiferencaDias?"text-danger":"text-default",s={font:"inherit",width:"100%",whiteSpace:"nowrap"},t={fontWeight:"bold",paddingLeft:"0px",paddingRight:"0px"};switch("left"==this.props.Configuracoes.Alinhamento&&(t.paddingRight="10px"),"right"==this.props.Configuracoes.Alinhamento&&(t.paddingLeft="10px"),+this.props.Configuracoes.TipoGestaoTempo){case GESTAO_TEMPO.DIAS_CORRIDOS:a=e.createElement("div",{style:s,className:"text "+r,title:this.props.Configuracoes.TituloDataPrazo},dia_contador_str(this.state.DiferencaDias,this.state.PrazoEstourado));break;case GESTAO_TEMPO.HORAS_UTEIS:a=e.createElement("div",{style:s,className:"text "+r,title:this.state.PrazoEstourado?this.props.Configuracoes.LabelExcedente:this.props.Configuracoes.LabelRestante},this.state.DiferencaHorasUteis)}return e.createElement("div",{style:t},a)}renderBarraProgresso(){if(+this.props.Configuracoes.TipoGestaoTempo==GESTAO_TEMPO.DIAS_CORRIDOS&&this.props.Configuracoes.DataPrazo&&!this.props.Configuracoes.DiasEstimados)return null;let a=this.state.PrazoEstourado?"progress-bar-danger":"progress-bar-default";return e.createElement("div",{className:"progress div_progress",style:{marginBottom:"0px",height:"12px"}},e.createElement("div",{className:"progress-bar progress-bar-striped "+a,style:{width:this.state.Percentual+"%"}}))}renderTooltip(){return e.createElement("div",null,this.renderDataPrazo())}render(){if(this.props.Configuracoes.chamadoEncerrado||!this.props.Configuracoes.DataPrazo)return e.createElement(e.Fragment,null,e.createElement("span",null,"-"));{let a=null;this.props.Configuracoes.ExibirDataPrazo&&(a=this.renderDataPrazo());let r=null;this.props.Configuracoes.ExibirBarraProgresso&&(r=this.renderBarraProgresso());let s=null;this.props.Configuracoes.ExibirDiferencaHorasUteis&&(s=this.renderDiferencaHorasUteis());let t=null,o=null;return"right"==this.props.Configuracoes.Alinhamento&&(t="row-reverse",o="end"),e.createElement("div",{style:{width:this.props.Configuracoes.StyleWidth}},e.createElement("div",{style:{display:"flex",flexWrap:"wrap",flexFlow:t,justifyContent:o}},s,a),e.createElement("div",{style:{}},r))}}}});