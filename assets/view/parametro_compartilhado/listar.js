define([],function(){return function(o){"use strict";var a=this;this.html_id=o,this.dialog=$("#"+this.html_id),this.title="Compartilhamento de Tabelas",this.onclose=null,this.opcoes_cbo={NAO_COMPARTILHADO:{nome:"NÃ£o Compartilhado",valor:0},COMPARTILHADO:{nome:"Compartilhado",valor:1}},this.parametros={},this.cbo_modulo=this.dialog.find(".cbo_modulo"),this.cbo_opcao_padrao=this.dialog.find(".cbo_opcao_padrao"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.show=function(){a.preencher(),a.listar_modulos(),a.listar_opcoes(),a.cbo_opcao_padrao.selectpicker(),a.cbo_modulo.selectpicker()},this.preencher=function(){WS.get({route:"parametro_compartilhado/get_parametro/",data:{tipo:a.cbo_modulo.val()},func_response:function(o){o&&a.cbo_opcao_padrao.each(function(a,t){var i=$(t),e=$(t).attr("data-name");i.val(o["parametro_compartilhado_"+e]),i.selectpicker("refresh")})},disabled_buttons:[a.btn_salvar],html_id:a.html_id})},this.unload=function(){View.unload(this.html_id)},this.listar_modulos=function(){for(var o in PARAMETRO_COMPARTILHADO_MODULOS)if(void 0!==o&&"clean"!=o&&o){var t=PARAMETRO_COMPARTILHADO_MODULOS[o];add_option(a.cbo_modulo,t.index,t.nome,0==t.index?"selected":"")}},this.listar_opcoes=function(){for(var o in a.opcoes_cbo)if(void 0!==o&&"clean"!=o&&o)for(var t=a.opcoes_cbo[o],i=0;i<a.cbo_opcao_padrao.length;i++){var e=a.cbo_opcao_padrao.eq(i);add_option(e,t.valor,t.nome,1==t.valor?"selected":"")}},this.coletar_dados=function(){a.cbo_opcao_padrao.each(function(o,t){var i=$(t).attr("data-name");a.parametros[i]=$(t).val()})},this.btn_salvar.unbind("click").click(function(o){a.coletar_dados(),Object.keys(a.parametros).length>0&&WS.post({route:"parametro_compartilhado/set_parametro/",type:"POST",data:{parametros:JSON.stringify(a.parametros),tipo:a.cbo_modulo.val()},func_response:function(o){o&&alert_saved("Parametros atualizados com sucesso.")},disabled_buttons:[a.btn_salvar],html_id:a.html_id})}),this.cbo_modulo.unbind("change").change(function(o){var t=$(this);for(var i in a.preencher(),a.dialog.find("[MODULO]").addClass("hidden"),PARAMETRO_COMPARTILHADO_MODULOS){var e=null;if(PARAMETRO_COMPARTILHADO_MODULOS[i].index==t.val()){e=PARAMETRO_COMPARTILHADO_MODULOS[i],a.dialog.find("["+e.id+"]").removeClass("hidden");break}}})}});