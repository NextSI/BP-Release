define([],function(){return function(a){"use strict";var e=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Ações, Metas e resultados (Atuação Efetiva)",this.cbo_funcoes=this.dialog.find(".cbo_funcoes"),this.btn_incluir=this.dialog.find(".btn_incluir"),this.btn_incluir_responsabilidade=this.dialog.find(".btn_incluir_responsabilidade"),this.lista_indicadores=this.dialog.find(".lista_indicadores"),this.btn_proxima_etapa=this.dialog.find(".btn_proxima_etapa"),this.btn_voltar=this.dialog.find(".btn_voltar"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_confirmar=this.dialog.find(".btn_confirmar"),this.btn_fechar=this.dialog.find(".btn_fechar"),this.tabela_responsabilidades=this.dialog.find(".tabela_responsabilidades"),this.tab_indicadores=this.dialog.find(".tab_indicadores"),this.tab_curva_indicadores=this.dialog.find(".tab_curva_indicadores"),this.steps=this.dialog.find(".steps"),this.check_acao=this.dialog.find(".check_acao"),this.check_acao_a2=this.dialog.find(".check_acao_a2"),this.edt_missao_cargo=this.dialog.find(".edt_missao_cargo"),this.edt_performance=this.dialog.find(".edt_performance"),this.btn_info_missao=this.dialog.find(".btn_info_missao"),this.btn_info_responsabilidades=this.dialog.find(".btn_info_responsabilidades"),this.btn_info_indicador=this.dialog.find(".btn_info_indicador"),this.media_efetividade=this.dialog.find(".media_efetividade"),this.media_desejado=this.dialog.find(".media_desejado"),this.media_qe=this.dialog.find(".media_qe"),this.pagina=this.dialog.find(".pagina"),this.edt_funcao=this.dialog.find(".edt_funcao"),this.div_funcao=this.dialog.find(".div_funcao"),this.desc_funcao=this.dialog.find(".desc_funcao"),this.desc_missao=this.dialog.find(".desc_missao"),this.tab_listagem_responsabilidades=this.dialog.find(".tab_listagem_responsabilidades"),this.tab_listagem_indicadores=this.dialog.find(".tab_listagem_indicadores"),this.btn_indicadores=this.dialog.find(".btn_indicadores"),this.lbl_autor=this.dialog.find(".lbl_autor"),this.atuacao_efetiva_avaliacao_id=0,this.atuacao_efetiva_resultado_esperado_id=0,this.versionada=!1,this.indice_atual=0,this.indicador_id=0,this.flag_salvar=!0,this.arr_telas=[],this.atuacao_efetiva_id=0,this.id_responsabilidade_escolhida=0,this.id_responsabilidade_escolhida_a2=0,this.arr_responsabilidades=[],this.arr_indicadores=[],this.limite=3,this.funcao_selecionada=-1,this.tela_atual=1,this.arr_steps=[],this.funcao_id=0,this.id_indicador_escolhido=null,this.id_indicador_escolhido=null,this.show=function(a,i,o,s){o>0&&e.preenche_funcoes(o),e.atuacao_efetiva_id=i,e.indicador_id=a,e.funcao_id=o,e.verifica_status_atuacao_efetiva(i),e.preencher_dados_atuacao_efetiva(e.atuacao_efetiva_id,e.indicador_id),e.carrega_atuacao()},this.salvar_tela_atual=function(){+e.tela_atual<=e.indice_atual&&WS.post("atuacao_efetiva/salvar_tela_atual/",{tela_atual:e.indice_atual,atuacao_efetiva_id:e.atuacao_efetiva_id,indicador_id:e.indicador_id},function(a){$(e.steps.find("li")[e.indice_atual]).fadeIn("slow"),e.tela_atual=a.tela_atual})},this.carrega_atuacao=function(){WS.get("atuacao_efetiva/listar/",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){var i=a[0];i.versao_base>0&&(e.versionada=!0),e.atuacao_efetiva_avaliacao_id=i.atuacao_efetiva_avaliacao_id,e.atuacao_efetiva_resultado_esperado_id=i.atuacao_efetiva_resultado_esperado_id,e.preencher_responsabilidades(),e.preenche_indicadores(),e.lbl_autor.text(i.autor),e.edt_missao_cargo.val(i.missao_cargo),i.funcao_id>0&&($("[modo_edicao]").prop("disabled",!0),e.funcao_id=i.funcao_id),e.btn_proxima_etapa.prop("disabled",!1)})},this.verifica_status_atuacao_efetiva=function(a){WS.get("atuacao_efetiva/listar/",{atuacao_efetiva_id:a},function(a){"S"==a[0].finalizada?($("[modo_edicao]").prop("disabled",!0),e.MODO_EDICAO=!1,e.permite_alterar(!1),$(e.arr_steps[e.arr_steps.length-1]).css("display","inline-block"),e.passos(e.arr_steps.length-1,a&&a.length>0&&void 0!==a[0]?a[0]:[]),e.indice_atual=e.arr_steps.length-1):e.MODO_EDICAO=!0})},this.preenche_funcoes=function(a){WS.get("funcao_hpe/objeto/",{funcao_hpe_id:a},function(a){e.edt_funcao.val(a.funcao.nome),e.edt_missao_cargo.val(a.funcao.missao),e.btn_proxima_etapa.prop("disabled",!1);var i=a.indicadores,o=a.responsabilidades;$.each(i,function(a,i){delete i.id,e.add_row(i)}),$.each(o,function(a,i){delete i.id,e.add_row_responsabilidade(i)}),e.atualiza_array_responsabilidades(),e.atualiza_array_indicadores(),e.salva_dados_responsabilidades(e.arr_responsabilidades),e.salva_dados_indicadores(e.arr_indicadores)})},e.btn_info_missao.unbind("click"),e.btn_info_missao.click(function(a){var e=$('<br><br><p><b style="font-size: 25px;">A</b>ssim como deve existir uma missão da empresa, que é o compromisso e uma orientação objetiva de como a organização deve atuar para cumprir o que esta contido na definição do negocio e na visão da organização, a MISSÃO da FUNÇÃO, também é de suma importancia. Ela vai nortear a sua conduta, atenção e comportamentos essenciais para que você consiga atingir todos os objetivos propostos ou impostos pela empresa. \t\t\t\t<br><br><p><b style="font-size: 25px;">D</b>icas: Não confunda aquilo que deveria ser sua missão (condutas, atenção e comportamentos) com as metas do setor ou da função. A missão será seu norte diário para que vocâ atinja as metas e objetivos, sempre respeitando os valores da empresa, considerando a missão e visão da mesma.\t\t\t\t<br><br><p><b style="font-size: 25px;">E</b>rros mais comuns: \t\t\t\t<br><br><p><b style="font-size: 25px;">E</b>xemplo: Gerente Comercial: Missão (incorreta): “A missão da minha função e fazer a empresa vender”. \t\t\t\t<br><br><p><b style="font-size: 25px;">O</b>bservação: A missão dele deveria ser aquilo que ele tem que pensar, fazer, agir de forma global para que o setor atinja e supere as metas de vendas. Lembrando que no caso de um lider, não é ele que vende ou faz a “empresa” vender. Quem vende são as pessoas, a equipe, e é a conduta, a postura e atenção dele dele com a equipe e conexão com a missão da empresa, será o que fará a diferença. \t\t\t\t<br><br><p><b style="font-size: 25px;">E</b>xemplo: Gerente de Vendas (correto): \t\t\t\t<br><br><p><b style="font-size: 25px;">D</b>igamos que a Missão de empresa a qual ele faz parte seja: Desenvolver e reconhecer a diversidade de talentos, iniciativas e a liderança de nossos funcionários e conquistar a admiração de todos os envolvidos com a (nome da empresa) em todo o mundo. </p>                ');View.load("atuacao_efetiva/tutorial",function(a,i){i.show(e,"Atuacão Efetiva")},View.ABA.NAO)}),e.btn_info_responsabilidades.unbind("click"),e.btn_info_responsabilidades.click(function(a){var e=$('<br><br><p><b style="font-size: 25px;">C</b>omo na maioria das empresa a sua função deve possuir uma série de responsabilidades que por sua vez, deve englobar uma série de tarefas e deveres a cada dia. Algumas delas relacionadas a processos ou atividades administrativas (não necessariamente inclui pessoas) como fazer conferencia de relatórios, atualizar sistemas de controle, ou até mesmo elaboração um planejamento estratégico, assim como responsabilidades com pessoas (sejam estas liderados, pares, superiores ou clientes) como treinar ou desenvolver o time de liderados, relacionar-se de forma sinérgica com pares, fidelizar clientes ou conseguir apoio do conselho / acionista para aprovação de projetos estratégicos, e responsabilidades digamos que mistas, que são processos gerenciais, porém, que envolve também pessoas como: Inovação, Delegação, Supervisão, Coordenação, Gerenciamento, Contratação, Avaliação, Feedback etc. \t\t\t\t<br><br><p><b style="font-size: 25px;">R</b>esponsabilidade não é algo que podemos ter como simples, fácil; por isso a análise detalhada de cada uma delas pode ser revelador, nos ajudar perceber detalhes de atuação, e facilitar de forma significativa a criação de planos de ações corretivas e o mais importante, de forma ações pró-ativas, o que nos dará verdadeiramente competitividade frente ao mercado.\t\t\t\t<br><br><p><b style="font-size: 25px;">P</b>ara isso, segue algumas dicas:\t\t\t\t<br><p><b style="font-size: 25px;">D</b>ica 1. Responsabilidade / Tarefa / Dever, tem em si um objetivo a ser atingido. Por isso, para preencher a Matriz de Responsabilidades é importante que seja colocado “O QUE? (verbo / ação especificamente adequado a função, seja: Coordenar..., Supervisionar..., Treinar..., Apresentar) e PARA QUE? (qual o objetivo ou propósito da ação). \t\t\t\t<br><br><p><b style="font-size: 25px;">E</b>xemplo: \t\t\t\t<br><p><b style="font-size: 25px;">A</b>companhar vendedor externo em visitas a clientes. (Para que?) Para analisar possíveis “gap” de conduta, atuação ou competências, para posterior orientações ou ajustes por meio de feedback, treinamento ou coaching. \t\t\t\t<br><br><p><b style="font-size: 25px;">A</b>o não ter isso muito claro, alguns “gerentes”, até acompanham seus vendedores em campo, porém, acabam por nem observar (fazem no lugar), nem verdadeiramente orientar, nem fornecer feedback, treinamento ou coaching. Ou seja, fazem, porém sem atingir nem de longe, aquilo que seria o propósito da ação. Parece obvio, mas a falta de clareza, gera a falta de consciência, que por sua vez, faz com que simplesmente ignoremos talvez aquilo que seria de maior valor e estratégico na atuação da função. \t\t\t\t<br><br><p><b style="font-size: 25px;">D</b>ica 2. Não é para descrever o que você faz ou não faz. Independentemente de estar ou não fazendo neste momento, isso não quer dizer que deixou de ser sua responsabilidade. Além disso, existem várias atividades que não fazemos, porém, poderiam fazer de maneira mais constante, que se fosse feito, poderia gerar um impacto positivo em meus resultados, lembrando que premissas como falta de tempo ou recursos, também não extingue uma responsabilidade assumida perante a empresa, pessoas ou clientes. A falta de recursos será trabalhado e ou enfrentada nos próximos passos. </p>                 ');View.load("atuacao_efetiva/tutorial",function(a,i){i.show(e,"Atuacão Efetiva")},View.ABA.NAO)}),e.btn_info_indicador.unbind("click"),e.btn_info_indicador.click(function(a){var e=$('<br><p><b style="font-size: 25px;">E</b>mpresas precisam transformar a estratégia da organização em realidade, garantindo a execução, competitividade e assertividade no médio e longo prazo. Baseado nisso o desdobramento de metas para os setores e pessoas juntamente com ferramentas praticas, simples, porém eficazes para o gerenciamento no dia a dia com rituais de acompanhamento, devidamente agendados e padronizados, que permitem que a evolução seja acompanhada de forma sistemática torna-se algo quase vital no cenário atual.<br><p><b style="font-size: 25px;">P</b>or isso, para facilitar o entendimento vamos explicar um pouco mais a diferença (na nossa linguagem) entre objetivos, metas e indicadores. Vamos utilizar um exemplo mais comum e de fácil entendimento.<br><p><b style="font-size: 25px;">E</b>xemplo: Quando alguém diz:  - Quero emagrecer! Esta pessoa está descrevendo um objetivo? Uma meta? Ou um indicador?<br><p><b style="font-size: 25px;">A</b> resposta é: Um objetivo. Para se tornar uma meta, devemos definir alguns pontos, e ser mais especifico, como por exemplo, uma quantidade de peso a ser reduzido em kg (por exemplo) e um tempo ou prazo para que este peso desejado seja atingido. O controle do planejamento / programado da perda de peso de acordo com a evolução do tempo, será nosso indicador de desempenho, os quais iremos acompanhar de forma periódica (diária ou semanal ou mensal etc) com intuito de revelar a tendência do resultado (meta definida) baseado no desempenho atual, permitindo assim, a manutenção ou ajustes ou readequações ou até mesmo, alteração radical do plano de ação se necessário. Ou seja, monitoramento do peso x tempo, será o nosso KPI (Key Performance Indicator, em português, indicadores-chave de desempenho) desejado.<br><p><b style="font-size: 25px;">E</b>xemplo referência - Objetivo: Emagrecer.<br><p><b style="font-size: 25px;">E</b>xemplo corporativo - Objetivo: Ter clientes satisfeitos<br><p><b style="font-size: 25px;">E</b>xemplo referência - Meta: 6 kg em 6 meses.<br><p><b style="font-size: 25px;">E</b>xemplo corporativo - Meta: Atingir NPS acima de 78% no ano de 2018.*NPS (Net Promoter Score) é uma métrica que tem como objetivo medir a satisfação e lealdade dos clientes com as empresas<br><p><b style="font-size: 25px;">E</b>xemplo referência - KPI: Peso reduzido x prazos definidos x programado.<br><p><b style="font-size: 25px;">E</b>xemplo corporativo – KPI – percentual de clientes promotores x percentual de clientes detratores (%promotores ( - ) %detratores).<br><p><b style="font-size: 25px;">C</b>om base nisso, defina quais são suas metas (quantidade / percentual / prazos / qualidades) que devem ser atingidos e o que iremos controlar (que serão nossos KPIs) seremos capazes de acompanhar de forma periódica e sistemática nossos planos de ações x resultados obtidos x correções de rotas durante opercurso.<br><p><b style="font-size: 25px;">D</b>ica 1s: Meça desempenho e NÃO tarefas. Exemplo: Não meça se a tarefa foi feita, mas por exemplo o TEMPO em que ela foi feita, a QUALIDADE com que ela foi feita, a EFICIÊNCIA com que ela foi feita, a QUANTIDADE que foi feita dentro de um prazo pré-estabelecido, o CUSTO com que foi feita. Empresas muitas vezes erram porque medem tarefas e não desempenho. Em geral, utilizam a própria descrição de cargo como indicador de desempenho, ou seja, medem se as pessoas apenas fazem aquilo a qual foram contratadas para fazer e não o quão bem estão fazendo.<br><p><b style="font-size: 25px;">D</b>ica 2. É importante que seja definido aquilo que meça especificamente o seu desempenho, ou seja, aquilo que depende de você.<br><p><b style="font-size: 25px;">E</b>xemplo errado: Concluir todos lançamentos xxx, até dia 30 ou 31 de cada mês. Obs: Imagine que leve pelo menos dois dias para concluir um lançamento xxxx  (isso em um cenário de ótimo desempenho). Porém, digamos que dependa de outros para receber as informações para fazer os lançamentos (gerentes regionais no caso), que por sua vez, costumam entregar as informações com atraso, as vezes um dia ou dois após o prazo que deve ser cumprido. Neste caso, jamais atingiremos a meta ou jamais teremos indicadores positivos. Neste caso, o correto seria definir um prazo de lançamento mediante a data de entrega de cada regional. Mediremos o desempenho à partir deste ponto. Já o problema de atraso por parte dos gerentes regionais, deverá ser tratada à parte de acordo com os critérios e politicas da empresa, porém, sem punir a desempenho de uns em detrimento da falha de outros.</p>');View.load("atuacao_efetiva/tutorial",function(a,i){i.show(e,"Atuacão Efetiva")},View.ABA.NAO)}),this.somente_leitura=function(){e.edt_performance.prop("disabled",!0),e.tabela_possibilidades_a2.find("tbody tr td:nth-child(2) input").prop("disabled",!0),e.tabela_possibilidades.find("tbody tr td:nth-child(2) input").prop("disabled",!0),e.check_acao.attr("disabled",!0),e.check_acao_a2.attr("disabled",!0),e.tabela_responsabilidades.find("tbody tr input").prop("disabled",!0)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){e.unload()}),this.btn_proxima_etapa.unbind("click"),this.btn_proxima_etapa.click(function(){e.flag_salvar=!0,e.indice_atual++,e.salvar_tela_atual(e.indice_atual),e.passos(e.indice_atual)}),this.btn_voltar.unbind("click"),this.btn_voltar.click(function(){e.btn_proxima_etapa.prop("disabled",!1),e.flag_salvar=!1,e.indice_atual--,e.passos(e.indice_atual)}),this.btn_fechar.unbind("click"),this.btn_fechar.click(function(){e.unload()}),this.btn_confirmar.unbind("click"),this.btn_confirmar.click(function(){e.arr_indicadores=[],$.each(e.lista_indicadores.find(".active"),function(a,i){e.arr_indicadores.push({id:$(i).attr("data-id-indicador"),indicador_escolhido:"S"})}),e.salva_dados_indicadores(e.arr_indicadores),e.salva_indicadores_responsabilidades()}),this.salva_indicadores_responsabilidades=function(){WS.post("atuacao_efetiva_indicador_responsabilidade/salvar/",{indicadores:JSON.stringify(e.arr_indicadores),responsabilidades:JSON.stringify(e.arr_responsabilidades),atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){alert_saved("Salvo com sucesso"),e.salva_dados_atuacao_efetiva({finalizada:"S"}),void 0!==e.onsave&&e.onsave&&e.onsave(a),e.unload()})},e.check_acao.change(function(a){var i=$(this).parent().parent().parent().attr("data-id"),o=1==$(this).prop("checked")?"S":"N";i&&1==e.MODO_EDICAO&&e.salva_possibilidade_acao_24_horas([{acao_vinte_quatro_horas:o,id:i}],e.id_responsabilidade_escolhida)}),e.check_acao_a2.change(function(a){var i=$(this).parent().parent().parent().attr("data-id"),o=1==$(this).prop("checked")?"S":"N";i&&1==e.MODO_EDICAO&&e.salva_possibilidade_acao_24_horas([{acao_vinte_quatro_horas:o,id:i}],e.id_responsabilidade_escolhida_a2)}),this.finaliza_atuacao_efetiva_indicador=function(){WS.post("atuacao_efetiva_indicador/salvar/",{atuacao_efetiva_indicador_id:e.indicador_id,finalizado:"S"},function(a){alert_saved("Salvo com sucesso"),void 0!==e.onsave&&e.onsave&&e.onsave(a)})},this.salva_dados_atuacao_efetiva=function(a){WS.post("atuacao_efetiva/salvar/",{missao_cargo:a.missao_cargo,atuacao_efetiva_id:e.atuacao_efetiva_id,acao_sete_dias:a.acao_sete_dias,acao_trinta_dias:a.acao_trinta_dias,indicador_id:e.indicador_id,funcao_id:a.funcao_id,funcao:a.funcao,finalizada:a.finalizada},function(a){alert_saved("Salvo com sucesso"),void 0!==e.onsave&&e.onsave&&e.onsave(a)})},this.salva_dados_indicadores=function(a){WS.post("atuacao_efetiva_indicador/salvar/",{indicadores:JSON.stringify(a),responsabilidades:JSON.stringify(e.arr_responsabilidades),atuacao_efetiva_id:e.atuacao_efetiva_id,indicador_id:e.indicador_id},function(a){alert_saved("Salvo com sucesso"),e.preenche_indicadores(),e.preenche_lista_escolha_indicadores(a),void 0!==e.onsave&&e.onsave&&e.onsave(a)})},this.preenche_lista_escolha_indicadores=function(a){e.lista_indicadores.find("a").not("[template-item]").remove(),$.each(a,function(a,i){var o=e.lista_indicadores.find("[template-item]").first().clone();o.removeAttr("template-item"),o.css("display","");var s=o.find("[template-label]");s.removeAttr("template-label"),"S"==i.finalizado?(o.attr("data-finalizado","S"),s.addClass("label label-success").html("Concluído").removeClass("hidden")):"S"==i.iniciado&&(o.attr("data-iniciado","S"),s.addClass("label label-info").html("Em andamento").removeClass("hidden")),"S"==i.indicador_escolhido&&(e.id_indicador_escolhido=i.id),o.attr("data-resultado-esperado-id",i.resultado_esperado_id),o.unbind("click"),o.click(function(a){var o=$(this),s=o.closest(".lista_indicadores"),t=!1,d=null;$.each(s.closest(".lista_indicadores").find("a:not([template-item])"),function(a,e){var i=$(e),o=i.attr("data-id-indicador");"S"==i.attr("data-iniciado")&&"S"!=i.attr("data-finalizado")&&(t=!0,d=o)}),"S"!=i.iniciado||"S"!=i.finalizado?t?i.id==d?alert_modal("Atuação Efetiva","Indicador em andamento, deseja ir para matriz?","Sim",function(){View.load("atuacao_efetiva/passos_indicador",function(a,o){o.show(e.atuacao_efetiva_id,i.id)},View.ABA.MULTIPLAS)},!0,"Não",null,function(){}):alert_modal("Atuação Efetiva","Já existe um indicador em andamento, finalize-o antes de iniciar outro."):WS.post("atuacao_efetiva_indicador/salvar/",{indicadores:JSON.stringify([{id:i.id,indicador_escolhido:o.hasClass("active")?"N":"S"}]),atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){o.toggleClass("active"),"S"==a[0].indicador_escolhido&&alert_modal("Atuação Efetiva","Deseja iniciar o preenchimento do indicador <b>"+a[0].nome+"?","Sim",function(){e.salva_indicadores_responsabilidades(),View.load("atuacao_efetiva/passos_indicador",function(a,o){WS.post("atuacao_efetiva/salvar/",{atuacao_efetiva_id:e.atuacao_efetiva_id,finalizada:"S"},function(a){e.unload(),o.show(e.atuacao_efetiva_id,i.id),alert_saved("Dados salvos com sucesso")})},View.ABA.MULTIPLAS)},!0,"Não",null,function(){})}):alert_modal("Atuação Efetiva","Indicador já concluído, não pode ser desmarcado, deseja ir para matriz do indicador?","Sim",function(){View.load("atuacao_efetiva/passos_indicador",function(a,o){o.show(e.atuacao_efetiva_id,i.id)},View.ABA.MULTIPLAS)},!0,"Não",null,function(){})});var t=o.find(".btn_metas");"S"==i.indicador_escolhido&&$(o).addClass("active"),o.attr("data-id-indicador",i.id),t.click(function(a){return o.hasClass("active")?View.load("atuacao_efetiva/metas_indicador_principal",function(a,e){e.show(i.atuacao_efetiva_id,i.id,App.sessao.dados.usuario_id)}):alert_modal("Atuação Efetiva","Selecione o indicador para definir a meta SMART."),!1}),o.find("[template-nome]").text(i.nome),e.lista_indicadores.append(o)})},this.preenche_indicadores=function(){WS.get("atuacao_efetiva_indicador/listar/",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){e.tab_indicadores.find("tbody tr:not([template-row])").remove(),$.each(a,function(a,i){e.arr_indicadores.push({indicador:i.nome,id:i.id}),e.preenche_indicadores_resumo(),e.add_row(i)}),e.preenche_lista_escolha_indicadores(a)})},this.add_row=function(a){var i=e.tab_indicadores.find("tbody"),o=i.find("tr:first").clone();o.removeAttr("template-row"),o.css("display","");var s=$(o.find("[template-field='nome'] input"));s.attr("maxlength","255"),void 0!==a&&null!=a&&""!=a&&(s.val(a.nome),o.attr("data-id-indicador",a.id));var t=$(o.find(".btn_excluir"));if(t.unbind("click"),t.click(function(){alert_modal("Atuação Efetiva","Deseja remover este indicador?","Remover",function(){1==e.MODO_EDICAO?void 0!==a?WS.post("atuacao_efetiva_indicador/excluir/",{atuacao_efetiva_indicador_id:a.id},function(a){o.remove(),alert_saved("indicador excluído com sucesso")}):o.remove():alert_saved("Modo de visualização!")},!0)}),!e.MODO_EDICAO){var d=$(o.find(".btn_editar"));d.removeClass("hidden"),d.unbind("click"),d.click(function(){var i=$(this).closest("tbody"),o=$(this).find("span");o.hasClass("glyphicon-pencil")?(i.find("tr").not("[template-row]").find(".btn_editar").find("span").removeClass("glyphicon-ok").addClass("glyphicon-pencil"),i.find("tr").not("[template-row]").find("[type='text']").attr("disabled",!0),s.removeAttr("disabled"),s.focus(),o.removeClass("glyphicon-pencil").addClass("glyphicon-ok")):(e.salva_dados_indicadores([{indicador:s.val(),id:a.id}]),s.attr("disabled",!0),o.addClass("glyphicon-pencil").removeClass("glyphicon-ok"))})}o.appendTo(i),s.focus()},this.add_row_responsabilidade=function(a){var i=e.tabela_responsabilidades.find("tbody"),o=i.find("[template-row]").clone();o.removeAttr("template-row"),o.css("display","");var s=o.find('[template-field="descricao"]');a&&(o.attr({"data-id":a.id,"data-desejado":a.desejado}),s.val(a.descricao));var t=o.find(".btn_excluir");t.unbind("click"),t.click(function(){void 0!==a&&null!=typeof a?alert_modal("Evento Agenda","Tem certeza que deseja deletar esta responsabilidade?","Sim",function(){WS.post("atuacao_efetiva_responsabilidades/excluir/",{responsabilidade_id:a.id,atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){o.fadeOut(),alert_saved("registro excluído")})},!0,"Não",function(){}):o.fadeOut()}),o.appendTo(i),s.focus(),s.unbind("keydownn"),s.keydown(function(a){if(13===a.which){var o=$(i).find("input").not(":first");if(o.index(this)!=$(o).length-1){var s=o.index(this)+1;o.eq(s).focus()}else e.add_row_responsabilidade()}})},e.btn_incluir.unbind("click"),e.btn_incluir.click(function(a){e.add_row()}),e.btn_incluir_responsabilidade.unbind("click"),e.btn_incluir_responsabilidade.click(function(a){e.add_row_responsabilidade()}),this.salva_dados_responsabilidades=function(a){WS.post("atuacao_efetiva_responsabilidades/salvar/",{responsabilidades:JSON.stringify(a),atuacao_efetiva_id:e.atuacao_efetiva_id,indicador_id:e.indicador_id,calculo_efetividade:parseInt(e.media_efetividade.text()),calculo_desejado:parseInt(e.media_desejado.text()),calculo_qe:parseInt(e.media_qe.text())},function(a){e.preencher_responsabilidades(),alert_saved("Salvo com sucesso"),void 0!==e.onsave&&e.onsave&&e.onsave(a)})},this.preencher_responsabilidades=function(){WS.get("atuacao_efetiva_responsabilidades/listar/",{atuacao_efetiva_id:e.atuacao_efetiva_id},function(a){if(e.tabela_responsabilidades.find("tbody tr").not("[template-row]").remove(),a.length<=0)for(var i=0;i<5;i++)e.add_row_responsabilidade();$.each(a,function(a,i){e.add_row_responsabilidade(i)}),e.atualiza_array_responsabilidades(),e.preenche_responsabilidades_resumo()})},this.atualiza_array_responsabilidades=function(){e.arr_responsabilidades=[],$.each(e.tabela_responsabilidades.find("tbody tr").not("[template-row]"),function(a,i){""!=$(i).find("td:nth-child(1) input").val().trim()&&e.arr_responsabilidades.push({responsabilidade:$(this).find("td:nth-child(1) input").val(),desejado:$(this).attr("data-desejado"),id:$(this).attr("data-id")})})},this.atualiza_array_indicadores=function(){e.arr_indicadores=[],$.each(e.tab_indicadores.find("tbody tr").not("[template-row]"),function(a,i){""!=$(i).find("td:nth-child(1) input").val().trim()&&e.arr_indicadores.push({indicador:$(i).find("td:nth-child(1) input").val(),id:$(i).attr("data-id-indicador")})})},this.preencher_dados_atuacao_efetiva=function(a,i){WS.get("atuacao_efetiva/listar_passo/",{atuacao_efetiva_id:a,indicador_id:i},function(a){var i=a[0];i.tela_atual=i.tela_atual||0,e.tela_atual=i.tela_atual;for(var o=0;o<=+i.tela_atual;o++)$(e.steps.find("li")[o]).show();void 0!==i&&(e.edt_missao_cargo.val(i.missao_cargo),e.edt_funcao.val(i.funcao))})},this.arr_metodos_telas=[{metodo:function(){e.edt_funcao.keyup(function(a){$(this).val().trim().length>0?e.btn_proxima_etapa.prop("disabled",!1):e.btn_proxima_etapa.prop("disabled",!0)}),-1!=e.cbo_funcoes.val()&&null!=e.cbo_funcoes.val()||""!=e.edt_funcao.val()?e.btn_proxima_etapa.prop("disabled",!1):e.btn_proxima_etapa.prop("disabled",!0)}},{metodo:function(){""!=e.edt_missao_cargo.val()?e.btn_proxima_etapa.prop("disabled",!1):e.btn_proxima_etapa.prop("disabled",!0),e.edt_missao_cargo.keyup(function(a){$(this).val().trim().length>0?e.btn_proxima_etapa.prop("disabled",!1):e.btn_proxima_etapa.prop("disabled",!0)}),1==e.flag_salvar&&1==e.MODO_EDICAO&&e.salva_dados_atuacao_efetiva({funcao:e.edt_funcao.val(),funcao_id:-1!=e.cbo_funcoes.val()?e.cbo_funcoes.val():null}),e.edt_missao_cargo.focus()}},{metodo:function(){1==e.flag_salvar&&1==e.MODO_EDICAO&&e.salva_dados_atuacao_efetiva({missao_cargo:e.edt_missao_cargo.val()})}},{metodo:function(){var a=0;if($.each(e.tabela_responsabilidades.find("tbody tr td input"),function(e,i){""!=$(i).val()&&a++}),0==a){var i=new Validation;return i.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Cadastre ao menos uma Responsabilidade")),alert_modal("Validação",i),e.flag_salvar=!1,e.indice_atual--,void e.passos(e.indice_atual)}e.atualiza_array_responsabilidades(),1==e.flag_salvar&&1==e.MODO_EDICAO&&e.salva_dados_responsabilidades(e.arr_responsabilidades)}},{metodo:function(){if(e.atualiza_array_indicadores(),e.arr_indicadores.length<1){var a=new Validation;return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Cadastre ao menos um Indicador.")),alert_modal("Validação",a),e.flag_salvar=!1,e.indice_atual--,void e.passos(e.indice_atual)}1==e.flag_salvar&&1==e.MODO_EDICAO&&e.salva_dados_indicadores(e.arr_indicadores),e.btn_proxima_etapa.addClass("hidden"),e.btn_confirmar.css("display","inline-block")}},{metodo:function(a){e.desc_funcao.text(a.funcao),e.desc_missao.text(a.missao_cargo)}}],this.preenche_responsabilidades_resumo=function(){var a=e.tab_listagem_responsabilidades.find("tbody");a.find("tr:not([template-row])").remove(),$.each(e.arr_responsabilidades,function(e,i){var o=a.find("[template-row]").clone();o.removeAttr("template-row"),o.css("display",""),o.find("td input").val(i.responsabilidade),a.append(o)})},this.preenche_indicadores_resumo=function(){var a=e.tab_listagem_indicadores.find("tbody");a.find("tr:not([template-row])").remove(),$.each(e.arr_indicadores,function(e,i){var o=a.find("[template-row]").clone();o.removeAttr("template-row"),o.css("display",""),o.find("td input").val(i.indicador),a.append(o)})},e.btn_indicadores.unbind("click"),e.btn_indicadores.click(function(a){e.passos(e.arr_steps.length-2),e.indice_atual=e.arr_steps.length-2}),this.passos=function(a,i){void 0===i&&(i=[]),e.dialog.find("[tipo='etapa']").addClass("hidden"),$(e.arr_steps).removeClass("active"),e.arr_telas.length==a?(e.btn_confirmar.css("display","inline-block"),e.btn_proxima_etapa.addClass("hidden")):(e.btn_confirmar.css("display","none"),e.btn_proxima_etapa.removeClass("hidden")),$(e.arr_telas[a]).removeClass("hidden"),$(e.arr_steps[a]).addClass("active"),0!=a?e.btn_voltar.removeClass("hidden"):e.btn_voltar.addClass("hidden"),5==a?e.arr_metodos_telas[a].metodo(i):e.arr_metodos_telas[a].metodo(),e.pagina.text(a+1+"/"+e.arr_metodos_telas.length)},this.pega_telas=function(){$.each(e.dialog.find("[tipo='etapa']"),function(a,i){e.arr_telas.push(i)}),$.each(e.steps.find("li"),function(a,i){$(i).click(function(i){e.passos(a),e.indice_atual=a}),e.arr_steps.push(i)})},this.permite_alterar=function(a){$.each(e.tabela_responsabilidades,function(i,o){e.tabela_responsabilidades.find("tbody tr input").prop("readonly",!a)}),e.btn_incluir.prop("readonly",!a),e.cbo_funcoes.prop("readonly",!a),e.edt_funcao.prop("readonly",!a),e.edt_missao_cargo.prop("readonly",!a)},e.pega_telas(),e.passos(e.indice_atual),e.steps.find("li").hide(),this.unload=function(){e.close(),View.unload(this.html_id)},this.close=function(){void 0!==e.onclose&&e.onclose&&e.onclose()}}});