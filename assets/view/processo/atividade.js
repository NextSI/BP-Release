define([],function(){return function(e){"use strict";var a=this;this.html_id=e,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.onremove=null,this.lbl_titulo_atividade=this.dialog.find(".lbl_titulo_atividade"),this.lbl_titulo_id=this.dialog.find(".lbl_titulo_id"),this.lbl_tab_geral=this.dialog.find(".lbl_tab_geral"),this.lbl_tab_responsaveis=this.dialog.find(".lbl_tab_responsaveis"),this.lbl_tab_notificacoes=this.dialog.find(".lbl_tab_notificacoes"),this.lbl_tab_gestao_tempo=this.dialog.find(".lbl_tab_gestao_tempo"),this.lbl_tab_fluxo=this.dialog.find(".lbl_tab_fluxo"),this.lbl_tab_acoes=this.dialog.find(".lbl_tab_acoes"),this.edt_descricao=this.dialog.find(".edt_descricao"),this.cbo_tipo=this.dialog.find(".cbo_tipo"),this.div_instrucao_trabalho=this.dialog.find(".div_instrucao_trabalho"),this.edt_instrucao_trabalho=this.dialog.find(".edt_instrucao_trabalho"),this.tab_usuario_responsavel=this.dialog.find(".tab_usuario_responsavel"),this.btn_add_usuario_responsavel=this.dialog.find(".btn_add_usuario_responsavel"),this.tab_grupo_usuarios_responsavel=this.dialog.find(".tab_grupo_usuarios_responsavel"),this.btn_add_grupo_usuarios_responsaveis=this.dialog.find(".btn_add_grupo_usuarios_responsaveis"),this.chk_responsavel_obrigatorio=this.dialog.find(".chk_responsavel_obrigatorio"),this.chk_grupo_responsavel_obrigatorio=this.dialog.find(".chk_grupo_responsavel_obrigatorio"),this.chk_solicitante_responsavel_obrigatorio=this.dialog.find(".chk_solicitante_responsavel_obrigatorio"),this.chk_tornar_executor_responsavel=this.dialog.find(".chk_tornar_executor_responsavel"),this.chk_tornar_superior_imediato_responsavel=this.dialog.find(".chk_tornar_superior_imediato_responsavel"),this.chk_responsavel_anonimo=this.dialog.find(".chk_responsavel_anonimo"),this.chk_multiplos_responsaveis=this.dialog.find(".chk_multiplos_responsaveis"),this.select_atividade=this.dialog.find(".select_atividade"),this.div_select_atividade=this.dialog.find(".div_select_atividade"),this.select_tornar_superior_imediato_responsavel=this.dialog.find(".select_tornar_superior_imediato_responsavel"),this.div_select_atividade_executor_responsavel=this.dialog.find(".div_select_atividade_executor_responsavel"),this.responsavel_ativo=this.dialog.find(".responsavel_ativo"),this.div_configuracoes=this.dialog.find(".div_configuracoes"),this.div_observacao_inicio=this.dialog.find(".div_observacao_inicio"),this.chk_notifica_solicitante=this.dialog.find(".chk_notifica_solicitante"),this.col_notifica_responsavel=this.dialog.find(".col_notifica_responsavel"),this.chk_notifica_responsavel=this.dialog.find(".chk_notifica_responsavel"),this.edt_emails_notificacao=this.dialog.find(".edt_emails_notificacao"),this.chk_email_terceiros=this.dialog.find(".chk_email_terceiros"),this.chk_email_terc_entr=this.dialog.find(".chk_email_terc_entr"),this.chk_email_usuario_senha_responsavel=this.dialog.find(".chk_email_usuario_senha_responsavel"),this.chk_email_formulario=this.dialog.find(".chk_email_formulario"),this.chk_email_anexo=this.dialog.find(".chk_email_anexo"),this.chk_notifica_solicitante_entrega=this.dialog.find(".chk_notifica_solicitante_entrega"),this.chk_notifica_responsavel_entrega=this.dialog.find(".chk_notifica_responsavel_entrega"),this.edt_emails_notificacao_entrega=this.dialog.find(".edt_emails_notificacao_entrega"),this.chk_email_formulario_entrega=this.dialog.find(".chk_email_formulario_entrega"),this.chk_ocultar_numero_no_inicio=this.dialog.find(".chk_ocultar_numero_no_inicio"),this.chk_ocultar_numero_na_entrega=this.dialog.find(".chk_ocultar_numero_na_entrega"),this.chk_enviar_obs_predecessora=this.dialog.find(".chk_enviar_obs_predecessora"),this.chk_enviar_obs=this.dialog.find(".chk_enviar_obs"),this.chk_email_corpo_formulario=this.dialog.find(".chk_email_corpo_formulario"),this.chk_email_corpo_formulario_entrega=this.dialog.find(".chk_email_corpo_formulario_entrega"),this.div_notificar_email_entrega=this.dialog.find(".div_notificar_email_entrega"),this.div_informar_emails_terceiros=this.dialog.find(".div_informar_emails_terceiros"),this.div_enviar_email_senha_responsavel=this.dialog.find(".div_enviar_email_senha_responsavel"),this.div_solicitante=this.dialog.find(".div_solicitante"),this.div_responsavel=this.dialog.find(".div_responsavel"),this.div_outros_emails=this.dialog.find(".div_outros_emails"),this.div_ocultar_solicitacao=this.dialog.find(".div_ocultar_solicitacao"),this.permitir_informar_emails_terceiros=this.dialog.find(".permitir_informar_emails_terceiros"),this.enviar_anexo_no_email_workflow=this.dialog.find(".enviar_anexo_no_email_workflow"),this.enviar_formulario_corpo_email_workflow=this.dialog.find(".enviar_formulario_corpo_email_workflow"),this.enviar_observacoes_atividade_no_email=this.dialog.find(".enviar_observacoes_atividade_no_email"),this.edt_tempo_prazo_execucao=this.dialog.find(".edt_tempo_prazo_execucao"),this.chk_permite_reprogramar=this.dialog.find(".chk_permite_reprogramar"),this.chk_acumular_tempo=this.dialog.find(".chk_acumular_tempo"),this.edt_notifica_vencto_horas_antes=this.dialog.find(".edt_notifica_vencto_horas_antes"),this.chk_notifica_vencto_solicitante=this.dialog.find(".chk_notifica_vencto_solicitante"),this.chk_notifica_vencto_responsavel=this.dialog.find(".chk_notifica_vencto_responsavel"),this.edt_emails_notificacao_vencto=this.dialog.find(".edt_emails_notificacao_vencto"),this.chk_tipo_hora=this.dialog.find(".chk_tipo_hora"),this.edt_dias_corridos=this.dialog.find(".edt_dias_corridos"),this.chk_predecessora_data=this.dialog.find(".chk_predecessora_data"),this.chk_dias_corridos=this.dialog.find(".chk_dias_corridos"),this.chk_horas_uteis=this.dialog.find(".chk_horas_uteis"),this.div_chk_predecessora_data=this.dialog.find(".div_chk_predecessora_data"),this.chk_data_referencia=this.dialog.find(".chk_data_referencia"),this.edt_data_referencia=this.dialog.find(".edt_data_referencia"),this.tab_fluxo=this.dialog.find(".tab_fluxo"),this.btn_add_fluxo=this.dialog.find(".btn_add_fluxo"),this.tab_permissoes=this.dialog.find(".tab_permissoes"),this.lbl_nome_formulario=this.dialog.find(".lbl_nome_formulario"),this.chk_acao_projeto_template=this.dialog.find(".chk_acao_projeto_template"),this.edt_percent_projeto=this.dialog.find(".edt_percent_projeto"),this.div_porcentagem=this.dialog.find(".div_porcentagem"),this.tab_usuario_atividade=this.dialog.find(".tab_usuario_atividade"),this.lbl_chk_altera_usuario=this.dialog.find(".lbl_chk_altera_usuario"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.div_envio_predecessora=this.dialog.find(".div_envio_predecessora"),this.div_tornar_executor_responsave=this.dialog.find(".div_tornar_executor_responsave"),this.atividade={id:0,elemento_tipo:PROCESSO_ELEMENTO_TIPO.ATIVIDADE,descricao:"",instrucao_trabalho:"",tipo:PROCESSO_ATIVIDADE_TIPO.INICIO,usuarios_responsaveis:[],grupos_usuarios_responsaveis:[],responsavel_obrigatorio:!1,grupo_usuarios_responsaveis_obrigatorio:!1,notifica_solicitante:!0,notifica_responsavel:!0,emails_notificacao:"",email_terceiros:!1,email_terceiros_entrega:!1,tempo_prazo_execucao:null,permite_reprogramar:!0,acumular_tempo:!1,notifica_vencto_horas_antes:null,notifica_vencto_solicitante:!1,notifica_vencto_responsavel:!1,emails_notificacao_vencto:"",acao_projeto_template:!1,destinos:[],permissoes_formulario:[],removido:!1,notifica_senha:!1,notifica_formulario:!1,envia_anexos:!1,tipo_prazo_execucao:0,dias_prazo_execucao:null,acao_projeto_template_conclusao:null,notifica_formulario_entrega:!1,notifica_solicitante_entrega:!0,notifica_responsavel_entrega:!0,emails_notificacao_entrega:"",data_referencia:null,ocultar_numero_no_inicio:!1,ocultar_numero_na_entrega:!1,solicitante_responsavel:!1,enviar_obs:!1,enviar_obs_predecessora:!1,notifica_corpo_formulario:!1,notifica_corpo_formulario_entrega:!1,atividade_responsavel_automatico_id:!1,atividade_superior_imediato_responsavel_id:null,multiplos_responsaveis:!1},this.elemento_pai=null,this.processo_ref=null,this.formulario_ref=null,this.show=function(e,i,o,t,r,s,_){switch(a.edt_instrucao_trabalho.attr("id","edt_instrucao_trabalho"+a.html_id),void 0!==e&&e&&(a.atividade=clone_obj(e)),void 0!==o&&o&&(a.processo_ref=o),void 0!==t&&t&&(a.formulario_ref=t),void 0!==r&&r&&(a.elemento_pai=r,e||(a.atividade.tipo=PROCESSO_ATIVIDADE_TIPO.NORMAL)),void 0!==_&&_&&(a.atividade.tipo=_),i){case FORMULARIO.NOVO:case FORMULARIO.EDITAR:a.btn_salvar.show(),a.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:case FORMULARIO.EXCLUIR:a.btn_salvar.hide(),a.permite_alterar(!1)}if(a.tipo=i,a.edt_tempo_prazo_execucao.mask("000:00"),a.edt_notifica_vencto_horas_antes.mask("000:00"),show_modal(a.modal.attr("id")),set_focus(a.edt_descricao),0==a.processo_ref.elementos.length&&a.btn_add_fluxo.attr("disabled",!0),s&&s.find("a").tab("show"),e&&e.tipo==PROCESSO_ATIVIDADE_TIPO.INICIO&&a.div_configuracoes.addClass("hidden"),o.elementos){var d=o.elementos.filter(function(a,i){return e?!(a.elemento_tipo!=PROCESSO_ELEMENTO_TIPO.ATIVIDADE||a.tipo!=PROCESSO_ATIVIDADE_TIPO.NORMAL&&a.tipo!=PROCESSO_ATIVIDADE_TIPO.INICIO||e.id==a.id&&e.elem_key==a.elem_key):a.elemento_tipo==PROCESSO_ELEMENTO_TIPO.ATIVIDADE&&(a.tipo==PROCESSO_ATIVIDADE_TIPO.NORMAL||a.tipo==PROCESSO_ATIVIDADE_TIPO.INICIO)});d=d.map(function(e,a){return{id:e.id||e.elem_key,descricao:e.descricao}})}var n="";"number"==typeof a.atividade.atividade_responsavel_automatico_id&&a.atividade.atividade_responsavel_automatico_id>0?n=a.atividade.atividade_responsavel_automatico_id:null!=a.atividade.atividade_responsavel_automatico_elem_key&&""!=a.atividade.atividade_responsavel_automatico_elem_key&&(n=a.atividade.atividade_responsavel_automatico_elem_key);var c="";"number"==typeof a.atividade.atividade_superior_imediato_responsavel_id&&a.atividade.atividade_superior_imediato_responsavel_id>0?c=a.atividade.atividade_superior_imediato_responsavel_id:null!=a.atividade.atividade_superior_imediato_responsavel_elem_key&&""!=a.atividade.atividade_superior_imediato_responsavel_elem_key&&(c=a.atividade.atividade_superior_imediato_responsavel_elem_key),a.select_atividade.dxSelectBox({dataSource:d,displayExpr:"descricao",valueExpr:"id",searchEnabled:!0,placeholder:"Escolha uma atividade",showClearButton:!0,value:n}),a.select_tornar_superior_imediato_responsavel.dxSelectBox({dataSource:d,displayExpr:"descricao",valueExpr:"id",searchEnabled:!0,placeholder:"Escolha uma atividade",showClearButton:!0,value:c}),a.preencher()},this.close=function(){close_modal(a.modal.attr("id")),void 0!==a.onclose&&a.onclose&&a.onclose()},this.unload=function(){a.close(),View.unload(this.html_id)},this.permite_alterar=function(e){},this.radios=function(){a.edt_dias_corridos.prop("disabled",!1),a.edt_tempo_prazo_execucao.prop("disabled",!1),a.edt_data_referencia.prop("disabled",!1),!0===a.chk_horas_uteis.prop("checked")?(a.atividade.tipo_prazo_execucao=SOLICITACAO_TIPO_HORA.HORAS_UTEIS,a.edt_dias_corridos.val(""),a.edt_dias_corridos.prop("disabled",!0),a.edt_data_referencia.val(""),a.edt_data_referencia.prop("disabled",!0)):!0===a.chk_dias_corridos.prop("checked")?(a.atividade.tipo_prazo_execucao=SOLICITACAO_TIPO_HORA.DIAS_CORRIDOS,a.edt_tempo_prazo_execucao.val(""),a.edt_tempo_prazo_execucao.prop("disabled",!0),a.edt_data_referencia.val(""),a.edt_data_referencia.prop("disabled",!0)):!0===a.chk_predecessora_data.prop("checked")?(a.atividade.tipo_prazo_execucao=SOLICITACAO_TIPO_HORA.DATA_PRDECESSORA,a.edt_tempo_prazo_execucao.val(""),a.edt_tempo_prazo_execucao.prop("disabled",!0),a.edt_dias_corridos.val(""),a.edt_dias_corridos.prop("disabled",!0),a.edt_data_referencia.val(""),a.edt_data_referencia.prop("disabled",!0)):!0===a.chk_data_referencia.prop("checked")&&(a.atividade.tipo_prazo_execucao=SOLICITACAO_TIPO_HORA.DATA_REFERENCIA,a.edt_tempo_prazo_execucao.val(""),a.edt_tempo_prazo_execucao.prop("disabled",!0),a.edt_dias_corridos.val(""),a.edt_dias_corridos.prop("disabled",!0))},this.preencher=function(){var e=a.chk_notifica_solicitante.prop("disabled");if(void 0!==a.atividade.id&&a.atividade.id>0?a.lbl_titulo_id.text("Id."+a.atividade.id):a.lbl_titulo_id.text(""),a.lbl_titulo_atividade.text(a.atividade.descricao),a.edt_descricao.val(a.atividade.descricao),set_tinymce(a.edt_instrucao_trabalho,a.atividade.instrucao_trabalho),a.cbo_tipo.val(a.atividade.tipo).trigger("change"),a.render_usuarios_responsaveis(),a.render_grupos_usuarios_responsaveis(),a.chk_responsavel_obrigatorio.prop("disabled",!1),a.chk_responsavel_obrigatorio.prop("checked","true"===a.atividade.responsavel_obrigatorio.toString()),a.chk_responsavel_obrigatorio.prop("disabled",e),a.chk_grupo_responsavel_obrigatorio.prop("disabled",!1),a.chk_grupo_responsavel_obrigatorio.prop("checked","true"===a.atividade.grupo_usuarios_responsaveis_obrigatorio.toString()),a.chk_grupo_responsavel_obrigatorio.prop("disabled",e),a.chk_solicitante_responsavel_obrigatorio.prop("disabled",!1),a.chk_solicitante_responsavel_obrigatorio.prop("checked","true"===a.atividade.solicitante_responsavel.toString()),a.chk_solicitante_responsavel_obrigatorio.prop("disabled",e),a.chk_multiplos_responsaveis.prop("disabled",!1),a.chk_multiplos_responsaveis.prop("checked","true"===a.atividade.multiplos_responsaveis.toString()),a.chk_multiplos_responsaveis.prop("disabled",e),a.chk_notifica_solicitante.prop("disabled",!1),a.chk_notifica_solicitante.prop("checked","true"===a.atividade.notifica_solicitante.toString()),a.chk_notifica_solicitante.prop("disabled",e),a.chk_notifica_solicitante_entrega.prop("disabled",!1),a.chk_notifica_solicitante_entrega.prop("checked","true"===a.atividade.notifica_solicitante_entrega.toString()),a.chk_notifica_solicitante_entrega.prop("disabled",e),a.chk_notifica_responsavel.prop("disabled",!1),a.chk_notifica_responsavel.prop("checked","true"===a.atividade.notifica_responsavel.toString()),a.chk_notifica_responsavel.prop("disabled",e),a.chk_notifica_responsavel_entrega.prop("disabled",!1),a.chk_notifica_responsavel_entrega.prop("checked","true"===a.atividade.notifica_responsavel_entrega.toString()),a.chk_notifica_responsavel_entrega.prop("disabled",e),a.edt_emails_notificacao.val(a.atividade.emails_notificacao),a.edt_emails_notificacao_entrega.val(a.atividade.emails_notificacao_entrega),a.chk_email_terceiros.prop("disabled",!1),a.chk_email_terceiros.prop("checked","true"===a.atividade.email_terceiros.toString()),a.chk_email_terceiros.prop("disabled",e),a.chk_email_terc_entr.prop("disabled",!1),a.chk_email_terc_entr.prop("checked","true"===a.atividade.email_terceiros_entrega.toString()),a.chk_email_terc_entr.prop("disabled",e),a.chk_ocultar_numero_no_inicio.prop("disabled",!1),a.chk_ocultar_numero_no_inicio.prop("checked",1==a.atividade.ocultar_numero_no_inicio),a.chk_ocultar_numero_no_inicio.prop("disabled",e),a.chk_ocultar_numero_na_entrega.prop("disabled",!1),a.chk_ocultar_numero_na_entrega.prop("checked",1==a.atividade.ocultar_numero_na_entrega),a.chk_ocultar_numero_na_entrega.prop("disabled",e),a.chk_email_usuario_senha_responsavel.prop("disabled",!1),a.chk_email_usuario_senha_responsavel.prop("checked",1==a.atividade.notifica_senha),a.chk_email_usuario_senha_responsavel.prop("disabled",e),a.chk_email_formulario.prop("disabled",!1),a.chk_email_formulario.prop("checked",1==a.atividade.notifica_formulario),a.chk_email_formulario.prop("disabled",e),a.chk_email_formulario_entrega.prop("disabled",!1),a.chk_email_formulario_entrega.prop("checked",1==a.atividade.notifica_formulario_entrega),a.chk_email_formulario_entrega.prop("disabled",e),a.chk_email_anexo.prop("disabled",!1),a.chk_email_anexo.prop("checked",1==a.atividade.envia_anexos),a.chk_email_anexo.prop("disabled",e),a.chk_enviar_obs.prop("disabled",!1),a.chk_enviar_obs.prop("checked",1==a.atividade.enviar_obs),a.chk_enviar_obs.prop("disabled",e),a.chk_enviar_obs_predecessora.prop("disabled",!1),a.chk_enviar_obs_predecessora.prop("checked",1==a.atividade.enviar_obs_predecessora),a.chk_enviar_obs_predecessora.prop("disabled",e),a.chk_email_corpo_formulario.prop("checked",1==a.atividade.notifica_corpo_formulario),a.chk_email_corpo_formulario_entrega.prop("checked",1==a.atividade.notifica_corpo_formulario_entrega),a.atividade.tipo_prazo_execucao==SOLICITACAO_TIPO_HORA.HORAS_UTEIS){if(""!=a.atividade.tempo_prazo_execucao&&null!=a.atividade.tempo_prazo_execucao&&a.atividade.tempo_prazo_execucao.length>6){for(var i=9-(t=a.atividade.tempo_prazo_execucao).length,o=0;o<i;o++)t="0"+t;a.atividade.tempo_prazo_execucao=t}a.chk_horas_uteis.prop("checked",!0).trigger("click")}else a.atividade.tipo_prazo_execucao==SOLICITACAO_TIPO_HORA.DIAS_CORRIDOS?(a.chk_dias_corridos.prop("checked",!0).trigger("click"),a.atividade.dias_prazo_execucao>0&&a.edt_dias_corridos.val(a.atividade.dias_prazo_execucao)):a.atividade.tipo_prazo_execucao==SOLICITACAO_TIPO_HORA.DATA_PRDECESSORA?a.chk_predecessora_data.prop("checked",!0).trigger("click"):a.atividade.tipo_prazo_execucao==SOLICITACAO_TIPO_HORA.DATA_REFERENCIA&&(a.chk_data_referencia.prop("checked",!0).trigger("click"),a.edt_data_referencia.val(a.atividade.data_referencia));if(""!=a.atividade.notifica_vencto_horas_antes&&null!=a.atividade.notifica_vencto_horas_antes&&a.atividade.notifica_vencto_horas_antes.length>6){var t;for(i=9-(t=a.atividade.notifica_vencto_horas_antes).length,o=0;o<i;o++)t="0"+t;a.atividade.notifica_vencto_horas_antes=t}a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.INICIO&&a.div_chk_predecessora_data.addClass("hidden"),a.edt_tempo_prazo_execucao.val(a.atividade.tempo_prazo_execucao),a.chk_permite_reprogramar.prop("disabled",!1),a.chk_permite_reprogramar.prop("checked","true"===a.atividade.permite_reprogramar.toString()),a.chk_permite_reprogramar.prop("disabled",e),a.chk_acumular_tempo.prop("disabled",!1),a.chk_acumular_tempo.prop("checked","true"===a.atividade.acumular_tempo.toString()),a.chk_acumular_tempo.prop("disabled",e),a.edt_notifica_vencto_horas_antes.val(a.atividade.notifica_vencto_horas_antes),a.chk_notifica_vencto_solicitante.prop("disabled",!1),a.chk_notifica_vencto_solicitante.prop("checked","true"===a.atividade.notifica_vencto_solicitante.toString()),a.chk_notifica_vencto_solicitante.prop("disabled",e),a.chk_notifica_vencto_responsavel.prop("disabled",!1),a.chk_notifica_vencto_responsavel.prop("checked","true"===a.atividade.notifica_vencto_responsavel.toString()),a.chk_notifica_vencto_responsavel.prop("disabled",e),a.edt_emails_notificacao_vencto.val(a.atividade.emails_notificacao_vencto);var r=!1;null!=a.atividade.executor_responsavel_automatico&&(1!=a.atividade.executor_responsavel_automatico&&"S"!=a.atividade.executor_responsavel_automatico||(r=!0,a.chk_grupo_responsavel_obrigatorio.prop("checked",!1).change(),a.chk_responsavel_obrigatorio.prop("checked",!1).change(),a.chk_solicitante_responsavel_obrigatorio.prop("checked",!1).change(),a.chk_multiplos_responsaveis.prop("checked",!1).change(),a.chk_grupo_responsavel_obrigatorio.prop("disabled",!0),a.chk_solicitante_responsavel_obrigatorio.prop("disabled",!0),a.chk_responsavel_obrigatorio.prop("disabled",!0),a.chk_multiplos_responsaveis.prop("disabled",!0))),r?a.div_select_atividade.removeClass("hidden"):a.div_select_atividade.addClass("hidden"),a.chk_tornar_executor_responsavel.prop("disabled",!1),a.chk_tornar_executor_responsavel.prop("checked",r),a.chk_tornar_executor_responsavel.prop("disabled",e);var s=!1;null!=a.atividade.tornar_superior_imediato_responsavel&&(1!=a.atividade.tornar_superior_imediato_responsavel&&"S"!=a.atividade.tornar_superior_imediato_responsavel||(s=!0)),s?a.div_select_atividade_executor_responsavel.removeClass("hidden"):a.div_select_atividade_executor_responsavel.addClass("hidden"),1!=s&&1!=r&&!0!==a.atividade.responsavel_anonimo||a.responsavel_ativo.addClass("hidden"),a.chk_tornar_superior_imediato_responsavel.prop("disabled",!1),a.chk_tornar_superior_imediato_responsavel.prop("checked",s),a.chk_tornar_superior_imediato_responsavel.prop("disabled",e),a.chk_responsavel_anonimo.prop("disabled",!1),a.chk_responsavel_anonimo.prop("checked",a.atividade.responsavel_anonimo),a.chk_responsavel_anonimo.prop("disabled",e),a.render_fluxo(),a.render_permissoes(),a.chk_acao_projeto_template.prop("disabled",!1),a.chk_acao_projeto_template.prop("checked","true"===a.atividade.acao_projeto_template.toString()),a.chk_acao_projeto_template.prop("disabled",e),"true"===a.atividade.acao_projeto_template.toString()&&a.div_porcentagem.removeClass("hidden"),a.edt_percent_projeto.val(a.atividade.acao_projeto_template_conclusao)},this.render_usuarios_responsaveis=function(){var e=a.tab_usuario_responsavel.find("tbody"),i=e.find("tr:first");$(a.atividade.usuarios_responsaveis).each(function(e,i){void 0===a.atividade.usuarios_responsaveis[e].removido&&(a.atividade.usuarios_responsaveis[e].removido=!1)});var o=a.atividade.usuarios_responsaveis.filter(function(e){var a=!0;return!0===e.removido&&(a=!1),a});o=o.sort(function(e,a){return e.nome.toUpperCase()>a.nome.toUpperCase()}),a.tab_usuario_responsavel.find("tr:gt(1)").remove(),$(o).each(function(o,t){!function(o){var t=i.clone();t.removeAttr("template-row"),t.css("display",""),$(t.find("[template-field='nome']")).text(o.nome),$(t.find("[template-field='email']")).text(o.email);var r=$(t.find("[template-field='chk_altera_responsavel']")),s=$(t.find("[template-field='chk_vincular_responsabilidade']"));$(r).removeClass("template_switch"),"S"==o.altera_responsavel||1==o.altera_responsavel?(r.prop("checked",!0).change(),o.altera_responsavel=!0):(o.altera_responsavel=!1,s.prop("disabled",!0)),r.unbind("change"),r.change(function(){o.altera_responsavel=r.prop("checked"),!0===o.altera_responsavel?(s.prop("disabled",!1),s.prop("checked",!0).change()):(s.prop("checked",!1).change(),s.prop("disabled",!0))}),$(s).removeClass("template_switch"),"S"==o.vincular_responsabilidade||1==o.vincular_responsabilidade?(s.prop("checked",!0).change(),o.vincular_responsabilidade=!0):"N"==o.vincular_responsabilidade&&(o.vincular_responsabilidade=!1),s.unbind("change"),s.change(function(){o.vincular_responsabilidade=s.prop("checked")});var _=$(t.find("[template-field='chk_cancela_solicitacao']"));$(_).removeClass("template_switch"),"S"==o.cancela_solicitacao||1==o.cancela_solicitacao?(_.prop("checked",!0).change(),o.cancela_solicitacao=!0):"N"==o.cancela_solicitacao&&(o.cancela_solicitacao=!1),_.unbind("change"),_.change(function(){o.cancela_solicitacao=_.prop("checked")}),App.aplicar_checkbox(t);var d=$(t.find(".btn_usuario_remover"));d.unbind("click"),d.click(function(){alert_modal(a.title.text(),"Deseja remover o usuário?","Remover",function(){$(a.atividade.usuarios_responsaveis).each(function(e,i){i.usuario_id==o.usuario_id&&(a.atividade.usuarios_responsaveis[e].removido=!0,a.render_usuarios_responsaveis())})},!0)}),$(a.atividade.usuarios_responsaveis).each(function(e,i){i.usuario_id==o.usuario_id&&(a.atividade.usuarios_responsaveis[e]=o)}),t.appendTo(e)}(t)})},this.render_grupos_usuarios_responsaveis=function(){var e=a.tab_grupo_usuarios_responsavel.find("tbody"),i=e.find("tr:first");$(a.atividade.grupos_usuarios_responsaveis).each(function(e,i){void 0===a.atividade.grupos_usuarios_responsaveis[e].removido&&(a.atividade.grupos_usuarios_responsaveis[e].removido=!1)});var o=a.atividade.grupos_usuarios_responsaveis.filter(function(e){var a=!0;return!0===e.removido&&(a=!1),a});o=o.sort(function(e,a){return e.nome.toUpperCase()>a.nome.toUpperCase()}),a.tab_grupo_usuarios_responsavel.find("tr:gt(1)").remove(),$(o).each(function(o,t){!function(o){var t=i.clone();t.removeAttr("template-row"),t.css("display",""),$(t.find("[template-field='nome']")).text(o.nome);var r=$(t.find("[template-field='chk_grupo_altera_responsavel']")),s=$(t.find("[template-field='chk_grupo_vincular_responsabilidade']"));$(r).removeClass("template_switch"),"S"==o.altera_responsavel||1==o.altera_responsavel?o.altera_responsavel=!0:(o.altera_responsavel=!1,s.prop("disabled",!0)),r.prop("checked",o.altera_responsavel),r.unbind("change"),r.change(function(){o.altera_responsavel=r.prop("checked"),!0===o.altera_responsavel?(s.prop("disabled",!1),s.prop("checked",!0).change()):(s.prop("checked",!1).change(),s.prop("disabled",!0))}),$(s).removeClass("template_switch"),"S"==o.vincular_responsabilidade||1==o.vincular_responsabilidade?o.vincular_responsabilidade=!0:"N"!=o.vincular_responsabilidade&&0!=o.vincular_responsabilidade||(o.vincular_responsabilidade=!1),s.prop("checked",o.vincular_responsabilidade),s.unbind("change"),s.change(function(){o.vincular_responsabilidade=s.prop("checked")});var _=$(t.find("[template-field='chk_grupo_cancela_solicitacao']"));$(_).removeClass("template_switch"),"S"==o.cancela_solicitacao||1==o.cancela_solicitacao?o.cancela_solicitacao=!0:"N"!=o.cancela_solicitacao&&0!=o.cancela_solicitacao||(o.cancela_solicitacao=!1),_.prop("checked",o.cancela_solicitacao),_.unbind("change"),_.change(function(){o.cancela_solicitacao=_.prop("checked")}),App.aplicar_checkbox(t);var d=$(t.find(".btn_usuario_remover"));d.unbind("click"),d.click(function(){alert_modal(a.title.text(),"Deseja remover o usuário?","Remover",function(){$(a.atividade.grupos_usuarios_responsaveis).each(function(e,i){i.grupo_usuarios_id==o.grupo_usuarios_id&&(a.atividade.grupos_usuarios_responsaveis[e].removido=!0,a.render_grupos_usuarios_responsaveis())})},!0)}),$(a.atividade.grupos_usuarios_responsaveis).each(function(e,i){i.grupo_usuarios_id==o.grupo_usuarios_id&&(o.usuarios=i.usuarios,a.atividade.grupos_usuarios_responsaveis[e]=o)}),t.appendTo(e)}(t)})};var i=function(e){a.dialog.find(".cbo_fluxo_elemento").prop("disabled",!0);var i=!0;void 0!==e&&e||(e={tipo:null,elemento_tipo:null,id:null,permite_retorno:!1,removido:!1},a.atividade.destinos.push(e),i=!1),void 0===e.elem_key&&(e.elem_key=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random())));var o=a.tab_fluxo.find("tbody"),t=o.find("tr:first").clone();t.removeAttr("template-row"),t.css("display","");var r=$(t.find(".permite_retorno"));$(r).removeClass("template_switch"),App.aplicar_checkbox(t),r.prop("checked",!0===e.permite_retorno).change(),r.unbind("change").change(function(){e.permite_retorno=r.prop("checked")});for(var s=$(t.find("[template-field='elemento']")),_=$("<optGroup/>").attr("label","Atividade"),d=$("<optGroup/>").attr("label","Gateway"),n=0;n<a.processo_ref.elementos.length;n++)if(0==a.processo_ref.elementos[n].removido){for(var c=!1,l=0;l<a.atividade.destinos.length;l++)a.atividade.destinos[l].elem_key!=a.processo_ref.elementos[n].elem_key||a.atividade.destinos[l].removido||(c=!0);i&&(c=!1),!1===c&&(a.processo_ref.elementos[n].elemento_tipo==PROCESSO_ELEMENTO_TIPO.ATIVIDADE&&$('<option elemento_tipo="'+PROCESSO_ELEMENTO_TIPO.ATIVIDADE+'" tipo="'+a.processo_ref.elementos[n].tipo+'" id="'+a.processo_ref.elementos[n].id+'" />').attr("value",a.processo_ref.elementos[n].elem_key).text(a.processo_ref.elementos[n].descricao).appendTo(_),a.processo_ref.elementos[n].elemento_tipo==PROCESSO_ELEMENTO_TIPO.GATEWAY&&$('<option elemento_tipo="'+PROCESSO_ELEMENTO_TIPO.GATEWAY+'" tipo="'+a.processo_ref.elementos[n].tipo+'" id="'+a.processo_ref.elementos[n].id+'" />').attr("value",a.processo_ref.elementos[n].elem_key).text(a.processo_ref.elementos[n].descricao).appendTo(d))}$("<option/>").attr("value","").text(" - Selecionar - ").appendTo(s),_.clone().appendTo(s),d.clone().appendTo(s),s.unbind("change"),s.change(function(){e.elem_key=s.val(),e.elemento_tipo=parseInt(s.find("option:selected").attr("elemento_tipo"),10),e.tipo=parseInt(s.find("option:selected").attr("tipo"),10),e.descricao=s.find("option:selected").text(),e.id=parseInt(s.find("option:selected").attr("id"));var a=e.elemento_tipo==PROCESSO_ELEMENTO_TIPO.ATIVIDADE&&e.tipo!=PROCESSO_ATIVIDADE_TIPO.FIM;a||(r.prop("disabled",!1),r.prop("checked",!1)),r.prop("disabled",!a)}),s.val(e.elem_key).trigger("change"),s.prop("disabled",i);var p=$(t.find(".btn_fluxo_remover"));p.unbind("click"),p.click(function(){alert_modal(a.title.text(),"Deseja remover este elemento do fluxo?","Remover",function(){$(a.atividade.destinos).each(function(i,o){o.elem_key==e.elem_key&&(a.atividade.destinos[i].removido=!0,a.render_fluxo())})},!0)}),t.appendTo(o)};this.render_fluxo=function(){$(a.atividade.destinos).each(function(e,i){void 0===a.atividade.destinos[e].removido&&(a.atividade.destinos[e].removido=!1)});var e=a.atividade.destinos.filter(function(e){var a=!0;return!0===e.removido&&(a=!1),a});e=e.sort(function(e,a){return parseInt(e.elemento_tipo,10)>parseInt(a.elemento_tipo,10)}),a.tab_fluxo.find("tr:gt(1)").remove(),$(e).each(function(e,a){i(a)})};this.render_permissoes=function(){a.tab_permissoes.find("tr:gt(1)").remove(),a.formulario_ref&&(a.lbl_nome_formulario.text(a.formulario_ref.nome),$(a.atividade.permissoes_formulario).each(function(e,i){var o=!1;$(a.formulario_ref.grupos).each(function(e,a){a.id==i.formulario_grupo_id&&(o=!0)}),o||(a.atividade.permissoes_formulario[e].remover=!0)}),a.atividade.permissoes_formulario=a.atividade.permissoes_formulario.filter(function(e){return void 0===e.remover||0==e.remover}),$(a.formulario_ref.grupos).each(function(e,i){var o=!1;$(a.atividade.permissoes_formulario).each(function(e,t){i.id==t.formulario_grupo_id&&(o=!0,a.atividade.permissoes_formulario[e].sequencia=i.sequencia)}),o||a.atividade.permissoes_formulario.push({formulario_grupo_id:i.id,nome:i.nome,sequencia:i.sequencia,permissao:PROCESSO_ATIVIDADE_FORMULARIO_PERMISSAO.NAO_EXIBIR})}),a.atividade.permissoes_formulario=a.atividade.permissoes_formulario.sort(function(e,a){return parseInt(e.sequencia,10)>parseInt(a.sequencia,10)?1:-1}),$(a.atividade.permissoes_formulario).each(function(e,i){!function(e){var i=a.tab_permissoes.find("tbody"),o=i.find("tr:first").clone();o.removeAttr("template-row"),o.css("display",""),$(o.find("[template-field='nome']")).text(e.nome);var t=$(o.find("[template-field='permissao']"));a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.FIM&&t.find('option:contains("Editar")').remove(),t.val(e.permissao),t.unbind("change"),t.change(function(){e.permissao=t.val()}),o.appendTo(i)}(i)}))},this.chk_tipo_hora.unbind("click"),this.chk_tipo_hora.click(function(){a.radios()}),this.chk_acao_projeto_template.unbind("change"),this.chk_acao_projeto_template.change(function(){a.chk_acao_projeto_template.prop("checked")?(a.div_porcentagem.removeClass("hidden"),a.edt_percent_projeto.val(100)):a.div_porcentagem.addClass("hidden")}),a.chk_responsavel_obrigatorio.on("change",function(){a.handleChangeChecks(this)}),a.chk_grupo_responsavel_obrigatorio.on("change",function(){a.handleChangeChecks(this)}),a.chk_solicitante_responsavel_obrigatorio.on("change",function(){a.handleChangeChecks(this)}),a.chk_tornar_executor_responsavel.on("change",function(){a.handleChangeChecks(this),a.chk_tornar_executor_responsavel.prop("checked")?(a.responsavel_ativo.addClass("hidden"),a.div_select_atividade.removeClass("hidden")):(a.responsavel_ativo.removeClass("hidden"),a.div_select_atividade.addClass("hidden"))}),this.handleChangeChecks=function(e){if(e){let i=[a.chk_multiplos_responsaveis,a.chk_responsavel_obrigatorio,a.chk_grupo_responsavel_obrigatorio,a.chk_solicitante_responsavel_obrigatorio,a.chk_tornar_executor_responsavel,a.chk_tornar_superior_imediato_responsavel,a.chk_responsavel_anonimo];if($(e).prop("checked"))for(let a=0;a<i.length;a++){let o=i[a];$(o)[0]!==$(e)[0]&&$(o).prop("checked",!1).trigger("change")}}},a.chk_tornar_superior_imediato_responsavel.on("change",function(){a.handleChangeChecks(this),a.chk_tornar_superior_imediato_responsavel.prop("checked")?(a.div_select_atividade_executor_responsavel.removeClass("hidden"),a.responsavel_ativo.addClass("hidden")):(a.responsavel_ativo.removeClass("hidden"),a.div_select_atividade_executor_responsavel.addClass("hidden"))}),this.chk_multiplos_responsaveis.on("change",function(){a.handleChangeChecks(this)}),this.chk_responsavel_anonimo.on("change",function(){a.handleChangeChecks(this),a.chk_responsavel_anonimo.prop("checked")?a.responsavel_ativo.addClass("hidden"):a.responsavel_ativo.removeClass("hidden")}),this.edt_descricao.unbind("keyup"),this.edt_descricao.keyup(function(){a.lbl_titulo_atividade.text(a.edt_descricao.val())}),this.cbo_tipo.unbind("change"),this.cbo_tipo.change(function(){parseInt(this.value)==PROCESSO_ATIVIDADE_TIPO.FIM?(a.div_instrucao_trabalho.hide(),a.lbl_tab_responsaveis.hide(),a.lbl_tab_gestao_tempo.hide(),a.lbl_tab_fluxo.hide(),a.lbl_tab_acoes.hide(),a.col_notifica_responsavel.hide(),a.div_notificar_email_entrega.hide(),a.div_informar_emails_terceiros.hide(),a.div_enviar_email_senha_responsavel.hide()):(a.div_instrucao_trabalho.show(),a.lbl_tab_responsaveis.show(),a.lbl_tab_gestao_tempo.show(),a.lbl_tab_fluxo.show(),a.lbl_tab_acoes.show(),a.col_notifica_responsavel.show(),a.div_solicitante.show(),a.div_responsavel.show(),a.div_outros_emails.show(),a.permitir_informar_emails_terceiros.show(),a.enviar_anexo_no_email_workflow.show(),a.enviar_formulario_corpo_email_workflow.show(),a.enviar_observacoes_atividade_no_email.show(),a.div_ocultar_solicitacao.show(),a.div_informar_emails_terceiros.show(),a.div_enviar_email_senha_responsavel.show(),parseInt(this.value)==PROCESSO_ATIVIDADE_TIPO.INICIO?(a.col_notifica_responsavel.hide(),a.tab_usuario_atividade.text("Solicitantes"),a.lbl_chk_altera_usuario.text("Altera Solicitante"),a.div_configuracoes.addClass("hidden"),a.div_envio_predecessora.hide(),a.div_observacao_inicio.removeClass("hidden")):parseInt(this.value)==PROCESSO_ATIVIDADE_TIPO.NORMAL&&(a.div_configuracoes.removeClass("hidden"),a.col_notifica_responsavel.show(),a.tab_usuario_atividade.text("Responsáveis"),a.lbl_chk_altera_usuario.text("Altera Responsável"),a.div_envio_predecessora.show(),a.div_observacao_inicio.addClass("hidden")))}),this.btn_add_usuario_responsavel.unbind("click"),this.btn_add_usuario_responsavel.click(function(){View.load("usuario/selecionar",function(e,i){i.show(function(e){e.altera_responsavel=!1,e.vincular_responsabilidade=!1,e.cancela_solicitacao=!1;var i=!1;$(a.atividade.usuarios_responsaveis).each(function(o,t){t.usuario_id==e.usuario_id&&(i=!0,a.atividade.usuarios_responsaveis[o].removido=!1)}),i||a.atividade.usuarios_responsaveis.push(e),a.render_usuarios_responsaveis()})})}),this.btn_add_grupo_usuarios_responsaveis.unbind("click"),this.btn_add_grupo_usuarios_responsaveis.click(function(){View.load("grupo_usuarios/selecionar",function(e,i){i.show(function(e){e.altera_responsavel=!1,e.vincular_responsabilidade=!1,e.cancela_solicitacao=!1;var i=!1;$(a.atividade.grupos_usuarios_responsaveis).each(function(o,t){t.grupo_usuarios_id==e.grupo_usuarios_id&&(i=!0,a.atividade.grupos_usuarios_responsaveis[o].removido=!1)}),i||a.atividade.grupos_usuarios_responsaveis.push(e),a.render_grupos_usuarios_responsaveis()},MODULOS.PROCESSO)})}),this.btn_add_fluxo.unbind("click"),this.btn_add_fluxo.click(function(){var e=!0;$(a.atividade.destinos).each(function(a,i){!(void 0===i.descricao||i.descricao&&""==i.elem_key)||i.removido&&0!=i.removido||(alert_modal("Validação","Existe(m) elemento(s) no fluxo sem atividade ou gateway selecionado(s)"),e=!1)}),0==a.processo_ref.elementos.length&&(e=!1),!0===e&&i()}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){a.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){var e=new Validation;if(void 0===a.atividade.elem_key&&(a.atividade.elem_key=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random()))),a.atividade.descricao=a.edt_descricao.val(),a.atividade.instrucao_trabalho=get_tinymce(a.edt_instrucao_trabalho),a.atividade.tipo=a.cbo_tipo.val(),a.atividade.tipo!=PROCESSO_ATIVIDADE_TIPO.FIM&&(a.chk_horas_uteis.prop("checked")?a.edt_tempo_prazo_execucao.val()||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe as horas úteis.")):a.chk_dias_corridos.prop("checked")?a.edt_dias_corridos.val()||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe os dias corridos.")):a.chk_data_referencia.prop("checked")?a.edt_data_referencia.val()||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a data de referência.")):a.chk_predecessora_data.prop("checked")||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe um prazo de execução."))),""==a.atividade.descricao.trim()&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a descrição da atividade.")),+a.atividade.tipo!==PROCESSO_ATIVIDADE_TIPO.FIM&&""==a.atividade.instrucao_trabalho.trim()&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a instrução de trabalho.")),a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.FIM)$(a.atividade.usuarios_responsaveis).each(function(e,i){a.atividade.usuarios_responsaveis[e].removido=!0}),$(a.atividade.grupos_usuarios_responsaveis).each(function(e,i){a.atividade.grupos_usuarios_responsaveis[e].removido=!0}),a.atividade.responsavel_obrigatorio=!1;else{var i=!1;$(a.atividade.usuarios_responsaveis).each(function(e,o){!1===o.removido&&(o.tipo="usuario"),1!=a.atividade.usuarios_responsaveis[e].removido&&(i=!0)}),$(a.atividade.grupos_usuarios_responsaveis).each(function(e,o){!1===o.removido&&$(o.usuarios).each(function(e,a){a.tipo="grupo_usuarios"}),1!=a.atividade.grupos_usuarios_responsaveis[e].removido&&(i=!0)}),a.chk_solicitante_responsavel_obrigatorio.prop("checked")?(a.atividade.solicitante_responsavel=!0,i=!0):a.atividade.solicitante_responsavel=!1,a.chk_tornar_executor_responsavel.prop("checked")?a.atividade.executor_responsavel_automatico=!0:a.atividade.executor_responsavel_automatico=!1,a.chk_tornar_superior_imediato_responsavel.prop("checked")?a.atividade.tornar_superior_imediato_responsavel=!0:a.atividade.tornar_superior_imediato_responsavel=!1,a.atividade.responsavel_anonimo=a.chk_responsavel_anonimo.prop("checked"),a.atividade.executor_responsavel_automatico=a.chk_tornar_executor_responsavel.prop("checked"),a.atividade.atividade_responsavel_automatico_id=0,a.atividade.atividade_responsavel_automatico_elem_key=null;var o=$(".select_atividade").dxSelectBox("instance").option("value"),t=$(".select_tornar_superior_imediato_responsavel").dxSelectBox("instance").option("value");void 0!==o&&null!=o&&(o.length>11?(a.atividade.atividade_responsavel_automatico_id=0,a.atividade.atividade_responsavel_automatico_elem_key=o):(a.atividade.atividade_responsavel_automatico_id=o>0?o:0,a.atividade.atividade_responsavel_automatico_elem_key=null)),void 0!==t&&null!=t&&(t.length>11?(a.atividade.atividade_superior_imediato_responsavel_id=0,a.atividade.atividade_superior_imediato_responsavel_elem_key=t):(a.atividade.atividade_superior_imediato_responsavel_id=t>0?t:0,a.atividade.atividade_superior_imediato_responsavel_elem_key=null)),(a.atividade.executor_responsavel_automatico||a.atividade.tornar_superior_imediato_responsavel||a.atividade.responsavel_anonimo)&&(i=!0),(a.atividade.executor_responsavel_automatico&&(""==o||null==o||void 0===o)||a.atividade.tornar_superior_imediato_responsavel&&(""==t||null==t||void 0===t))&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Escolha uma atividade")),i||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe ao menos um "+(a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.INICIO?"solicitante":"responsável")+" pela atividade.")),a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.NORMAL?(a.atividade.responsavel_obrigatorio=a.chk_responsavel_obrigatorio.prop("checked"),a.atividade.grupo_usuarios_responsaveis_obrigatorio=a.chk_grupo_responsavel_obrigatorio.prop("checked"),a.atividade.multiplos_responsaveis=a.chk_multiplos_responsaveis.prop("checked")):(a.atividade.responsavel_obrigatorio=!1,a.atividade.grupo_usuarios_responsaveis_obrigatorio=!1,a.atividade.multiplos_responsaveis=!1)}var r,s=(r=a.edt_tempo_prazo_execucao.val().split(":"))[1];r.length,(s>59||a.edt_tempo_prazo_execucao.val().length>0&&6!=a.edt_tempo_prazo_execucao.val().length)&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Prazo para executar" inválido!')),a.edt_tempo_prazo_execucao.val()>"838:59"&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Prazo para executar" deve ser menor que 838:59 horas!')),s=(r=a.edt_notifica_vencto_horas_antes.val().split(":"))[1],r.length,(s>59||a.edt_notifica_vencto_horas_antes.val().length>0&&6!=a.edt_notifica_vencto_horas_antes.val().length)&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Notificar antes do prazo vencer" inválido!')),a.edt_notifica_vencto_horas_antes.val()>"838:59"&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Notificar antes do prazo vencer" deve ser menor que 838:59 horas!')),!0===a.chk_acao_projeto_template.prop("checked")&&(""==a.edt_percent_projeto.val()||a.edt_percent_projeto.val()<1)&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a porcentagem para conclusão do projeto.")),a.atividade.notifica_solicitante=a.chk_notifica_solicitante.prop("checked"),a.atividade.notifica_responsavel=a.chk_notifica_responsavel.prop("checked"),a.atividade.emails_notificacao=a.edt_emails_notificacao.val(),a.atividade.email_terceiros=a.chk_email_terceiros.prop("checked"),a.atividade.email_terceiros_entrega=a.chk_email_terc_entr.prop("checked"),a.atividade.notifica_senha=a.chk_email_usuario_senha_responsavel.prop("checked"),a.atividade.notifica_formulario=a.chk_email_formulario.prop("checked"),a.atividade.envia_anexos=a.chk_email_anexo.prop("checked"),a.atividade.notifica_solicitante_entrega=a.chk_notifica_solicitante_entrega.prop("checked"),a.atividade.notifica_responsavel_entrega=a.chk_notifica_responsavel_entrega.prop("checked"),a.atividade.emails_notificacao_entrega=a.edt_emails_notificacao_entrega.val(),a.atividade.notifica_formulario_entrega=a.chk_email_formulario_entrega.prop("checked"),a.atividade.ocultar_numero_no_inicio=a.chk_ocultar_numero_no_inicio.prop("checked"),a.atividade.ocultar_numero_na_entrega=a.chk_ocultar_numero_na_entrega.prop("checked"),a.atividade.notifica_corpo_formulario=a.chk_email_corpo_formulario.prop("checked"),a.atividade.notifica_corpo_formulario_entrega=a.chk_email_corpo_formulario_entrega.prop("checked"),a.atividade.enviar_obs=a.chk_enviar_obs.prop("checked"),a.atividade.enviar_obs_predecessora=a.chk_enviar_obs_predecessora.prop("checked"),a.atividade.tempo_prazo_execucao=a.edt_tempo_prazo_execucao.val(),a.atividade.permite_reprogramar=a.chk_permite_reprogramar.prop("checked"),a.atividade.acumular_tempo=a.chk_acumular_tempo.prop("checked"),a.atividade.notifica_vencto_horas_antes=a.edt_notifica_vencto_horas_antes.val(),a.atividade.notifica_vencto_solicitante=a.chk_notifica_vencto_solicitante.prop("checked"),a.atividade.notifica_vencto_responsavel=a.chk_notifica_vencto_responsavel.prop("checked"),a.atividade.emails_notificacao_vencto=a.edt_emails_notificacao_vencto.val(),a.atividade.dias_prazo_execucao=a.edt_dias_corridos.val(),a.atividade.data_referencia=a.edt_data_referencia.val(),1==a.chk_data_referencia.prop("checked")&&0==!isNaN(parseInt(a.atividade.data_referencia))&&e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe apenas números para data de referência.")),a.atividade.tipo==PROCESSO_ATIVIDADE_TIPO.FIM?$(a.atividade.destinos).each(function(e,i){a.atividade.destinos[e].removido=!0}):$(a.atividade.destinos).each(function(a,i){!(void 0===i.descricao||i.descricao&&""==i.elem_key)||i.removido&&0!=i.removido||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Existe(m) elemento(s) no fluxo sem atividade ou gateway selecionado(s)."))}),a.atividade.acao_projeto_template=a.chk_acao_projeto_template.prop("checked"),a.atividade.acao_projeto_template_conclusao=a.edt_percent_projeto.val(),e.is_valid()?(void 0!==a.onsave&&a.onsave&&a.onsave(a.atividade,a.elemento_pai),a.unload()):alert_modal("Validação",e)})}});