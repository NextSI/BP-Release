var isMobile=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),define([],function(){var Central_Documentos_Listar=function(html_id){"use strict";var main=this;this.html_id=html_id,this.dialog=$("#"+this.html_id),this.title="Documentos",this.nav_publica=this.dialog.find(".nav_publica"),this.context_menu_arquivo=this.dialog.find(".context_menu_arquivo"),this.context_menu_pasta=this.dialog.find(".context_menu_pasta"),this.lbl_path=this.dialog.find(".lbl_path"),this.lbl_path2=this.dialog.find(".lbl_path2"),this.list_arquivos=this.dialog.find(".list_arquivos"),this.tab_listagem=this.dialog.find(".tab_listagem"),this.dx_listagem_pendencias=this.dialog.find(".dx_listagem_pendencias"),this.td_totalizador=this.tab_listagem.find('tfoot [template-field="totalizador"]'),this.div_configuracoes=this.dialog.find(".div_configuracoes"),this.div_arvore=this.dialog.find(".div_arvore"),this.div_tabelas=this.dialog.find(".div_tabelas"),this.btn_exibir_pastas=this.dialog.find(".btn_exibir_pastas"),this.btn_exibir_ativos=this.dialog.find(".btn_exibir_ativos"),this.btn_refresh=this.dialog.find(".btn_refresh"),this.btn_exibir_bloqueados=this.dialog.find(".btn_exibir_bloqueados"),this.btn_exibir_expirados=this.dialog.find(".btn_exibir_expirados"),this.btn_refresh_tree=this.dialog.find(".btn_refresh_tree"),this.arvore=this.dialog.find("#arvore"),this.totalizador=0,this.btn_ordenacao=this.dialog.find(".orderbypointer"),this.filtros={},this.div_filtro_datas=this.dialog.find(".div_filtro_datas"),this.cbo_tipo_periodo=this.dialog.find(".cbo_tipo_periodo"),this.div_pesquisa=this.dialog.find(".div_pesquisa"),this.div_novos=this.dialog.find(".div_novos"),this.div_edt_nome=this.dialog.find(".div_edt_nome"),this.div_assunto=this.dialog.find(".div_assunto"),this.div_tipo=this.dialog.find(".div_tipo"),this.edt_day_start=this.dialog.find(".edt_day_start"),this.edt_day_end=this.dialog.find(".edt_day_end"),this.edt_pesq_documento=this.dialog.find(".edt_pesq_documento"),this.th_aprovacao=this.dialog.find(".th_aprovacao"),this.th_nome=this.dialog.find(".th_nome"),this.th_assunto=this.dialog.find(".th_assunto"),this.th_tipo=this.dialog.find(".th_tipo"),this.th_versao=this.dialog.find(".th_versao"),this.th_tamanho=this.dialog.find(".th_tamanho"),this.th_data_vigencia=this.dialog.find(".th_data_vigencia"),this.th_modificacao=this.dialog.find(".th_modificacao"),this.th_situacao=this.dialog.find(".th_situacao"),this.th_data_aprovacao=this.dialog.find(".th_data_aprovacao"),this.th_codigo=this.dialog.find(".th_codigo"),this.cbo_assunto=this.dialog.find(".cbo_assunto"),this.cbo_tipo=this.dialog.find(".cbo_tipo"),this.btn_recarregar=this.dialog.find(".btn_recarregar"),this.btn_nova_pasta=this.dialog.find(".btn_nova_pasta"),this.btn_renomear_pasta=this.dialog.find(".btn_renomear_pasta"),this.btn_excluir_pasta=this.dialog.find(".btn_excluir_pasta"),this.btn_novo_documento=this.dialog.find(".btn_novo_documento"),this.btn_novo_documento_caret=this.dialog.find(".btn_novo_documento_caret"),this.btn_recente=this.dialog.find(".btn_recente"),this.btn_publicos=this.dialog.find(".btn_publicos"),this.btn_pendente=this.dialog.find(".btn_pendente"),this.btn_chamado=this.dialog.find(".btn_chamado"),this.btn_processo=this.dialog.find(".btn_processo"),this.btn_sistema=this.dialog.find(".btn_sistema"),this.btn_search=this.dialog.find(".btn_search"),this.btn_pesquisar=this.dialog.find(".btn_pesquisar"),this.btn_pesquisa_documento=this.dialog.find(".btn_pesquisa_documento"),this.btn_colar=this.dialog.find(".btn_colar"),this.btn_recortar=this.dialog.find(".btn_recortar"),this.btn_copiar=this.dialog.find(".btn_copiar"),this.btn_projeto=this.dialog.find(".btn_projeto"),this.btn_limpar_filtros=this.dialog.find(".btn_limpar_filtros"),this.div_refinar_filtro=this.dialog.find(".div_refinar_filtro"),this.floating=this.dialog.find(".floating-menu"),this.collapse_accordion=this.dialog.find("#accordion"),this.aviso_pendentes=this.dialog.find(".aviso_pendentes"),this.btn_envio_multiplo=this.dialog.find(".btn_envio_multiplo"),this.btn_config=this.dialog.find(".btn_config"),this.totalizador_documento=this.dialog.find("[totalizador-documento]"),this.totalizador_pasta=this.dialog.find("[totalizador-pasta]"),this.totalizador_geral=this.dialog.find("[totalizador-geral]"),this.totalizador_aprovacoes=this.dialog.find("[totalizador-aprovacoes]"),this.totalizador_distribuicoes=this.dialog.find("[totalizador-distribuicoes]"),this.chk_refinar_filtro_nome=this.dialog.find(".refinar_filtro_nome"),this.chk_refinar_filtro_tag=this.dialog.find(".refinar_filtro_tag"),this.btn_pasta_atual_xlsx=this.dialog.find(".btn_pasta_atual_xlsx"),this.btn_pasta_atual_subpastas_xlsx=this.dialog.find(".btn_pasta_atual_subpastas_xlsx"),this.btn_pasta_atual_csv=this.dialog.find(".btn_pasta_atual_csv"),this.btn_pasta_atual_subpastas_csv=this.dialog.find(".btn_pasta_atual_subpastas_csv"),this.btn_exportar_excel=this.dialog.find(".btn_exportar_excel"),this.div_carregar_mais=this.dialog.find(".div_carregar_mais"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.container_arvore=this.dialog.find(".container_arvore"),this.divider_escrita=this.dialog.find(".divider_escrita"),this.divider_propriedades=this.dialog.find(".divider_propriedades"),this.divider_link_download=this.dialog.find(".divider_link_download"),this.div_contador_arquivos=this.dialog.find(".div_contador_arquivos"),this.div_contador_aprovacoes=this.dialog.find(".div_contador_aprovacoes"),this.coluna_tag=this.dialog.find(".coluna_tag"),this.coluna_tamanho=this.dialog.find(".coluna_tamanho"),this.coluna_vigente_ate=this.dialog.find(".coluna_vigente_ate"),this.coluna_assunto=this.dialog.find(".coluna_assunto"),this.coluna_tipo=this.dialog.find(".coluna_tipo"),this.documento_pasta_id_anterior=null,this.documento_pasta_id_atual=null,this.documento_pasta_permissoes=null,this.arr_lista=[],this.chamado=!1,this.processo=!1,this.projeto=!1,this.sistema=!1,this.pendente=!1,this.publico=!1,this.data_inicio=null,this.data_inicio_pasta=null,this.data_fim=null,this.data_fim_pasta=null,this.pendencias=[],this.pesquisa=null,this.pesquisa_pasta=null,this.param_pesquisa=!1,this.documento_option=null,this.option_doc=null,this.pasta_option=null,this.option_pasta=null,this.assunto_id=-1,this.assunto_padrao=-1,this.tipo_id=-1,this.tipo_documento_padrao=-1,this.array_id_documento=[],this.documento_pasta_raiz=null,this.refinar_filtro_tag_tipo=GED_REFINAR_FILTRO_TAG.AO_MENOS_UMA_TAG,this.refinar_filtro_nome_tipo=GED_REFINAR_FILTRO_NOME.SEMELHANTE,this.ordenacao={crescente_codigo:!0,crescente_nome:!0,crescente_versao:!0,crescente_tamanho:!0,crescente_assunto:!0,crescente_tipo:!0,crescente_data:!0},this.order_by_nome=null,this.order_by_asc=!0;var botao_interno_selecionado=!1;this.controlador_pastas=0,this.limite=0,this.pode_buscar=!0,this.arr_fila={pastas:[],documentos:[]},this.pastas_nao_encontradas=!1,this.contador_documento=0,this.contador_pastas=0,this.contador_geral=0,this.contador_atual=0,this.incrementar_limite=!1,this.limite_a_cada=50,this.controle_ignore_error=!1,this.ultimo_limite_incrementado=0,this.pode_renderizar_documentos=!1,this.pastas_foram_renderizadas=!1,this.items_restantes=[],this.old_documento_pasta=null,this.selecionados_id={pastas:[],documentos:[]},this.selecionados_nome={pastas:[],documentos:[]},this.selecionados={pastas:[],documentos:[]},this.selecionados_cola={pastas:[],documentos:[]},this.selecionados_cola_nome={pastas:[],documentos:[]},this.option_cola_selecionados=null,this.data_modificacao=!1,this.data_aprovacao=!1,this.situacao_documento=!1,this.exibir_codigo=!0,this.ids_pastas=[],this.exibir_coluna_tag=null,this.exibir_coluna_tamanho=null,this.exibir_coluna_vigente_ate=null,this.exibir_coluna_assunto=null,this.exibir_coluna_tipo=null,this.exibir_bloqueados=!1,this.exibir_expirados=!1,this.exibir_ativos=!0,this.jstree_item=!1,this.jstree_id_last_open=null,this.documento_pasta_id=null,this.clicksign_ativo=null,this.certsign_ativo=null,this.d4sign_ativo=null,this.download_url_dialog=null,this.controller_fila_class=function(){this.pastas=[],this.documentos=[],this.vinculo=null,this.cache_numeracao_pasta=0,this.cache_numeracao_documento=0,this.fila=[],this.item_fila={tipo:null,item:null},this.add=function(){if(arguments.length>0)if(arguments[0]==GED_ELEMENTO_FILA_TIPO.PASTA)if(void 0===arguments[1]||null==arguments[1]||arguments[1]instanceof Array){if(void 0!==arguments[1]&&null!=arguments[1]&&arguments[1]instanceof Array)for(var a=0;a<arguments[1].length;a++)this.pastas.push(arguments[1][a]),this.cache_numeracao_pasta++}else this.pastas.push(arguments[1]),this.cache_numeracao_pasta++;else if(arguments[0]==GED_ELEMENTO_FILA_TIPO.DOCUMENTO)if(void 0===arguments[1]||null==arguments[1]||arguments[1]instanceof Array){if(void 0!==arguments[1]&&null!=arguments[1]&&arguments[1]instanceof Array)for(a=0;a<arguments[1].length;a++)this.documentos.push(arguments[1][a]),this.cache_numeracao_documento++}else this.documentos.push(arguments[1]),this.cache_numeracao_documento++;main.arr_lista.pastas=this.pastas,main.arr_lista.documentos=this.documentos},this.clear=function(){arguments.length>0?arguments[0]==GED_ELEMENTO_FILA_TIPO.PASTA?void 0!==arguments[1]&&null!=arguments[1]&&(this.pastas=[],this.cache_numeracao_pasta=0,this.cache_numeracao_pasta=0):arguments[1]==GED_ELEMENTO_FILA_TIPO.DOCUMENTO&&void 0!==arguments[1]&&null!=arguments[1]&&(this.documentos=[],this.cache_numeracao_documento=0,this.cache_numeracao_documento=0):(this.documentos=[],this.pastas=[],this.cache_numeracao_documento=0,this.cache_numeracao_pasta=0,this.fila=[]),main.arr_lista.pastas=this.pastas,main.arr_lista.documentos=this.documentos},this.remove=function(){if(arguments.length>0){var a=arguments[1];arguments[0]==GED_ELEMENTO_FILA_TIPO.PASTA?void 0!==a&&null!=a&&delete this.pastas[a]:a==GED_ELEMENTO_FILA_TIPO.DOCUMENTO&&void 0!==a&&null!=a&&delete this.documentos[a]}this.pastas.clean(null),this.documentos.clean(null)}},this.Controller_Fila=new this.controller_fila_class,this.documento_bloqueado=!1,this.documento_controle_acessos=!1,this.documento_utilizar_controle_distribuicao=!1,this.documento_tipo="",this.documento_permissao_download=!1,this.documento_permissao_visualizacao=!1,this.show=function(a,i){if(main.div_tabelas.dxScrollView({useNative:!0}).dxScrollView("instance"),main.div_tabelas.css("height","calc(100vh - 136px)"),main.div_arvore.dxScrollView({useNative:!0}).dxScrollView("instance"),main.div_arvore.css("height","calc(100vh - 85px)"),!App.temp.abertura_inicial_ged&&(App.temp.abertura_inicial_ged=!0,App.PE.Listagem_Documentos_Primeiro_Acesso))try{App.PE.Listagem_Documentos_Primeiro_Acesso(main)}catch(a){console.log(a)}if(main.documento_pasta_id=i,main.filtros.aprovador=[App.sessao.dados.usuario_id],main.filtros.situacao=[1],1==App.sessao.dados.admin&&main.div_configuracoes.removeClass("hidden"),$(document).click(function(a){a.ctrlKey||main.tab_listagem.find(".bg-info").removeClass("bg-info").removeAttr("elem_doc")}),App.is_nativo()&&main.btn_envio_multiplo.addClass("hidden"),main.carrega_parametros(),main.collapse_accordion.attr("id","accordion"+main.html_id),main.collapse_accordion.find("[href=#documents-info]").attr("href","#documents-info"+main.html_id).attr("data-parent","#accordion"+main.html_id).attr("aria-controls","documents-info"+main.html_id),main.collapse_accordion.find("#documents-info").attr("id","documents-info"+main.html_id).attr("aria-labelledby","documents-info"+main.html_id),main.collapse_accordion.find("[href=#documents-location]").attr("href","#documents-location"+main.html_id).attr("data-parent","#accordion"+main.html_id).attr("aria-controls","documents-location"+main.html_id),main.collapse_accordion.find("#documents-location").attr("id","documents-location"+main.html_id).attr("aria-labelledby","documents-location"+main.html_id),set_datepicker(main.edt_day_start),set_datepicker(main.edt_day_end),main.publico=a,main.publico?(main.btn_novo_documento.removeClass("disabled"),main.btn_novo_documento_caret.removeClass("disabled"),main.btn_nova_pasta.removeClass("disabled"),main.nav_publica.removeClass("hidden")):(main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.nav_publica.addClass("hidden")),WS.get("documento_pasta/get_id_pasta_raiz/",null,function(a){main.documento_pasta_raiz=a,main.listar_pendencias(!1),void 0!==main.documento_pasta_id&&main.documento_pasta_id?(main.limpar_listar(main.documento_pasta_id),main.arvore.jstree("deselect_all"),main.arvore.jstree("show_all"),main.arvore.jstree("select_node",main.documento_pasta_id),main.documento_pasta_id=null):main.limpar_listar(main.documento_pasta_raiz)}),janelas_ajustaveis(main.div_arvore,main.div_tabelas,6),App.PE.Listagem_Documentos_Customizado)try{App.PE.Listagem_Documentos_Customizado(main)}catch(a){console.log(a)}},this.limpar_tabela=function(a){void 0===a&&(a=!1),main.limite=0,main.totalizador=0,main.td_totalizador.text(main.totalizador)},this.listar_assunto=function(a){main.cbo_assunto.find("option").remove(),add_option(main.cbo_assunto,-1,"Selecione o assunto"),WS.get("assunto/listar/",null,function(i){for(var o=0;o<i.length;o++){var n=i[o];add_option(main.cbo_assunto,n.assunto_id,n.descricao,'sistema="'+n.padrao_sistema+'"')}a&&main.cbo_assunto.val(a).trigger("change"),main.cbo_assunto.selectpicker("refresh")})},this.listar_tipo=function(a){main.cbo_tipo.find("option").remove(),add_option(main.cbo_tipo,-1,"Selecione o tipo de documento"),WS.get("tipo_documento/listar/",null,function(i){for(var o=0;o<i.length;o++){var n=i[o];add_option(main.cbo_tipo,n.tipo_documento_id,n.nome,'sistema="'+n.padrao_sistema+'"')}a&&main.cbo_tipo.val(a).trigger("change"),main.cbo_tipo.selectpicker("refresh")})},this.atualizar_jstree=function(){main.arvore.jstree({contextmenu:{items:{Abrir:{label:"Abrir",icon:"fa fa-folder-open",action:function(a){var i=$(a.reference).jstree(!0).get_node($(a.reference).jstree(!0).get_selected()).original.pasta_id;main.abrir_pasta_arvore(i)}},Propriedades:{label:"Propriedades",icon:"fa fa-edit",action:function(a){var i=$(a.reference).jstree(!0).get_node($(a.reference).jstree(!0).get_selected()).original.pasta_id;View.load("central_documentos/pasta",function(a,o){o.onclose=function(a){void 0===a&&(a=!1),a&&main.arvore.jstree(!0).refresh()},o.show(i,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS)}}}},types:{default:{icon:"fa fa-folder"},"f-open":{icon:"fa fa-folder-open"},"f-closed":{icon:"fa fa-folder"}},plugins:["json_data","contextmenu","sort","types"],core:{check_callback:!0,data:function(a,i){var o=null,n="N";void 0!==main.documento_pasta_id&&main.documento_pasta_id?(o=main.documento_pasta_id,n="S"):o="#"==a.id?null:a.original.pasta_id;WS.get("documento/listar_arvore_pastas/",{documento_pasta_id:o,estrutura_completa:n},function(a){i(a)})},themes:{icons:!0}}})},main.arvore.unbind("hover_node.jstree").on("hover_node.jstree",function(a,i){$("#"+i.node.id).prop("title",i.node.text)}),main.arvore.unbind("open_node.jstree").on("open_node.jstree",function(a,i){main.jstree_item&&i.node.id==main.jstree_item.node.id&&(main.jstree_item=i),i.instance.set_type(i.node,"f-open")}),main.arvore.unbind("close_node.jstree").on("close_node.jstree",function(a,i){main.jstree_item&&i.node.id==main.jstree_item.node.id&&(main.jstree_item=i),i.instance.set_type(i.node,"f-closed")}),main.arvore.unbind("select_node.jstree").on("select_node.jstree",function(a,i){var o=window.event||a,n=o.which||o.button;if(1!=n&&void 0!==n)return!1;main.jstree_item&&(main.jstree_item.node.state.opened||main.jstree_item.instance.set_type(main.jstree_item.node,"f-closed")),i.node.state.opened||(main.jstree_item=i,main.jstree_item.instance.set_type(main.jstree_item.node,"f-open")),main.arvore.jstree("get_selected").toString()!=main.jstree_id_last_open&&main.abrir_pasta_arvore(main.arvore.jstree("get_selected").toString())}),main.arvore.on("loaded.jstree",function(){main.documento_pasta_id&&(main.limpar_listar(main.documento_pasta_id),main.arvore.jstree(!0).refresh(),main.documento_pasta_id=null)}),this.abrir_pasta_arvore=function(a){main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa_pasta=null,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.limpar_listar(a,!0)},this.listar_documentos=function(a,i){void 0!==i&&"boolean"==typeof i||(i=!1),main.pendente=!1,main.th_aprovacao.addClass("hidden"),void 0===a&&(a=null),WS.get({route:"documento/listar/",data:{documento_pasta_id:a,chamado:main.chamado,processo:main.processo,projeto:main.projeto,sistema:main.sistema,data_inicio:main.data_inicio,data_inicio_pasta:main.data_inicio_pasta,data_fim:main.data_fim,data_fim_pasta:main.data_fim_pasta,publico:main.publico,documento_nome:main.pesquisa,assunto_id:main.assunto_id,assunto_padrao:main.assunto_padrao,tipo_id:main.tipo_id,tipo_documento_padrao:main.tipo_documento_padrao,limite:i?main.limite+main.limite_a_cada:main.limite,tipo_periodo:App.temp.documento_tipo_periodo,tipo_periodo_pasta:App.temp.documento_tipo_periodo_pasta,refinar_filtro_tag:main.refinar_filtro_tag,refinar_filtro_nome:main.refinar_filtro_nome,listar_bloqueados:main.exibir_bloqueados,listar_expirados:main.exibir_expirados,listar_ativos:main.exibir_ativos,order_by_nome:main.order_by_nome,order_by_asc:main.order_by_asc},func_response:function(o){main.exibir_coluna_tag?main.coluna_tag.removeClass("hidden"):main.coluna_tag.addClass("hidden"),main.exibir_coluna_tamanho?main.coluna_tamanho.removeClass("hidden"):main.coluna_tamanho.addClass("hidden"),main.exibir_coluna_vigente_ate?main.coluna_vigente_ate.removeClass("hidden"):main.coluna_vigente_ate.addClass("hidden"),main.exibir_coluna_assunto?main.coluna_assunto.removeClass("hidden"):main.coluna_assunto.addClass("hidden"),main.exibir_coluna_tipo?main.coluna_tipo.removeClass("hidden"):main.coluna_tipo.addClass("hidden"),main.div_carregar_mais.removeClass("hidden");var n=main.btn_carregar_mais.find("span.txt_carregar_mais");n.text(App.lang.btn_carregar_mais.carregar_mais_registros),main.btn_carregar_mais.find("span.icn_carregar_mais").remove(),main.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-arrow-down"></span>'),main.documento_pasta_id_anterior=main.documento_pasta_id_atual,main.arr_lista.pasta_atual_predecessoras=o.pasta_atual_predecessoras,main.arr_lista.pasta_atual=o.pasta_atual,main.documento_pasta_id_anterior=void 0!==o.pasta_atual_predecessoras[0]?o.pasta_atual_predecessoras[0].id:null,main.documento_pasta_id_atual=a,main.documento_pasta_permissoes=o.permisssoes,main.render_path(),main.render_path2(),i&&(main.limite=main.limite+main.limite_a_cada),0==o.pastas.length&&0==o.documentos.length&&(main.btn_carregar_mais.find("span.icn_carregar_mais").remove(),main.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-check"></span>'),n.text(App.lang.btn_carregar_mais.todos_carregados)),main.Controller_Fila.clear(),main.Controller_Fila.add(GED_ELEMENTO_FILA_TIPO.PASTA,o.pastas),main.Controller_Fila.add(GED_ELEMENTO_FILA_TIPO.DOCUMENTO,o.documentos),main.contador_geral=100==parseInt(o.totalizador_geral,10)?"99+":parseInt(o.totalizador_geral,10),main.Controller_Fila.pastas.length>0&&main.render_pastas(),main.Controller_Fila.pastas.length<50&&main.Controller_Fila.cache_numeracao_pasta<50&&main.render_documentos(),main.contador_atual=main.contador_pastas+main.contador_documento,main.totalizador_geral.text(main.contador_atual+" de "+main.contador_geral),o.permisssoes.permissao_escrita?(main.btn_novo_documento.removeClass("hidden"),main.btn_novo_documento_caret.removeClass("disabled"),main.btn_nova_pasta.removeClass("hidden")):(main.btn_novo_documento.addClass("hidden"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("hidden"))},disable_buttons:[main.btn_sistema,main.btn_chamado,main.btn_publicos,main.btn_pendente,main.btn_search,main.btn_processo,main.btn_projeto],html_id:main.html_id})},this.listar_pendencias=function(a){if(!a)return!1;var i=new DevExpress.data.DataSource.default({load:function(i){var o=$.Deferred(),n=loadOptionsToActionParams(i);return WS.post({route:"documento/listar_pendencias/",data:n,func_response:function(i){if(!1===a){var n=i.total_aguardando_aprovacao+i.total_aguardando_distribuicao;n>0&&(n>1?main.aviso_pendentes.text(n+" documentos aguardam sua aprovação"):main.aviso_pendentes.text("Um documento aguarda sua aprovação"),main.aviso_pendentes.removeClass("hidden"))}else main.aviso_pendentes.addClass("hidden");main.totalizador_aprovacoes.text(i.total_aguardando_aprovacao),main.totalizador_distribuicoes.text(i.total_aguardando_distribuicao),o.resolve(i)},func_fail:function(a){a.validation&&o.reject(new Error(a.validation.messages.map(function(a){return a.message}).join("<br/>")))},html_id:main.html_id}),o.promise()}});main.dataGridPendencias=dx_Listagem_Padrao({div_html:main.dx_listagem_pendencias,coluna_chave:"id",colunas:dx_Documentos_Pendencias_Colunas(main),toolbar:[],datasource:i,nome:"Aprovação Pendente",nome_parametro_usuario:"listagem_documentos_pendencias",filter_value:[["nome_usuario","=",App.sessao.dados.nome],"and",[["situacao","=","A1"],"or",["situacao","=","D1"],"or",["situacao","=","D2"],"or",["situacao","=","D3"]]],on_row_click:function(a){onDoubleClick(a,function(){View.load("central_documentos/documento",function(i,o){o.show(a.row.data.documento_id,FORMULARIO.EDITAR,a.row.data.documento_pasta_id,!1,null,null,null,null,null)},View.ABA.MULTIPLAS)})},diferenca_altura:117,summary:{groupItems:[{column:"id",summaryType:"count",displayFormat:"{0} registros"}]}}),main.arr_lista=[],main.pendente=!0},this.render_pastas=function(){var a=main.tab_listagem.find("tbody"),i=a.find("tr:first");main.publico&&a.sortable({helper:function(a,i){var o=$("[elem_doc]"),n=$("<div/>").attr("id","draggingContainer");return 0===o.length?(o=$(this),$(i).hide(),$(i).attr("documento_pasta_id")>0?(n.attr("documento_pasta_id",$(i).attr("documento_pasta_id")),n.attr("documento_pasta_nome",$(i).find(".coluna_nome").text()),n.append('<span class="fa fa-folder" style="font-size: 15px;"></span>')):$(i).attr("documento_id")>0&&(n.attr("documento_id",$(i).attr("documento_id")),n.attr("documento_nome",$(i).find(".coluna_nome").text()),n.append('<span class="fa fa-file-text " style="font-size: 15px;"></span>'))):(o.hide(),n.append('<span class="fa fa-file-text " style="font-size: 15px;"></span>')),n.css("cursor","pointer"),n},cursorAt:{left:15,top:15},start:function(a,i){},change:function(a,i){},update:function(a,i){},stop:function(a,i){var o=$("[elem_doc]");0===o.length?$(i).show():o.show()}});main.arr_lista.pastas.length;main.ids_pastas=[],$.each(main.arr_lista.pastas,function(a,o){main.ids_pastas.push(+o.documento_pasta_id),function(a,o){var n=i.clone();n.removeAttr("template-row"),n.css("display",""),n.css("touch-action","manipulation"),n.attr("documento_pasta_id",o.documento_pasta_id).attr("atalho_documento_pasta_id",o.atalho_documento_pasta_id).attr("nome_item"),n.find("*").attr("documento_pasta_id",o.documento_pasta_id).attr("atalho_documento_pasta_id",o.atalho_documento_pasta_id);var t=n.find(".btn_favoritar_item");verifica_favorito("pastas",o.atalho_documento_pasta_id>0?o.atalho_documento_pasta_id:o.documento_pasta_id)&&t.addClass("glyphicon-star").removeClass("glyphicon-star-empty"),t.unbind("click"),t.click(function(a){var i=!1;a.stopPropagation(),$(this).hasClass("glyphicon-star")?($(this).removeClass("glyphicon-star").addClass("glyphicon-star-empty"),i=!1):($(this).addClass("glyphicon-star").removeClass("glyphicon-star-empty"),i=!0),favoritar_item("pastas",o.atalho_documento_pasta_id>0?o.atalho_documento_pasta_id:o.documento_pasta_id,i)}),main.publico&&n.droppable({drop:function(a,i){var o=$(i.helper).attr("documento_id"),n=$(i.helper).attr("documento_nome"),t=$(i.helper).attr("documento_pasta_id"),e=$(i.helper).attr("documento_pasta_nome"),s=$(this).find(".coluna_nome").text();if(main.array_id_documento.length>0)$(main.array_id_documento).each(function(a,i){main.tab_listagem.find('[documento_id="'+i+'"]').remove()}),WS.post("documento/recorte_em_massa",{array_documento_id:JSON.stringify(main.array_id_documento),documento_pasta_id:$(this).attr("documento_pasta_id"),option:"recorte"},function(a){main.array_id_documento=[]});else if(parseInt(o)>0){var d=$(this).attr("documento_pasta_id");alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Aviso !',"Deseja realmente mover o arquivo "+n+" ? <br /><br /><strong>Destino: "+s+"</strong>","Sim",function(){main.tab_listagem.find('[documento_id="'+o+'"]').remove(),WS.post("documento/salvar",{documento_id:o,documento_pasta_id:d,option:"recorte"},function(a){main.listar_pendencias(!1),main.limpar_listar(d)})},!0,"Não",null,function(){})}else parseInt(t)>0&&(d=$(this).attr("documento_pasta_id"),alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Aviso !','<div class="alert alert-info"><small>esta ação pode demorar, pois irá mover todos os documentos contidos nesta pasta.</small></div>Deseja realmente mover a pasta '+e+" ? <br /><br /><strong>Destino: "+s+"</strong>","Sim",function(){main.tab_listagem.find('[documento_pasta_id="'+t+'"]').remove(),WS.post("documento_pasta/salvar",{documento_pasta_id:t,predecessor_id:d,option:"recorte"},function(a){main.listar_pendencias(!1),main.limpar_listar(d)}),main.atualizar_jstree()},!0,"Não",null,function(){}))}}),$(n.find(".ico_pasta")).show();var e=$(n.find(".ico_controle_acessos"));"S"==o.controle_acessos&&e.show();var s=$(n.find(".ico_atalho"));o.atalho_documento_pasta_id>0&&s.show();var d=$(n.find("[template-field='nome']"));d.text(o.nome),d.parent().attr("title",o.nome);var _=$(n.find("[template-field='codigo']"));_.text(o.codigo);var r=$(n.find("[template-field='tag']")),m=$(n.find(".div_tag"));""==o.tags_padrao||null==o.tags_padrao?r.text(""):(r.text(o.tags_padrao),m.tooltip({title:o.tags_padrao,placement:"auto"}),m.tooltip());var l=$(n.find("[template-field='situacao']")),c=$(n.find("[template-field='data_aprovacao']"));1==main.situacao_documento?(main.th_situacao.removeClass("hidden"),l.closest("td").removeClass("hidden")):(main.th_situacao.addClass("hidden"),l.closest("td").addClass("hidden")),1==main.exibir_codigo?(main.th_codigo.removeClass("hidden"),_.closest("td").removeClass("hidden")):(main.th_codigo.addClass("hidden"),_.closest("td").addClass("hidden")),main.exibir_coluna_tamanho?main.th_tamanho.removeClass("hidden"):main.th_tamanho.addClass("hidden"),main.exibir_coluna_vigente_ate?main.th_data_vigencia.removeClass("hidden"):main.th_data_vigencia.addClass("hidden"),main.data_modificacao?main.th_modificacao.removeClass("hidden"):main.th_modificacao.addClass("hidden"),null!=main.arr_lista.pasta_atual?1==main.arr_lista.pasta_atual.aprovacao?1==main.data_aprovacao?(c.closest("td").removeClass("hidden"),main.th_data_aprovacao.removeClass("hidden")):(c.closest("td").addClass("hidden"),main.th_data_aprovacao.addClass("hidden")):1==main.data_aprovacao?(c.closest("td").removeClass("hidden"),main.th_data_aprovacao.removeClass("hidden")):(main.th_data_aprovacao.addClass("hidden"),c.closest("td").addClass("hidden")):main.btn_recente.hasClass("hidden")||(c.closest("td").addClass("hidden"),main.th_data_aprovacao.addClass("hidden"),main.th_situacao.addClass("hidden"),l.addClass("hidden"),l.closest("td").addClass("hidden"),main.th_codigo.addClass("hidden"),_.closest("td").addClass("hidden")),$(n.find("[template-field='versao']")).text("");var p=$(n.find("[template-field='tamanho']"));p.attr("tamanho_original","0"),p.text("");var u=$(n.find("[template-field='data_vigencia']"));1==main.exibir_coluna_vigente_ate?u.removeClass("hidden"):u.addClass("hidden");var h=$(n.find("[template-field='modificacao']"));1==main.data_modificacao?h.removeClass("hidden"):h.addClass("hidden"),$(n.find("[template-field='assunto']")).text(null!=o.assunto_padrao_descricao?o.assunto_padrao_descricao:""),$(n.find("[template-field='tipo_documento']")).text(null!=o.tipo_documento_padrao_nome?o.tipo_documento_padrao_nome:""),h.text(""),h.removeAttr("title"),u.text(""),u.removeAttr("title"),l.text(""),c.text(""),c.removeAttr("title");var v=function(a){main.edt_pesq_documento.val(""),main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.listar_tipo(),main.listar_assunto(),main.limpar_listar(o.atalho_documento_pasta_id>0?o.atalho_documento_pasta_id:o.documento_pasta_id,!0)};0==isMobile?(n.click(function(){if(n.hasClass("bg-primary")){n.removeClass("bg-primary"),n.find("td").removeClass("bg-primary");var a=main.selecionados_id.pastas.indexOf(o.documento_pasta_id);main.selecionados_id.pastas.splice(a,1),main.selecionados_nome.pastas.splice(a,1)}else n.addClass("bg-primary"),n.find("td").addClass("bg-primary"),main.selecionados_id.pastas.push(o.documento_pasta_id),main.selecionados_nome.pastas.push(o.nome+" (Pasta)")}),n.dblclick(v)):n.click(v);n.contextMenu({menuSelector:"#central_documentos_dashboard_context_menu_pasta",menuSelected:function(a,i){main.context_menu_click(a,i)},menuShow:function(a,i){var n=$(a.target).parents("tr.bg-primary");void 0!==n&&n.attr("documento_pasta_id")!=o.documento_pasta_id&&(main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.selecionados_id={documentos:[],pastas:[]},main.selecionados_nome={documentos:[],pastas:[]},$(a.target).trigger("click")),$(i.menuSelector).find(".btn_copiar_pasta_context").parent().addClass("hidden"),$(i.menuSelector).find(".btn_recortar_pasta_context").parent().addClass("hidden"),$(i.menuSelector).find(".btn_colar_pasta_context").parent().addClass("hidden"),$(i.menuSelector).find(".btn_excluir_pasta_context").parent().addClass("hidden"),$(i.menuSelector).find(".btn_nova_pasta").parent().addClass("hidden"),$(i.menuSelector).find(".btn_novo_documento").parent().addClass("hidden"),$(i.menuSelector).find(".btn_abrir").parent().removeClass("hidden"),$(i.menuSelector).find(".btn_propriedades").parent().removeClass("hidden"),main.divider_propriedades.removeClass("hidden"),main.divider_escrita.addClass("hidden"),"S"==o.controle_acessos?((App.sessao.dados.admin||"S"==o.usuario_permissao_visualizacao||"S"==o.grupo_usuarios_permissao_visualizacao)&&$(i.menuSelector).find(".btn_copiar_pasta_context").parent().removeClass("hidden"),(App.sessao.dados.admin||"S"==o.usuario_permissao_escrita||"S"==o.grupo_usuarios_permissao_escrita)&&($(i.menuSelector).find(".btn_colar_pasta_context").parent().removeClass("hidden"),(App.sessao.dados.admin||"S"==o.usuario_permissao_visualizacao||"S"==o.usuario_permissao_visualizacao)&&$(i.menuSelector).find(".btn_recortar_pasta_context").parent().removeClass("hidden")),(App.sessao.dados.admin||"S"==o.usuario_permissao_exclusao||"S"==o.grupo_usuarios_permissao_exclusao)&&$(i.menuSelector).find(".btn_excluir_pasta_context").parent().removeClass("hidden"),main.documento_pasta_permissoes.permissao_escrita&&(main.divider_escrita.removeClass("hidden"),$(i.menuSelector).find(".btn_nova_pasta").parent().removeClass("hidden"),$(i.menuSelector).find(".btn_novo_documento").parent().removeClass("hidden"))):(main.documento_pasta_permissoes.permissao_visualizacao&&$(i.menuSelector).find(".btn_copiar_pasta_context").parent().removeClass("hidden"),main.documento_pasta_permissoes.permissao_escrita&&(main.divider_escrita.removeClass("hidden"),$(i.menuSelector).find(".btn_colar_pasta_context").parent().removeClass("hidden"),$(i.menuSelector).find(".btn_nova_pasta").parent().removeClass("hidden"),$(i.menuSelector).find(".btn_novo_documento").parent().removeClass("hidden"),main.documento_pasta_permissoes.permissao_visualizacao&&$(i.menuSelector).find(".btn_recortar_pasta_context").parent().removeClass("hidden")),main.documento_pasta_permissoes.permissao_exclusao&&$(i.menuSelector).find(".btn_excluir_pasta_context").parent().removeClass("hidden")),main.selecionados_nome.documentos.length+main.selecionados_nome.pastas.length>1&&($(i.menuSelector).find(".btn_abrir").parent().addClass("hidden"),$(i.menuSelector).find(".btn_propriedades").parent().addClass("hidden"),$(i.menuSelector).find(".btn_colar_pasta_context").parent().addClass("hidden"),main.divider_escrita.addClass("hidden"),main.divider_propriedades.addClass("hidden"))}}),n.appendTo(main.tab_listagem)}(0,o),main.contador_pastas+=1,main.totalizador_pasta.text(main.contador_pastas)});for(var o=main.arr_lista.pastas.length;o>-1;o--)main.Controller_Fila.remove(GED_ELEMENTO_FILA_TIPO.PASTA,o)},this.render_documentos=function(){for(var a=main.tab_listagem.find("tbody").find("tr:first"),i=function(i){main.contador_documento+=1,main.totalizador_documento.text(main.contador_documento);var o=a.clone();o.removeAttr("template-row"),o.css("display",""),o.css("touch-action","manipulation"),o.attr("documento_id",i.documento_id).attr("atalho_documento_id",i.atalho_documento_id).attr("documento_revisao_id",i.documento_revisao_id),o.find("*").attr("documento_id",i.documento_id).attr("atalho_documento_id",i.atalho_documento_id).attr("documento_revisao_id",i.documento_revisao_id),$(o.find(".lbl_nome")).text(i.nome),$(o.find(".ico_documento")).show(),$(o.find(".btn_observacoes_img")).show();var n=$(o.find(".ico_controle_acessos"));"S"==i.controle_acessos&&n.show();var t=$(o.find(".ico_atalho"));i.atalho_documento_id>0&&t.show();var e=o.find(".btn_favoritar_item");verifica_favorito("documentos",i.atalho_documento_id>0?i.atalho_documento_id:i.documento_id)&&e.addClass("glyphicon-star").removeClass("glyphicon-star-empty"),e.unbind("click"),e.click(function(a){var o=!1;a.stopPropagation(),$(this).hasClass("glyphicon-star")?($(this).removeClass("glyphicon-star").addClass("glyphicon-star-empty"),o=!1):($(this).addClass("glyphicon-star").removeClass("glyphicon-star-empty"),o=!0),favoritar_item("documentos",i.atalho_documento_id>0?i.atalho_documento_id:i.documento_id,o)});var s=$(o.find("[template-field='nome']"));s.text(i.nome),s.parent().attr("title",i.nome);var d=$(o.find("[template-field='codigo']"));1==main.exibir_codigo?(main.th_codigo.removeClass("hidden"),d.text(i.codigo||""),d.closest("td").removeClass("hidden")):(main.th_codigo.addClass("hidden"),d.closest("td").addClass("hidden"),d.text(""));var _=$(o.find("[template-field='tag']")),r=$(o.find(".div_tag"));null==i.tag_documento||""==i.tag_documento?_.text(""):(_.text(i.tag_documento),r.tooltip({title:i.tag_documento,placement:"auto"}),r.tooltip()),$(o.find("[template-field='versao']")).text(i.versao?i.versao:"");var m=$(o.find("[template-field='tamanho']"));m.attr("tamanho_original",null==i.revisao_tamanho?"0":i.revisao_tamanho),m.text(filesize(parseInt(i.revisao_tamanho,10)||0));var l=$(o.find("[template-field='data_vigencia']"));main.exibir_coluna_vigente_ate?(l.text(i.data_vigencia?i.data_vigencia.format_date():""),l.attr("title",i.data_vigencia?i.data_vigencia.format_date_time():"")):l.addClass("hidden");var c=$(o.find("[template-field='modificacao']"));main.data_modificacao?(c.text(i.revisao_data_envio?i.revisao_data_envio.format_date():""),c.attr("title",i.revisao_data_envio?i.revisao_data_envio.format_date_time():"")):c.addClass("hidden");var p=$(o.find("[template-field='data_aprovacao']")),u=$(o.find("[template-field='situacao']"));"S"!=i.bloqueado?main.situacao_documento?(parseInt(i.ultima_revisao_pendente)?u.html('<span class="label label-warning">Pendente</span>'):"N"==i.aprovacao_ultima_revisao?u.html('<span class="label label-danger">Reprovado</span>'):"S"==i.aprovacao?u.html('<span class="label label-success">Ativo</span>'):0==+i.documento_revisao_id&&u.html('<span class="label label-default">Arquivo não enviado</span>'),main.th_situacao.removeClass("hidden"),u.removeClass("hidden"),u.closest("td").removeClass("hidden"),"S"==i.expirado&&u.append('<br><span class="label label-default">Expirado</span>')):(main.th_situacao.addClass("hidden"),u.addClass("hidden"),u.closest("td").addClass("hidden")):"S"==i.bloqueado&&(u.html('<span class="fa fa-ban"></span>'),o.css("background","#ffdbdb"),o.attr("bloqueado",i.bloqueado)),null!=main.arr_lista.pasta_atual?1==main.arr_lista.pasta_atual.aprovacao?1==main.data_aprovacao?(p.text(i.data_aprovacao?i.data_aprovacao.format_date():""),p.attr("title",i.data_aprovacao?i.data_aprovacao.format_date_time():""),p.removeClass("hidden")):(p.text(""),p.removeAttr("title"),main.th_data_aprovacao.addClass("hidden"),p.closest("td").addClass("hidden")):1==main.data_aprovacao?(p.text(i.data_aprovacao?i.data_aprovacao.format_date():""),p.attr("title",i.data_aprovacao?i.data_aprovacao.format_date_time():""),p.closest("td").removeClass("hidden"),main.th_data_aprovacao.removeClass("hidden")):(p.text(""),p.removeAttr("title"),p.closest("td").addClass("hidden"),main.th_data_aprovacao.addClass("hidden")):(p.closest("td").addClass("hidden"),main.th_data_aprovacao.addClass("hidden"),main.th_situacao.addClass("hidden"),u.addClass("hidden"),u.closest("td").addClass("hidden"),main.th_codigo.addClass("hidden"),d.closest("td").addClass("hidden"));var h=!0;$(o.find(".btn_observacoes")).click(function(){h=!1,View.load("central_documentos/documento",function(a,o){o.onclose=function(a){void 0===a&&(a=!1),h=!0,main.dialog.find(".active").hasClass("btn_pendente")?a&&(main.limpar_limite(),main.listar_pendencias(!0)):a&&(main.listar_pendencias(!1),main.limpar_listar())},o.show(i.documento_id,FORMULARIO.EDITAR,main.arr_lista.pasta_atual,!1,null,null,null,null,null,!0)},View.ABA.MULTIPLAS)}),$(o.find("[template-field='assunto']")).text(i.assunto_descricao?i.assunto_descricao:"");var v=$(o.find(".ico_assunto_controle_acessos"));"S"==i.assunto_controle_acessos&&v.show(),$(o.find("[template-field='tipo_documento']")).text(i.tipo_documento_nome?i.tipo_documento_nome:"");var b=$(o.find(".ico_tipo_documento_controle_acessos"));"S"==i.tipo_documento_controle_acessos&&b.show();var f=function(a){if(a.ctrlKey)return o.children().addClass("bg-info"),o.attr("elem_doc",!0),void main.array_id_documento.push(o.attr("documento_id"));0!=h&&(botao_interno_selecionado?botao_interno_selecionado=!1:View.load("central_documentos/documento",function(a,o){o.onclose=function(a){void 0===a&&(a=!1),main.dialog.find(".active").hasClass("btn_pendente")?a&&main.listar_pendencias(!0):a&&(main.listar_pendencias(!1),main.limpar_listar())},o.show(i.documento_id,FORMULARIO.EDITAR,main.arr_lista.pasta_atual)},View.ABA.MULTIPLAS))};0==isMobile?(o.click(function(){if(o.hasClass("bg-primary")){o.removeClass("bg-primary"),o.find("td").removeClass("bg-primary");var a=main.selecionados_id.documentos.indexOf(i.atalho_documento_id||i.documento_id);main.selecionados_id.documentos.splice(a,1),main.selecionados_nome.documentos.splice(a,1),main.selecionados.documentos.splice(a,1)}else o.addClass("bg-primary"),o.find("td").addClass("bg-primary"),main.selecionados_id.documentos.push(i.atalho_documento_id||i.documento_id),main.selecionados_nome.documentos.push(i.nome+" (Documento)"),main.selecionados.documentos.push(i)}),o.dblclick(f)):o.click(f);o.contextMenu({menuSelector:"#central_documentos_dashboard_context_menu_arquivo",menuSelected:function(a,i){main.context_menu_click(a,i)},menuShow:function(a,o){main.documento_bloqueado=i.bloqueado,main.documento_controle_acessos=i.controle_acessos,main.documento_utilizar_controle_distribuicao=i.utilizar_controle_distribuicao,main.documento_tipo=i.mime_type,main.documento_permissao_download=main.verifica_permissao_ged(i,"download"),main.documento_permissao_visualizacao=main.verifica_permissao_ged(i,"visualizacao");var n=$(a.target).parents("tr.bg-primary");void 0!==n&&n.attr("documento_id")!=i.documento_id&&(main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.selecionados_id={documentos:[],pastas:[]},main.selecionados_nome={documentos:[],pastas:[]},$(a.target).trigger("click"));var t=$(o.menuSelector).find(".btn_copiar_documento_context").parent(),e=$(o.menuSelector).find(".btn_recortar_documento_context").parent(),s=$(o.menuSelector).find(".btn_excluir_documento_context").parent(),d=$(o.menuSelector).find(".btn_bloquear_documento_context").parent(),_=$(o.menuSelector).find(".btn_download_zip").parent(),r=$(o.menuSelector).find(".btn_download").parent(),m=$(o.menuSelector).find(".btn_nova_pasta").parent(),l=$(o.menuSelector).find(".btn_novo_documento").parent(),c=$(o.menuSelector).find(".btn_nova_revisao").parent(),p=$(o.menuSelector).find(".btn_propriedades").parent(),u=$(o.menuSelector).find(".btn_assinaturas_clicksign").parent(),h=$(o.menuSelector).find(".btn_assinaturas_certsign").parent(),v=$(o.menuSelector).find(".btn_assinaturas_d4sign").parent(),b=$(o.menuSelector).find(".btn_visualizar").parent(),f=$(o.menuSelector).find(".btn_gerar_url_download").parent();t.addClass("hidden"),e.addClass("hidden"),s.addClass("hidden"),d.addClass("hidden"),m.addClass("hidden"),l.addClass("hidden"),c.addClass("hidden"),main.divider_escrita.addClass("hidden"),p.removeClass("hidden"),main.divider_propriedades.removeClass("hidden"),r.removeClass("hidden"),u.removeClass("hidden"),h.removeClass("hidden"),v.removeClass("hidden"),b.addClass("hidden"),"S"==i.bloqueado&&main.documento_pasta_permissoes.permissao_escrita&&r.addClass("hidden"),main.verifica_permissao_ged(i,"download")||(r.addClass("hidden"),_.addClass("hidden"),f.addClass("hidden"),main.divider_link_download.addClass("hidden")),"application/pdf"!=i.mime_type&&"image/png"!=i.mime_type&&"image/bmp"!=i.mime_type&&"image/jpeg"!=i.mime_type&&"image/jpg"!=i.mime_type&&"image/gif"!=i.mime_type||main.verifica_permissao_ged(i,"visualizacao")&&b.removeClass("hidden"),u.parent().find(".divider_propriedades_clicksign").addClass("hidden"),main.clicksign_ativo&&extensao_valida(i.revisao_nome,extensoes_validas_assinatura)?(u.children().removeClass("hidden"),u.parent().find(".divider_propriedades_clicksign").removeClass("hidden")):u.children().addClass("hidden"),main.certsign_ativo&&extensao_valida(i.revisao_nome,extensoes_validas_assinatura)?(u.parent().find(".divider_propriedades_clicksign").removeClass("hidden"),h.children().removeClass("hidden")):h.children().addClass("hidden"),main.d4sign_ativo&&extensao_valida(i.revisao_nome,extensoes_validas_assinatura)?(u.parent().find(".divider_propriedades_clicksign").removeClass("hidden"),v.children().removeClass("hidden")):v.children().addClass("hidden"),"S"==i.controle_acessos?((App.sessao.dados.admin||"S"==i.usuario_permissao_seguranca||"S"==i.grupo_usuarios_permissao_seguranca)&&(t.removeClass("hidden"),e.removeClass("hidden"),"S"==i.bloqueado?d.html('<a role="menuitem" tabindex="-1" href="javascript:;" class="btn_bloquear_documento_context" data-context-menu="bloquear"><span class="fa fa-check-square"></span> Desbloquear</a>'):"N"!=i.bloqueado&&""!=i.bloqueado&&void 0!==i.bloqueado||d.html('<a role="menuitem" tabindex="-1" href="javascript:;" class="btn_bloquear_documento_context" data-context-menu="bloquear"><span class="fa fa-ban"></span> Bloquear</a>'),d.removeClass("hidden")),(App.sessao.dados.admin||"S"==i.usuario_permissao_visualizacao||"S"==i.grupo_usuarios_permissao_visualizacao)&&t.removeClass("hidden"),(App.sessao.dados.admin||"S"==i.usuario_permissao_escrita||"S"==i.grupo_usuarios_permissao_escrita)&&(e.removeClass("hidden"),c.removeClass("hidden")),(App.sessao.dados.admin||"S"==i.usuario_permissao_exclusao||"S"==i.grupo_usuarios_permissao_exclusao)&&s.removeClass("hidden"),main.documento_pasta_permissoes.permissao_escrita&&(main.divider_escrita.removeClass("hidden"),m.removeClass("hidden"),l.removeClass("hidden"))):((App.sessao.dados.admin||main.documento_pasta_permissoes.permissao_seguranca)&&("S"==i.bloqueado?d.html('<a role="menuitem" tabindex="-1" href="javascript:;" class="btn_bloquear_documento_context" data-context-menu="bloquear"><span class="fa fa-check-square"></span> Desbloquear</a>'):"N"!=i.bloqueado&&""!=i.bloqueado&&void 0!==i.bloqueado||d.html('<a role="menuitem" tabindex="-1" href="javascript:;" class="btn_bloquear_documento_context" data-context-menu="bloquear"><span class="fa fa-ban"></span> Bloquear</a>'),d.removeClass("hidden")),main.documento_pasta_permissoes.permissao_visualizacao&&t.removeClass("hidden"),main.documento_pasta_permissoes.permissao_escrita&&(main.divider_escrita.removeClass("hidden"),m.removeClass("hidden"),l.removeClass("hidden"),e.removeClass("hidden"),c.removeClass("hidden")),main.documento_pasta_permissoes.permissao_exclusao&&s.removeClass("hidden")),main.selecionados_nome.documentos.length+main.selecionados_nome.pastas.length>1&&(d.addClass("hidden"),c.addClass("hidden"),main.divider_escrita.addClass("hidden"),main.divider_propriedades.addClass("hidden"),p.addClass("hidden"),b.addClass("hidden"),r.addClass("hidden"),u.addClass("hidden"),h.addClass("hidden"),f.addClass("hidden"),main.divider_link_download.addClass("hidden"))}}),o.appendTo(main.tab_listagem)},o=-1,n=0;n<50;n++){if(void 0===main.arr_lista.documentos[n]||null==main.arr_lista.documentos){o=n;break}i(main.arr_lista.documentos[n])}-1==o&&(o=50);main.arr_lista.documentos.splice(0,o)},this.render_path=function(){var a=main.dialog.find("[template-path]");main.lbl_path.find("span").remove();for(var i,o=function(i){var o=a.clone();o.removeAttr("template-path"),o.css("display","");var n=$(o.find(".lbl_pasta"));n.text(i.nome),n.click(function(){main.div_carregar_mais.addClass("hidden"),main.publico=!0,main.limpar_listar(i.id)}),o.appendTo(main.lbl_path)},n=main.arr_lista.pasta_atual_predecessoras.length-1;n>=0;n--)i=main.arr_lista.pasta_atual_predecessoras[n],o(i);main.arr_lista.pasta_atual&&o(main.arr_lista.pasta_atual),main.arr_lista.pasta_atual?1==main.arr_lista.pasta_atual.controle_acessos?(1==main.arr_lista.pasta_atual.usuario_permissao_visualizacao?(main.btn_copiar.show(),main.btn_recortar.show()):(main.btn_copiar.hide(),main.btn_recortar.hide()),1==main.arr_lista.pasta_atual.usuario_permissao_escrita?main.btn_colar.show():main.btn_colar.hide(),1==main.arr_lista.pasta_atual.usuario_permissao_exclusao?main.btn_excluir_pasta.show():main.btn_excluir_pasta.hide()):("N"==main.arr_lista.pasta_atual.raiz?(main.btn_excluir_pasta.show(),main.btn_recortar.show(),main.btn_copiar.show()):(main.btn_excluir_pasta.hide(),main.btn_recortar.hide(),main.btn_copiar.hide(),!0===App.sessao.dados.admin?main.btn_renomear_pasta.show():main.btn_renomear_pasta.hide()),main.btn_colar.show()):(main.btn_renomear_pasta.hide(),main.btn_excluir_pasta.hide(),main.btn_recortar.hide(),main.btn_copiar.hide(),main.btn_colar.hide())},this.render_path2=function(){var a=main.dialog.find("[template-path2]");main.lbl_path2.find("span").remove(),main.list_arquivos.css("display","none");var i,o=function(i){var o=a.clone();o.removeAttr("template-path2"),o.css("display","");var n=$(o.find(".lbl_pasta2"));n.text(i.nome),n.click(function(){main.div_carregar_mais.addClass("hidden"),main.edt_pesq_documento.val(""),main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.edt_day_start.val(""),main.edt_day_end.val(""),main.listar_tipo(),main.listar_assunto(),main.limpar_listar(i.id,!0)}),o.appendTo(main.lbl_path2)};if(void 0!==main.arr_lista.pasta_atual_predecessoras&&null!=main.arr_lista.pasta_atual_predecessoras.length)for(var n=main.arr_lista.pasta_atual_predecessoras.length-1;n>=0;n--)i=main.arr_lista.pasta_atual_predecessoras[n],o(i);main.arr_lista.pasta_atual&&o(main.arr_lista.pasta_atual)},this.btn_exibir_pastas.tooltip({title:"Ocultar Pastas",placement:"auto"}),this.btn_exibir_pastas.click(function(a){main.div_arvore.fadeToggle("fast",function(){$(this).toggleClass("hidden"),main.div_tabelas.hasClass("col-md-12")?(main.div_tabelas.removeClass("col-md-1 col-md-2 col-md-3 col-md-4 col-md-5 col-md-6 col-md-7 col-md-8 col-md-9 col-md-10 col-md-11 col-md-12"),main.div_tabelas.addClass("col-md-9"),main.div_arvore.removeClass("col-md-1 col-md-2 col-md-3 col-md-4 col-md-5 col-md-6 col-md-7 col-md-8 col-md-9 col-md-10 col-md-11 col-md-12"),main.div_arvore.addClass("col-md-3")):(main.div_tabelas.removeClass("col-md-1 col-md-2 col-md-3 col-md-4 col-md-5 col-md-6 col-md-7 col-md-8 col-md-9 col-md-10 col-md-11 col-md-12"),main.div_tabelas.addClass("col-md-12"))}),main.btn_exibir_pastas.tooltip("hide").attr("data-original-title",(main.btn_exibir_pastas.hasClass("btn-info")?"Exibir":"Ocultar")+" pastas").tooltip("fixTitle").tooltip("show"),main.btn_exibir_pastas.toggleClass("btn-info btn-default")}),this.btn_refresh_tree.click(function(a){main.arvore.jstree("refresh")}),this.btn_refresh.click(function(a){main.div_carregar_mais.addClass("hidden"),main.limpar_listar(main.documento_pasta_id_atual),main.carrega_parametros()}),this.btn_exibir_ativos.tooltip({title:"Ocultar Ativos e Pendentes",placement:"auto"}),this.btn_exibir_ativos.click(function(a){main.exibir_ativos=!main.exibir_ativos;var i=main.exibir_ativos?"Exibir":"Ocultar";main.btn_exibir_ativos.tooltip("hide").attr("data-original-title",i+" Ativos e Pendentes").tooltip("fixTitle").tooltip("show"),main.btn_exibir_ativos.toggleClass("btn-info btn-default"),main.btn_exibir_ativos.find(".fa-check").toggleClass("text-info"),main.btn_exibir_ativos.find(".fa-check").hasClass("text-info")?main.btn_exibir_ativos.find(".fa-check").css("color",""):main.btn_exibir_ativos.find(".fa-check").css("color","white"),main.limpar_listar(main.documento_pasta_id_atual)}),this.btn_exibir_bloqueados.tooltip({title:"Exibir Bloqueados",placement:"auto"}),this.btn_exibir_bloqueados.click(function(a){main.exibir_bloqueados=!main.exibir_bloqueados;var i=main.exibir_bloqueados?"Ocultar":"Exibir";main.btn_exibir_bloqueados.tooltip("hide").attr("data-original-title",i+" Bloqueados").tooltip("fixTitle").tooltip("show"),main.btn_exibir_bloqueados.toggleClass("btn-info btn-default"),main.limpar_listar(main.documento_pasta_id_atual)}),this.btn_exibir_expirados.tooltip({title:"Exibir Expirados",placement:"auto"}),this.btn_exibir_expirados.click(function(a){main.exibir_expirados=!main.exibir_expirados;var i=main.exibir_expirados?"Ocultar":"Exibir";main.btn_exibir_expirados.tooltip("hide").attr("data-original-title",i+" Expirados").tooltip("fixTitle").tooltip("show"),main.btn_exibir_expirados.toggleClass("btn-info btn-default"),main.limpar_listar(main.documento_pasta_id_atual)}),this.btn_ordenacao.unbind("click").click(function(a){var i=$(this),o=$(i).attr("data-ordername"),n=$(i).attr("data-asc");if(0===n.length){for(var t=0;t<main.btn_ordenacao.length;t++)if($(main.btn_ordenacao[t])!==$(i)){try{$(main.btn_ordenacao[t]).find(".icon_orderby").removeClass("fa-sort-up fa-sort-down").addClass("hidden fa-sort-down")}catch(a){}$(main.btn_ordenacao[t]).attr("data-asc","")}n=!0,$(i).attr("data-asc",n),$(i).find(".icon_orderby").removeClass("hidden")}else n=!(n="true"==n),$(i).attr("data-asc",n),$(i).find(".icon_orderby").toggleClass("fa-sort-down fa-sort-up");main.func_organizacao(o,n)}),this.func_organizacao=function(a,i){main.filtros.orderby=a,main.filtros.asc=i,main.limpar_tabela(!0)},this.excluir_pasta=function(a){View.load("central_documentos/pasta",function(i,o){o.ondelete=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_atual)},o.show(a,FORMULARIO.EXCLUIR)},View.ABA.MULTIPLAS)},this.context_menu_click=function(a,i){var o,n=a.attr("documento_id")||!1,t=a.attr("atalho_documento_id")||!1,e=a.attr("documento_revisao_id")||!1,s=a.attr("documento_pasta_id")||!1;switch(i){case"abrir":s&&main.limpar_listar(s);break;case"propriedades":n?View.load("central_documentos/documento",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),main.dialog.find(".active").hasClass("btn_pendente")?a&&main.listar_pendencias(!0):a&&(main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual))},i.show(n,FORMULARIO.EDITAR,main.arr_lista.pasta_atual)},View.ABA.MULTIPLAS):s&&View.load("central_documentos/pasta",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_atual)},i.show(s,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS);break;case"download_zip":main.selecionados_id.pastas.length>0||main.selecionados_id.documentos.length>0?(alert_info("Aguarde alguns segundos para que o download seja iniciado. Quanto mais arquivos, mais demorado será para gerar um arquivo ZIP."),WS.get({route:"documento/solicitar_download_zip/",data:{pastas:main.selecionados_id.pastas.join(","),documentos:main.selecionados_id.documentos.join(",")},func_response:function(a){void 0!==a.nome_arquivo_zip&&App.obter_token_publico(function(i){App.download(WS_URI+"documento/download_zip/?nome_arquivo_zip="+a.nome_arquivo_zip+"&token_publico="+i)})}})):alert_modal("Download ZIP","Nenhuma pasta ou documento selecionado.");break;case"download":e?App.obter_token_publico(function(a){App.download(WS_URI+"documento/download/?documento_revisao_id="+e+"&documento_id="+n+"&token_publico="+a)}):alert_modal("Download","Nenhuma versão do documento disponível para download");break;case"nova_revisao":View.load("central_documentos/documento",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),main.dialog.find(".active").hasClass("btn_pendente")?a&&main.listar_pendencias(!0):a&&(main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual))},i.show(n,FORMULARIO.EDITAR,null,!0)},View.ABA.MULTIPLAS);break;case"excluir":if(main.selecionados_id.pastas.indexOf(s)>=0||main.selecionados_id.documentos.indexOf(n)>=0||main.selecionados_id.documentos.indexOf(t)>=0){var d="Tem certeza que deseja mover esses arquivos para a lixeira?<br><br>"+(main.selecionados_nome.pastas.length>0?main.selecionados_nome.pastas.join("<br>")+"<br>":"")+(main.selecionados_nome.documentos.length>0?main.selecionados_nome.documentos.join("<br>"):"");alert_modal("Excluir",d,"Sim",function(){WS.post("documento/gerenciar_selecionados",{pastas:JSON.stringify(main.selecionados_id.pastas),documentos:JSON.stringify(main.selecionados_id.documentos),excluir:!0},function(a){main.limpar_listar(main.documento_pasta_id_atual),alert_saved("Arquivos excluídos com sucesso"),main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[]})},!0,"Não",null,function(){})}else main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[];0==main.selecionados_id.pastas.length&&0==main.selecionados_id.documentos.length&&n?View.load("central_documentos/documento",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),main.dialog.find(".active").hasClass("btn_pendente")?a&&main.listar_pendencias(!0):a&&(main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual))},i.show(n,FORMULARIO.EXCLUIR,main.arr_lista.pasta_atual)},View.ABA.MULTIPLAS):0==main.selecionados_id.pastas.length&&0==main.selecionados_id.documentos.length&&s&&main.excluir_pasta(s);break;case"bloquear":var _="N",r="",m=$(a).closest("tr"),l=m.find("[template-field='nome']").last().text(),c=m.attr("bloqueado")||"";WS.get("documento/situacao_ultima_revisao/",{documento_id:t>0?t:n},function(a){null==a?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Não é possivel bloquear documentos com revisões </strong>pendentes<strong></span></div>'):"N"!=a||main.permitir_bloquear_reprovados?("S"==c?(_="N",r='Tem certeza que deseja desbloquear o arquivo "'+l+'"?'):"N"!=c&&""!=c||(_="S",r='Tem certeza que deseja bloquear o arquivo "'+l+'"?'),alert_modal("Documentos",r,"Sim",function(){"N"==_?WS.post("documento/salva_motivo_bloqueio",{bloqueado:_,documento_id:t>0?t:n},function(a){main.limpar_listar(),alert_saved("Salvo com sucesso")}):View.load("central_documentos/selecao_motivo",function(a,i){i.show(t>0?t:n,_),i.onsave=function(){main.limpar_listar()}})},!0,"Não",null,function(){})):alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Não é possivel bloquear documentos com a ultima revisão </strong>reprovada<strong></span></div>')});break;case"recortar":main.selecionados_id.pastas.indexOf(s)>=0||main.selecionados_id.documentos.indexOf(n)>=0||main.selecionados_id.documentos.indexOf(t)>=0?(main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.selecionados_cola.pastas=main.selecionados_id.pastas,main.selecionados_cola.documentos=main.selecionados_id.documentos,main.selecionados_cola_nome.pastas=main.selecionados_nome.pastas,main.selecionados_cola_nome.documentos=main.selecionados_nome.documentos,main.option_cola_selecionados="recorte"):n?(main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[],main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.pasta_option=0,main.documento_option=n,main.option_doc="recorte",main.old_documento_pasta=main.arr_lista.pasta_atual.id):s&&(main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[],main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.documento_option=0,main.pasta_option=s,main.option_pasta="recorte");break;case"copiar":main.selecionados_id.pastas.indexOf(s)>=0||main.selecionados_id.documentos.indexOf(n)>=0||main.selecionados_id.documentos.indexOf(t)>=0?(main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.selecionados_cola.pastas=main.selecionados_id.pastas,main.selecionados_cola.documentos=main.selecionados_id.documentos,main.selecionados_cola_nome.pastas=main.selecionados_nome.pastas,main.selecionados_cola_nome.documentos=main.selecionados_nome.documentos,main.option_cola_selecionados="copiar"):n?(main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[],main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.pasta_option=0,main.documento_option=n,main.option_doc="copiar",main.old_documento_pasta=main.arr_lista.pasta_atual.id):s&&(main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[],main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[],main.tab_listagem.find("tr.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("td.bg-primary").removeClass("bg-primary"),main.tab_listagem.find("tr.bg-primary").attr("selecionado",!1),main.tab_listagem.find("td.bg-primary").attr("selecionado",!1),main.documento_option=0,main.pasta_option=s,main.option_pasta="copiar");break;case"colar":if(main.selecionados_cola.pastas.length>0||main.selecionados_cola.documentos.length>0){var p="recorte"==main.option_cola_selecionados?"Mover arquivos":"Copiar Arquivos",u="Tem certeza que deseja "+("recorte"==main.option_cola_selecionados?"mover":"copiar")+" esses arquivos?<br><br>"+(main.selecionados_cola_nome.pastas.length>0?main.selecionados_cola_nome.pastas.join("<br>")+"<br>":"")+(main.selecionados_cola_nome.documentos.length>0?main.selecionados_cola_nome.documentos.join("<br>"):"");alert_modal(p,u,"Sim",function(){WS.post("documento/gerenciar_selecionados",{pastas:JSON.stringify(main.selecionados_cola.pastas),documentos:JSON.stringify(main.selecionados_cola.documentos),colar:!0,option:main.option_cola_selecionados,pasta_destino_id:s},function(a){main.limpar_listar(main.documento_pasta_id_atual),alert_saved("Arquivos "+("recorte"==main.option_cola_selecionados?"movidos":"copiados")+" com sucesso"),"recorte"==main.option_cola_selecionados&&(main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[])})},!0,"Não",null,function(){})}else if(main.documento_option>0){var h=function(a){var i={documento_id:main.documento_option,documento_pasta_id:s>0?s:main.documento_pasta_id_atual,option:main.option_doc};void 0!==a&&null!=a&&(i.controle_aprovacao=a),WS.post("documento/salvar",i,function(a){main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual)})};o=!1,main.arr_lista.pasta_atual.aprovacao?o=!0:$(main.arr_lista.pasta_atual_predecessoras).each(function(a,i){i.aprovacao&&(o=!0)}),o&&main.old_documento_pasta==main.arr_lista.pasta_atual.id&&function(){for(var a=!1,i=0;i<main.arr_lista.pasta_atual.usuarios_aprovacao.length;i++)if(main.arr_lista.pasta_atual.usuarios_aprovacao[i].usuario_id==App.sessao.usuario_id){a=!0;break}return a}()&&"copiar"==main.option_doc?alert_modal("Aviso!","<div> <p>A pasta de destino possui controle de aprovação, deseja que as revisões do documento passe por aprovação ?</p> </div>","Sim",function(){h(!1)},!0,"Não",null,function(){h(!0)}):h()}else main.pasta_option>0&&WS.post("documento_pasta/salvar",{documento_pasta_id:main.pasta_option,predecessor_id:s>0?s:main.documento_pasta_id_atual,option:main.option_pasta},function(a){main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual)});break;case"criar_atalho":(n||s)&&View.load("central_documentos/selecionar_pasta",function(a,i){i.show(function(a){if(main.selecionados_id.pastas.indexOf(s)>=0||main.selecionados_id.documentos.indexOf(n)>=0||s||n){var i=main.selecionados_id.pastas.length>0?main.selecionados_id.pastas:[s],o=main.selecionados_id.documentos.length>0?main.selecionados_id.documentos:[n];WS.post("documento/salvar_atalho",{pastas:JSON.stringify(i),documentos:JSON.stringify(o),predecessor_id:a},function(a){main.limpar_listar(main.documento_pasta_id_atual),1==a.atalhos.length?alert_saved('Atalho criado com sucesso em "'+a.predecessor.path+'"'):alert_saved(a.atalhos.length+' atalhos criados com sucesso em "'+a.predecessor.path+'"'),main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[]})}},null)});break;case"assinaturas_clicksign":View.load("clicksign/detalhes",function(a,i){i.show(e,main.selecionados.documentos[0]),i.onclose=onclose},View.ABA.SIM);break;case"assinaturas_certsign":View.load("certsign/detalhes",function(a,i){i.show(e,main.selecionados.documentos[0]),i.onclose=onclose},View.ABA.SIM);break;case"assinaturas_d4sign":View.load("d4sign/detalhes",function(a,i){i.show(e,main.selecionados.documentos[0]),i.onclose=onclose},View.ABA.MULTIPLAS);break;case"visualizar":e?main.documento_permissao_visualizacao?"application/pdf"==main.documento_tipo?View.load("central_documentos/visualizar_pdf",function(a,i){i.show(e,null,n,"S","S",main.documento_bloqueado,main.documento_utilizar_controle_distribuicao,main.documento_permissao_download)}):View.load("central_documentos/visualizar_documento",function(a,i){i.show(e,n,"S","S",main.documento_bloqueado,main.documento_utilizar_controle_distribuicao,main.documento_permissao_download)}):alert_modal("Validação","Você não possui permissão para visualizar o documento."):alert_modal("Validação","A visualização deste documento não está disponível.");break;case"gerar_url_download":var v=function(){WS.post("documento/gerar_url_download/",{documento_id:n},function(a){alert_saved("URL de download do arquivo gerada com sucesso!"),b(a)})},b=function(a){main.download_url_dialog=DevExpress.ui.dialog.custom({title:"Link de download",messageHtml:"Abaixo, o link de download para o documento: <br><br> <a href="+a+" target='_blank'>"+a+"</a> <br><br> <small>* Com esse link, qualquer usuário poderá realizar o download do documento, mesmo que ele não tenha cadastro no Next BP.</small> <br> <small>* Gerar um novo link irá impossibilitar o download do documento pelo link atual.</small>",buttons:[{text:"OK",onClick:function(){main.download_url_dialog&&main.download_url_dialog.hide()}},{text:"Gerar novo link",onClick:function(a){main.download_url_dialog&&main.download_url_dialog.hide(),v()}},{text:"Copiar link",onClick:function(i){copyToClipboard(a)}}]}),main.download_url_dialog.show()};WS.get("documento/verificar_url_download/",{documento_revisao_id:e},function(a){a?b(a):(main.download_url_dialog&&main.download_url_dialog.hide(),v())})}},this.pesquisar_documentos_pastas=function(){main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.pesquisa=main.edt_pesq_documento.val(),main.pesquisa_pasta=main.edt_pesq_documento.val(),App.temp.documento_tipo_periodo?main.cbo_tipo_periodo.val(App.temp.documento_tipo_periodo):(App.temp.documento_tipo_periodo=DOCUMENTO_FILTRO.PERIODO_TODOS,main.cbo_tipo_periodo.val(App.temp.documento_tipo_periodo)),App.temp.documento_tipo_periodo_pasta?main.cbo_tipo_periodo.val(App.temp.documento_tipo_periodo_pasta):(App.temp.documento_tipo_periodo_pasta=DOCUMENTO_FILTRO.PERIODO_TODOS,main.cbo_tipo_periodo.val(App.temp.documento_tipo_periodo_pasta)),main.data_inicio=get_datepicker(main.edt_day_start),main.data_inicio_pasta=get_datepicker(main.edt_day_start),main.data_fim=get_datepicker(main.edt_day_end),main.data_fim_pasta=get_datepicker(main.edt_day_end),main.assunto_id=main.cbo_assunto.val(),main.assunto_padrao=main.cbo_assunto.val(),main.tipo_id=main.cbo_tipo.val(),main.tipo_documento_padrao=main.cbo_tipo.val(),main.refinar_filtro_tag=main.chk_refinar_filtro_tag.filter(":checked").val(),main.refinar_filtro_nome=main.chk_refinar_filtro_nome.filter(":checked").val(),main.listar_pendencias(!1),main.limpar_listar()},this.unload=function(){View.unload(this.html_id)},this.limpa_ordenacao=function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_nome=!1,main.ordenacao.crescente_versao=!1,main.ordenacao.crescente_tamanho=!1,main.ordenacao.crescente_assunto=!1,main.ordenacao.crescente_tipo=!1,main.ordenacao.crescente_data=!1},this.carrega_data=function(){var a=new Date,i=a.getFullYear(),o=("0"+(a.getMonth()+1)).slice(-2),n=new Date(i,o,1),t=new Date(i,o,0),e=i+"-"+o+"-"+("0"+n.getDate()).slice(-2),s=i+"-"+o+"-"+("0"+t.getDate()).slice(-2);setTimeout(function(){set_datepicker(main.edt_day_start,e),set_datepicker(main.edt_day_end,s)},150),main.data_inicio=e,main.data_inicio_pasta=e,main.data_fim=s,main.data_fim_pasta=s},this.btn_pasta_atual_xlsx.click(function(a){alert_modal("Relatório de documentos","<h4>Por favor, aguarde!</h4> <p>O relatório de documentos está sendo gerado. Quanto maior a quantidade de arquivos, maior o tempo que o relatório levará para ser processado.</p> <p>Você pode fechar esta janela a qualquer momento.</p>"),App.obter_token_publico(function(a){App.download(WS_URI+"documento/gera_excel_pasta/?documento_pasta_id="+main.documento_pasta_id_atual+"&subpastas=N&extensao=xlsx&token_publico="+a)})}),this.btn_pasta_atual_subpastas_xlsx.click(function(a){alert_modal("Relatório de documentos","<h4>Por favor, aguarde!</h4> <p>O relatório de documentos está sendo gerado. Quanto maior a quantidade de arquivos, maior o tempo que o relatório levará para ser processado.</p> <p>Você pode fechar esta janela a qualquer momento.</p>"),App.obter_token_publico(function(a){App.download(WS_URI+"documento/gera_excel_pasta/?documento_pasta_id="+main.documento_pasta_id_atual+"&subpastas=S&extensao=xlsx&token_publico="+a)})}),this.btn_pasta_atual_csv.click(function(a){alert_modal("Relatório de documentos","<h4>Por favor, aguarde!</h4> <p>O relatório de documentos está sendo gerado. Quanto maior a quantidade de arquivos, maior o tempo que o relatório levará para ser processado.</p> <p>Você pode fechar esta janela a qualquer momento.</p>"),App.obter_token_publico(function(a){App.download(WS_URI+"documento/gera_excel_pasta/?documento_pasta_id="+main.documento_pasta_id_atual+"&subpastas=N&extensao=csv&token_publico="+a)})}),this.btn_pasta_atual_subpastas_csv.click(function(a){alert_modal("Relatório de documentos","<h4>Por favor, aguarde!</h4> <p>O relatório de documentos está sendo gerado. Quanto maior a quantidade de arquivos, maior o tempo que o relatório levará para ser processado.</p> <p>Você pode fechar esta janela a qualquer momento.</p>"),App.obter_token_publico(function(a){App.download(WS_URI+"documento/gera_excel_pasta/?documento_pasta_id="+main.documento_pasta_id_atual+"&subpastas=S&extensao=csv&token_publico="+a)})}),this.btn_recortar.unbind("click"),this.btn_recortar.click(function(){main.documento_option=0,main.pasta_option=main.documento_pasta_id_atual,main.option_pasta="recorte"}),this.btn_copiar.unbind("click"),this.btn_copiar.click(function(){main.documento_option=0,main.pasta_option=main.documento_pasta_id_atual,main.option_pasta="copiar"}),this.btn_colar.unbind("click"),this.btn_colar.click(function(){if(main.selecionados_cola.pastas.length>0||main.selecionados_cola.documentos.length>0){var a="recorte"==main.option_cola_selecionados?"Mover arquivos":"Copiar Arquivos",i="Tem certeza que deseja "+("recorte"==main.option_cola_selecionados?"mover":"copiar")+" esses arquivos?<br><br>"+(main.selecionados_cola_nome.pastas.length>0?main.selecionados_cola_nome.pastas.join("<br>")+"<br>":"")+(main.selecionados_cola_nome.documentos.length>0?main.selecionados_cola_nome.documentos.join("<br>"):"");alert_modal(a,i,"Sim",function(){WS.post("documento/gerenciar_selecionados",{pastas:JSON.stringify(main.selecionados_cola.pastas),documentos:JSON.stringify(main.selecionados_cola.documentos),colar:!0,option:main.option_cola_selecionados,pasta_destino_id:main.documento_pasta_id_atual},function(a){main.limpar_listar(main.documento_pasta_id_atual),alert_saved("Arquivos "+("recorte"==main.option_cola_selecionados?"movidos":"copiados")+" com sucesso"),"recorte"==main.option_cola_selecionados&&(main.selecionados_cola.pastas=[],main.selecionados_cola.documentos=[],main.selecionados_cola_nome.pastas=[],main.selecionados_cola_nome.documentos=[])})},!0,"Não",null,function(){})}else if(main.documento_option>0){var o=function(a){var i={documento_id:main.documento_option,documento_pasta_id:main.documento_pasta_id_atual,option:main.option_doc};void 0!==a&&null!=a&&(i.controle_aprovacao=a),WS.post("documento/salvar",i,function(a){var i="recorte"==main.option_doc?"movido":"copiado";"recorte"==main.option_doc&&(main.option_doc=null,main.documento_option=0),alert_saved("Documento "+i+" com sucesso"),main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual)})};n=!1,void 0!==main.arr_lista.pasta_atual&&""!=main.arr_lista.pasta_atual&&void 0!==main.arr_lista.pasta_atual.aprovacao&&null!=main.arr_lista.pasta_atual.aprovacao&&main.arr_lista.pasta_atual.aprovacao?n=!0:$(main.arr_lista.pasta_atual_predecessoras).each(function(a,i){void 0!==i.aprovacao&&null!=i.aprovacao&&i.aprovacao&&(n=!0)}),n&&main.old_documento_pasta==main.arr_lista.pasta_atual.id&&"copiar"==main.option_doc?alert_modal("Aviso!","<div> <p>A pasta de destino possui controle de aprovação, deseja que as revisões do documento passe por aprovação ?</p> </div>","Sim",function(){o(!1)},!0,"Não",null,function(){o(!0)}):o()}else main.pasta_option>0&&WS.post("documento_pasta/salvar",{documento_pasta_id:main.pasta_option,predecessor_id:main.documento_pasta_id_atual,option:main.option_pasta},function(a){var i="recorte"==main.option_pasta?"movida":"copiada";"recorte"==main.option_pasta&&(main.option_pasta=null,main.pasta_option=0),alert_saved("Pasta "+i+" com sucesso"),main.listar_pendencias(!1),main.limpar_listar(main.documento_pasta_id_atual)});var n}),this.btn_recarregar.unbind("click"),this.btn_recarregar.click(function(){main.div_carregar_mais.addClass("hidden"),main.limpar_listar(main.documento_pasta_id_atual)}),this.btn_nova_pasta.unbind("click"),this.btn_nova_pasta.click(function(){main.btn_nova_pasta.hasClass("disabled")||View.load("central_documentos/pasta",function(a,i){i.pasta_notificacao=null!=main.arr_lista.pasta_atual&&void 0!==main.arr_lista.pasta_atual.notificar_por_email&&null!=main.arr_lista.pasta_atual.notificar_por_email&&main.arr_lista.pasta_atual.notificar_por_email||!1,i.onclose=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_atual)},i.show(null,FORMULARIO.NOVO,main.arr_lista.pasta_atual)},View.ABA.MULTIPLAS)}),this.btn_renomear_pasta.unbind("click"),this.btn_renomear_pasta.click(function(){View.load("central_documentos/pasta",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_atual)},i.show(main.documento_pasta_id_atual,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS)}),this.btn_excluir_pasta.unbind("click"),this.btn_excluir_pasta.click(function(){View.load("central_documentos/pasta",function(a,i){i.ondelete=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_anterior)},i.show(main.documento_pasta_id_atual,FORMULARIO.EXCLUIR)},View.ABA.MULTIPLAS)}),this.btn_novo_documento.unbind("click"),this.btn_novo_documento.click(function(){if(null==main.arr_lista.pasta_atual)return!1;main.btn_novo_documento.hasClass("disabled")||View.load("central_documentos/documento",function(a,i){i.pasta_notificacao=(void 0!==main.arr_lista.pasta_atual&&null!=main.arr_lista.pasta_atual?main.arr_lista.pasta_atual.notificar_por_email:"N")||"N",i.onclose=function(a){void 0===a&&(a=!1),a&&main.limpar_listar(main.documento_pasta_id_atual)},i.show(null,FORMULARIO.NOVO,main.documento_pasta_id_atual,null,null,null,null,null,null,null,null,null,main.arr_lista.pasta_atual.codigo)},View.ABA.MULTIPLAS)}),this.th_nome.unbind("click"),this.th_nome.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_nome?(main.ordenacao.crescente_nome=!1,main.th_nome.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_nome=!0,main.th_nome.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="nome",main.order_by_asc=main.ordenacao.crescente_nome,main.limpar_listar()}),this.th_codigo.unbind("click"),this.th_codigo.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_codigo?(main.ordenacao.crescente_codigo=!1,main.th_codigo.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_codigo=!0,main.th_codigo.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="codigo",main.order_by_asc=main.ordenacao.crescente_codigo,main.limpar_listar()}),this.th_versao.unbind("click"),this.th_versao.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_versao?(main.ordenacao.crescente_versao=!1,main.th_versao.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_versao=!0,main.th_versao.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="versao",main.order_by_asc=main.ordenacao.crescente_versao,main.limpar_listar()}),this.th_tamanho.unbind("click"),this.th_tamanho.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_tamanho?(main.ordenacao.crescente_tamanho=!1,main.th_tamanho.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_tamanho=!0,main.th_tamanho.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="tamanho",main.order_by_asc=main.ordenacao.crescente_tamanho,main.limpar_listar()}),this.th_tipo.unbind("click"),this.th_tipo.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_tipo?(main.ordenacao.crescente_tipo=!1,main.th_tipo.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_tipo=!0,main.th_tipo.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="tipo_documento",main.order_by_asc=main.ordenacao.crescente_tipo,main.limpar_listar()}),this.th_assunto.unbind("click"),this.th_assunto.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_assunto?(main.ordenacao.crescente_assunto=!1,main.th_assunto.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_assunto=!0,main.th_assunto.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="assunto",main.order_by_asc=main.ordenacao.crescente_assunto,main.limpar_listar()}),this.th_modificacao.unbind("click"),this.th_modificacao.click(function(){main.tab_listagem.find("th").find("span").remove(),main.ordenacao.crescente_data?(main.ordenacao.crescente_data=!1,main.th_modificacao.append('  <span class="glyphicon glyphicon-arrow-up"></span>')):(main.ordenacao.crescente_data=!0,main.th_modificacao.append('  <span class="glyphicon glyphicon-arrow-down"></span>')),main.order_by_nome="modificacao",main.order_by_asc=main.ordenacao.crescente_data,main.limpar_listar()}),this.cbo_assunto.unbind("change"),this.cbo_assunto.change(function(){main.div_carregar_mais.addClass("hidden"),main.cbo_assunto.val()>0?(main.param_pesquisa=!1,main.assunto_id=main.cbo_assunto.val(),main.assunto_padrao=main.cbo_assunto.val()):(main.assunto_id=-1,main.assunto_padrao=-1,main.param_pesquisa=!0)}),this.cbo_tipo.unbind("change"),this.cbo_tipo.change(function(){main.div_carregar_mais.addClass("hidden"),main.cbo_tipo.val()>0?(main.param_pesquisa=!1,main.tipo_id=main.cbo_tipo.val(),main.tipo_documento_padrao=main.cbo_tipo.val()):(main.tipo_id=-1,main.tipo_documento_padrao=-1,main.param_pesquisa=!0)}),this.btn_sistema.unbind("click"),this.btn_sistema.click(function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_sistema.addClass("active"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.processo=!1,main.chamado=!1,main.projeto=!1,main.sistema=!0,main.publico=!1,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.limpa_ordenacao(),main.listar_pendencias(!1),main.documento_pasta_id_atual=null,main.limpar_listar()}),this.btn_chamado.unbind("click"),this.btn_chamado.click(function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_chamado.addClass("active"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.chamado=!0,main.processo=!1,main.projeto=!1,main.sistema=!1,main.publico=!1,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.limpa_ordenacao(),main.listar_pendencias(!1),main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.documento_pasta_id_atual=null,main.limpar_listar()}),this.btn_projeto.unbind("click"),this.btn_projeto.click(function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_projeto.addClass("active"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.projeto=!0,main.chamado=!1,main.processo=!1,main.sistema=!1,main.publico=!1,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.limpa_ordenacao(),main.listar_pendencias(!1),main.documento_pasta_id_atual=null,main.limpar_listar()}),this.btn_processo.unbind("click"),this.btn_processo.click(function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_processo.addClass("active"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.chamado=!1,main.processo=!0,main.projeto=!1,main.sistema=!1,main.publico=!1,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.limpa_ordenacao(),main.listar_pendencias(!1),main.documento_pasta_id_atual=null,main.limpar_listar()}),this.btn_publicos.unbind("click"),this.btn_publicos.click(function(){main.div_carregar_mais.addClass("hidden"),main.btn_novo_documento.removeClass("disabled"),main.btn_novo_documento_caret.removeClass("disabled"),main.btn_nova_pasta.removeClass("disabled"),main.btn_envio_multiplo.removeClass("disabled"),main.dx_listagem_pendencias.addClass("hidden"),main.tab_listagem.removeClass("hidden"),main.nav_publica.removeClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_publicos.addClass("active"),main.btn_exportar_excel.removeClass("hidden"),main.btn_refresh.removeClass("hidden"),main.chamado=!1,main.processo=!1,main.projeto=!1,main.sistema=!1,main.publico=!0,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.div_arvore.removeClass("hidden"),main.div_tabelas.addClass("col-md-8 col-lg-9").removeClass("col-md-12 col-lg-12"),main.btn_exibir_pastas.removeClass("hidden"),main.btn_novo_documento.removeClass("hidden"),main.btn_novo_documento_caret.removeClass("hidden"),main.btn_nova_pasta.removeClass("hidden"),main.div_contador_aprovacoes.addClass("hidden"),main.div_contador_arquivos.removeClass("hidden"),main.btn_exibir_bloqueados.removeClass("hidden"),main.btn_exibir_ativos.removeClass("hidden"),main.btn_exibir_expirados.removeClass("hidden"),main.limpa_ordenacao(),main.limpar_limite(),main.limpa_ordenacao(),main.listar_pendencias(!1),main.jstree_id_last_open=null,main.arvore.jstree("refresh"),main.filtros.aprovador=[App.sessao.usuario_id],main.limpar_tabela(!0)}),this.cbo_tipo_periodo.unbind("change"),this.cbo_tipo_periodo.change(function(){App.temp.documento_tipo_periodo=main.cbo_tipo_periodo.val(),App.temp.documento_tipo_periodo_pasta=main.cbo_tipo_periodo.val()}),this.btn_pesquisar.unbind("click"),this.btn_pesquisar.click(function(){main.div_carregar_mais.addClass("hidden"),main.btn_exportar_excel.addClass("hidden"),main.dx_listagem_pendencias.addClass("hidden"),main.tab_listagem.removeClass("hidden"),main.btn_refresh.removeClass("hidden"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.div_pesquisa.removeClass("hidden"),main.nav_publica.addClass("hidden"),main.div_filtro_datas.removeClass("hidden"),main.div_tipo.removeClass("hidden"),main.div_assunto.removeClass("hidden"),main.div_edt_nome.removeClass("hidden"),main.div_refinar_filtro.removeClass("hidden"),main.btn_exportar_excel.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_pesquisar.addClass("active"),main.edt_pesq_documento.attr("placeholder","Digite para pesquisar"),main.edt_pesq_documento.val(""),main.chamado=!1,main.processo=!1,main.projeto=!1,main.sistema=!1,main.publico=!0,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.param_pesquisa=!0,main.cbo_tipo_periodo.selectpicker("refresh"),main.edt_day_start.val(""),main.edt_day_end.val(""),main.limpar_limite(),main.listar_tipo(),main.listar_assunto(),main.limpa_ordenacao(),main.render_path2(),main.div_arvore.removeClass("hidden"),main.div_tabelas.removeClass("col-md-12 col-lg-12").addClass("col-md-8 col-lg-9"),main.btn_exibir_pastas.addClass("hidden"),main.btn_novo_documento.addClass("hidden"),main.btn_novo_documento_caret.addClass("hidden"),main.btn_nova_pasta.addClass("hidden"),main.div_contador_aprovacoes.addClass("hidden"),main.div_contador_arquivos.removeClass("hidden"),main.btn_exibir_bloqueados.removeClass("hidden"),main.btn_exibir_ativos.removeClass("hidden"),main.btn_exibir_expirados.removeClass("hidden"),main.jstree_id_last_open=null,main.arvore.jstree("refresh"),main.filtros.aprovador=[App.sessao.usuario_id],main.limpar_tabela(!0)}),this.btn_limpar_filtros.unbind("click"),this.btn_limpar_filtros.click(function(){main.div_carregar_mais.addClass("hidden"),main.edt_pesq_documento.attr("placeholder","Digite para pesquisar"),main.edt_pesq_documento.val(""),main.chamado=!1,main.processo=!1,main.projeto=!1,main.sistema=!1,main.publico=!0,main.data_inicio=null,main.data_inicio_pasta=null,main.data_fim=null,main.data_fim_pasta=null,main.pesquisa=null,main.pesquisa_pasta=null,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.param_pesquisa=!0,main.edt_day_start.val(""),main.edt_day_end.val(""),main.documento_pasta_id_atual=null,main.render_path2(),main.lbl_path2.text(""),main.limpar_limite(),main.listar_tipo(),main.listar_assunto(),main.limpa_ordenacao(),main.arvore.jstree("refresh")}),this.btn_pesquisa_documento.unbind("click"),this.btn_pesquisa_documento.click(function(){main.div_carregar_mais.addClass("hidden"),main.param_pesquisa=!1,main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.pesquisar_documentos_pastas(),main.div_arvore.addClass("hidden"),main.div_tabelas.removeClass("col-md-8 col-lg-9").addClass("col-md-12 col-lg-12")}),this.edt_pesq_documento.keypress(function(a){13==a.keyCode&&(main.div_carregar_mais.addClass("hidden"),main.pesquisar_documentos_pastas())}),this.btn_recente.unbind("click"),this.btn_recente.click(function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.div_pesquisa.removeClass("hidden"),main.div_filtro_datas.removeClass("hidden"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.div_tipo.addClass("hidden"),main.div_assunto.addClass("hidden"),main.div_edt_nome.addClass("hidden"),main.div_refinar_filtro.addClass("hidden"),main.dx_listagem_pendencias.addClass("hidden"),main.tab_listagem.removeClass("hidden"),main.btn_exportar_excel.addClass("hidden"),main.btn_refresh.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_recente.addClass("active"),main.chamado=!1,main.processo=!1,main.projeto=!1,main.sistema=!1,main.publico=!1,main.pesquisa=null,main.pesquisa_pasta=null,main.param_pesquisa=!1,main.assunto_id=-1,main.assunto_padrao=-1,main.tipo_id=-1,main.tipo_documento_padrao=-1,main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.div_arvore.addClass("hidden"),main.div_tabelas.removeClass("col-md-8 col-lg-9").addClass("col-md-12 col-lg-12"),main.btn_exibir_pastas.addClass("hidden"),main.btn_novo_documento.addClass("hidden"),main.btn_novo_documento_caret.addClass("hidden"),main.btn_nova_pasta.addClass("hidden"),main.div_contador_aprovacoes.addClass("hidden"),main.div_contador_arquivos.removeClass("hidden"),main.btn_exibir_bloqueados.addClass("hidden"),main.btn_exibir_ativos.addClass("hidden"),main.btn_exibir_expirados.addClass("hidden"),main.carrega_data(),main.limpa_ordenacao(),main.listar_pendencias(!1),main.documento_pasta_id_atual=null,main.limpar_listar(),main.filtros.aprovador=[App.sessao.usuario_id],main.limpar_tabela(!0)}),this.btn_search.unbind("click"),this.btn_search.click(function(){main.div_carregar_mais.addClass("hidden"),main.pesquisar_documentos_pastas()}),this.btn_pendente_func=function(){main.div_carregar_mais.addClass("hidden"),main.nav_publica.addClass("hidden"),main.aviso_pendentes.addClass("hidden"),main.div_filtro_datas.addClass("hidden"),main.div_pesquisa.addClass("hidden"),main.tab_listagem.addClass("hidden"),main.dx_listagem_pendencias.removeClass("hidden"),main.btn_refresh.addClass("hidden"),main.btn_novo_documento.addClass("disabled"),main.btn_novo_documento_caret.addClass("disabled"),main.btn_nova_pasta.addClass("disabled"),main.btn_envio_multiplo.addClass("disabled"),main.btn_exportar_excel.addClass("hidden"),main.dialog.find(".active").removeClass("active"),main.btn_pendente.addClass("active"),main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.div_contador_aprovacoes.removeClass("hidden"),main.div_contador_arquivos.addClass("hidden"),WS.abort_request(main.html_id,"documento/listar/",!1),main.limpa_ordenacao(),main.limpar_limite(),main.limpar_tabela(!0),main.listar_pendencias(!0),main.div_arvore.addClass("hidden"),main.div_tabelas.removeClass("col-md-8 col-lg-9").addClass("col-md-12 col-lg-12"),main.btn_exibir_pastas.addClass("hidden"),main.btn_exibir_bloqueados.addClass("hidden"),main.btn_exibir_ativos.addClass("hidden"),main.btn_exibir_expirados.addClass("hidden"),main.btn_novo_documento.addClass("hidden"),main.btn_novo_documento_caret.addClass("hidden"),main.btn_nova_pasta.addClass("hidden")},this.btn_pendente.unbind("click"),this.btn_pendente.click(function(){main.btn_pendente_func()}),this.btn_envio_multiplo.unbind("click"),this.btn_envio_multiplo.click(function(){main.btn_envio_multiplo.hasClass("disabled")||View.load("upload/envio_multiplo",function(a,i){i.onclose=function(){main.limpar_listar(main.documento_pasta_id_atual,!0)},i.show(main.documento_pasta_id_atual)},View.ABA.SIM)}),this.btn_config.unbind("click"),this.btn_config.click(function(a){View.load("central_documentos/configuracoes",function(a,i){i.onclose=function(a){void 0===a&&(a=!1),a&&(main.carrega_parametros(),main.limpar_listar())},i.show()},View.ABA.NAO)}),$(window).resize(function(){janelas_ajustaveis(main.div_arvore,main.div_tabelas,6)}),this.carrega_parametros=function(){WS.get("documento/get_parametros/",null,function(a){main.data_modificacao="N"!=a.documentos_data_modificacao,main.data_aprovacao="N"!=a.documentos_data_aprovacao,main.situacao_documento="N"!=a.documentos_situacao_documento,main.permitir_nomes_iguais="N"!=a.documentos_permitir_nomes_iguais,main.permitir_revisao_duplicada="N"!=a.documentos_permitir_revisao_duplicada,main.permitir_exclusao="N"!=a.documentos_permitir_exclusao,main.exibir_codigo="N"!=a.documentos_codigo_documento_listagem,main.exibir_coluna_tag="N"!=a.documentos_exibir_coluna_tag,main.exibir_coluna_tamanho="N"!=a.documentos_exibir_coluna_tamanho,main.exibir_coluna_vigente_ate="N"!=a.documentos_exibir_coluna_vigente_ate,main.exibir_coluna_assunto="N"!=a.documentos_exibir_coluna_assunto,main.exibir_coluna_tipo="N"!=a.documentos_exibir_coluna_tipo,main.permitir_bloquear_reprovados="N"!=a.documentos_permitir_bloquear_reprovados,main.clicksign_ativo="N"!=a.clicksign_ativo,main.certsign_ativo="N"!=a.certsign_ativo,main.d4sign_ativo="N"!=a.d4sign_ativo})},this.btn_carregar_mais.unbind("click").click(function(){main.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),$(this).find("span.icn_carregar_mais").remove(),$(this).append('<span class="icn_carregar_mais fa fa-spinner fa-spin"></span>'),main.dialog.find(".active").hasClass("btn_pendente")||(main.listar_documentos(main.documento_pasta_id_atual,!0),main.atualizar_jstree(),main.pode_buscar&&(main.render_documentos(),main.contador_atual=main.contador_pastas+main.contador_documento,main.totalizador_geral.text(main.contador_atual+" de "+main.contador_geral)))}),this.limpar_limite=function(){main.limite=0,main.controlador_pastas=0,main.pode_buscar=!0,main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.Controller_Fila.cache_numeracao_pasta=0,main.Controller_Fila.cache_numeracao_documento=0,main.floating.css("top","0px"),main.tab_listagem.find("tbody > tr:not([template-row])").remove()},this.limpar_listar=function(a){main.selecionados.pastas=[],main.selecionados.documentos=[],main.selecionados_id.pastas=[],main.selecionados_id.documentos=[],main.selecionados_nome.pastas=[],main.selecionados_nome.documentos=[],main.contador_pastas=0,main.contador_documento=0,main.contador_geral=0,main.totalizador_geral.text(main.contador_geral),main.totalizador_documento.text(main.contador_documento),main.totalizador_pasta.text(main.contador_pastas),main.limpar_limite(),void 0!==a?(main.ultimo_limite_incrementado=0,main.Controller_Fila.clear(),main.documento_pasta_id_atual=a,main.listar_documentos(a),main.atualizar_jstree(),main.jstree_id_last_open=a,main.arvore.jstree("open_node",a)):(main.listar_documentos(main.documento_pasta_id_atual),main.atualizar_jstree())},this.verifica_permissao_ged=function(obj_documento,tipo_permissao){if(App.sessao.dados.admin)return!0;var arr_permitido=["seguranca","exclusao","escrita","visualizacao","download"];if(!arr_permitido.includes(tipo_permissao))return!1;if(obj_documento&&tipo_permissao){if("N"==obj_documento.controle_acessos&&"N"==obj_documento.documento_pasta_controle_acessos)return!0;if("S"==obj_documento.controle_acessos){var permissao_usuario=eval("obj_documento.usuario_permissao_"+tipo_permissao),permissao_grupo=eval("obj_documento.grupo_usuarios_permissao_"+tipo_permissao);return"S"==permissao_usuario||"S"==permissao_grupo}if("S"==obj_documento.documento_pasta_controle_acessos){var permissao_usuario=eval("obj_documento.usuario_pasta_permissao_"+tipo_permissao),permissao_grupo=eval("obj_documento.grupo_usuarios_pasta_permissao_"+tipo_permissao);return"S"==permissao_usuario||"S"==permissao_grupo}}return!1},this.chk_refinar_filtro_nome.click(function(){var a=$(this).val();main.chk_refinar_filtro_nome.filter('[value="'+a+'"]').prop("checked",!0)}),this.chk_refinar_filtro_tag.change(function(){var a=$(this).val();main.chk_refinar_filtro_tag.filter('[value="'+a+'"]').prop("checked",!0)})};return Central_Documentos_Listar});