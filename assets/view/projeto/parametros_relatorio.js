define([],function(){return function(a){"use strict";var e=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.onselect=null,this.onclose=null,this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_pesquisar=this.dialog.find(".btn_pesquisar"),this.cbo_projeto=this.dialog.find(".cbo_projeto"),this.edt_referencia=this.dialog.find(".edt_referencia"),this.chk_destacar_atrasadas=this.dialog.find(".chk_destacar_atrasadas"),this.chk_destacar_programadas=this.dialog.find(".chk_destacar_programadas"),this.cliente_id=null,this.projeto_id=null,this.show=function(a){e.carregar_local_storage(),e.chk_destacar_programadas.removeClass("template_switch").prop("checked","S"==App.temp.projeto_parametros_relatorio_programada).change(),e.chk_destacar_atrasadas.removeClass("template_switch").prop("checked","S"==App.temp.projeto_parametros_relatorio_atrasada).change(),set_datepicker(e.edt_referencia);var t=new Date,o=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2),i=t.getFullYear()+"-"+r+"-"+o;setTimeout(function(){set_datepicker(e.edt_referencia,i)},150),e.projeto_id=a,show_modal(e.modal.attr("id"))},this.close=function(){close_modal(e.modal.attr("id")),void 0!==e.onclose&&e.onclose&&e.onclose()},this.unload=function(){e.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){e.unload()}),this.btn_pesquisar.unbind("click"),this.btn_pesquisar.click(function(){if(e.salva_local_storage(),null==e.edt_referencia.val()||""==e.edt_referencia.val().trim())return(a=new Validation).add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a referência!")),void alert_modal("Validação",a);var a,t=null;if(App.temp.empresa&&(t=App.temp.empresa),null==t)return(a=new Validation).add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a empresa!")),void alert_modal("Validação",a);App.obter_token_publico(function(a){App.download(WS_URI+"projeto/download_relatorio_de_posicionamento/?projeto_id="+e.projeto_id+"&empresa_id="+t+"&data_referencia="+get_datepicker(e.edt_referencia)+"&destacar_atividades_atrasadas="+App.temp.projeto_parametros_relatorio_atrasada+"&destacar_atividades_programada="+App.temp.projeto_parametros_relatorio_programada+"&token_publico="+a)}),e.unload()}),this.salva_local_storage=function(){"undefined"!=typeof Storage&&(localStorage.setItem("bp_projeto_parametros_relatorio_atrasada",App.temp.projeto_parametros_relatorio_atrasada),localStorage.setItem("bp_projeto_parametros_relatorio_programada",App.temp.projeto_parametros_relatorio_programada))},this.carregar_local_storage=function(){if("undefined"!=typeof Storage){var a=localStorage.getItem("bp_projeto_parametros_relatorio_atrasada");void 0!==a&&a&&(App.temp.projeto_parametros_relatorio_atrasada=a);var e=localStorage.getItem("bp_projeto_parametros_relatorio_programada");void 0!==e&&e&&(App.temp.projeto_parametros_relatorio_programada=e)}},this.chk_destacar_atrasadas.unbind("change").change(function(a){var e=$(this);App.temp.projeto_parametros_relatorio_atrasada=1==e.prop("checked")?"S":"N"}),this.chk_destacar_programadas.unbind("change").change(function(a){var e=$(this);App.temp.projeto_parametros_relatorio_programada=1==e.prop("checked")?"S":"N"})}});