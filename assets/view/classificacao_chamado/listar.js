define([],function(){return function(a){"use strict";var e=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Classificação de Chamado",this.dx_listagem_chamado_classificacao=this.dialog.find(".dx_listagem_chamado_classificacao"),this.clearState=!1,this.show=function(){e.listar()},this.listar=function(){WS.get("chamado_classificacao/listar/",null,function(a){e.preencher(a)})},this.preencher=function(a){var i=document.createElement("div");i.className="div_listagem_chamado_classificacao",i.style="min-width: 100%;",e.dx_listagem_chamado_classificacao.find(".div_listagem_chamado_classificacao").remove(),e.dx_listagem_chamado_classificacao[0].appendChild(i);var o=detectmob()?"select":"dragAndDrop",t=get_icon_class();e.dx_listagem_chamado_classificacao.find(".div_listagem_chamado_classificacao").css("height","calc(100vh - 42px)");var s=e.dx_listagem_chamado_classificacao.find(".div_listagem_chamado_classificacao").dxDataGrid({dataSource:a,keyExpr:"id",allowColumnReordering:!0,showBorders:!0,columnResizingMode:"widget",rowAlternationEnabled:!1,searchPanel:{visible:!detectmob(),width:200,placeholder:"Pesquisa geral"},paging:{pageSize:20},pager:{showPageSizeSelector:!0,allowedPageSizes:[20,50,100],showInfo:!0},allowColumnReordering:!0,allowColumnResizing:!0,columnChooser:{enabled:!0,allowSearch:!0,mode:o},stateStoring:{enabled:!0,type:"custom",customLoad:function(a){return App.get_parametro_usuario("classificacao_chamado")},customSave:function(a){App.set_parametro_usuario("classificacao_chamado",a)}},selection:{mode:"multiple"},export:{enabled:!0,fileName:"Relatório de classificação de chamado "+agora(),allowExportSelectedData:!0},filterRow:{visible:!0,applyFilter:"auto"},headerFilter:{visible:!0},filterPanel:{visible:!0},sorting:{mode:"multiple"},onToolbarPreparing:function(a){var i=[{widget:"dxButton",options:{icon:"fa fa-plus",hint:"Adicionar uma classificação",text:"Adicionar uma classificação",onClick:function(){s.addRow()}},location:"after",name:"BtnNovoRegistro",locateInMenu:"auto"},{widget:"dxButton",options:{icon:"fa fa-sync",hint:"Recarregar listagem de classificações",text:"Recarregar listagem de classificações",onClick:function(){e.listar()}},showText:"inMenu",location:"after",name:"BtnRefresh",locateInMenu:"auto"}];a.toolbarOptions.items=add_botao_dx_toolbar(i,a.toolbarOptions.items);for(var o=0;o<a.toolbarOptions.items.length;o++){var t=a.toolbarOptions.items[o];"saveButton"===t.name&&(t.options.onClick=function(a){WS.post("chamado_classificacao/salvar_dx/",{data:CircularJSON.stringify(s.getController("editing").getChanges())},function(a){var i=!0===a?"success":"error",o=!0===a?"Todos as classificações foram salvos":"Falha ao salvar as classificações";DevExpress.ui.notify.default({message:o,type:i,displayTime:3e3,width:300}),!0===a&&e.listar()})})}},onContentReady:function(a){add_filtro_cor_tema(a),e.clearState&&(e.dx_listagem_chamado_classificacao.find(".div_listagem_chamado_classificacao").dxDataGrid("instance").state({}),e.clearState=!1)},focusedRowEnabled:!1,editing:{mode:"batch",allowUpdating:!0,useIcons:!0},columns:[{dataField:"nome",caption:"Nome da classificação"},{type:"buttons",buttons:[{hint:"Apagar registro",icon:"fa fa-trash",cssClass:t,visible:function(a){return!a.row.removed},onClick:function(a){s.deleteRow(a.row.rowIndex),a.event.preventDefault()}},{hint:"Recuperar registro",icon:"fa fa-undo",cssClass:t,visible:function(a){return a.row.removed},onClick:function(a){s.undeleteRow(a.row.rowIndex),a.event.preventDefault()}}]}],onContextMenuPreparing:function(a){"header"==a.target&&Array.isArray(a.items)&&a.items.push({text:"Restaurar estado das colunas",visible:!0,beginGroup:!0,onItemClick:function(a){DevExpress.ui.dialog.confirm("Os filtros, ordenações, agrupamentos, posição, tamanho, e visibilidade das colunas desta listagem serão restauradas ao estado padrão. <b>Deseja continuar?</b>","Restaurar estado das colunas").done(function(a){a&&(e.clearState=!0,e.listar())})}})}}).dxDataGrid("instance")},event_salvar(e.dialog,e.dx_listagem_chamado_classificacao),event_desfazer(e.dialog,e.dx_listagem_chamado_classificacao),this.unload=function(){View.unload(this.html_id)}}});