define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Servidor LDAP",this.onclose=null,this.params={limite:0},this.params_template={limite:0,considerar_bloqueado:!1},this.limite=0,this.incrementar_limite=!1,this.limite_a_cada=50,this.controle_ignore_error=!1,this.ultimo_limite_incrementado=0,this.bloqueia_limite=!1,this.cbo_filtro_local=this.dialog.find(".cbo_filtro_local"),this.cbo_filtro_motivo=this.dialog.find(".cbo_filtro_motivo"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_atualizar=this.dialog.find(".btn_atualizar"),this.btn_limpar_filtros=this.dialog.find(".btn_limpar_filtros"),this.btn_ordenacao=this.dialog.find(".orderbypointer"),this.btn_config=this.dialog.find(".btn_config"),this.container_config=this.dialog.find("[config]"),this.chk_mostrar_bloqueados=this.dialog.find(".chk_mostrar_bloqueados"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.tab_listagem=this.dialog.find(".tab_listagem").Tabela_Padrao_Next(),this.show=function(){i.inicializar_componentes(),i.listar(!0)},this.listar=function(a){if(void 0!==a&&"boolean"==typeof a||(a=!1),!i.bloqueia_limite){i.params.limite=i.limite;var t=function(a,t){t=extender_parametros({codigo:"-",nome:"-",endereco:"-",porta:"-",padrao:"-"},t);var e=$.Tabela_Padrao_Next.create_row(i.tab_listagem),r=($.Tabela_Padrao_Next.getColumn(e,"codigo").text(t.id),$.Tabela_Padrao_Next.getColumn(e,"nome").text(t.nome),$.Tabela_Padrao_Next.getColumn(e,"endereco").text(t.endereco),$.Tabela_Padrao_Next.getColumn(e,"porta").text(t.porta),$.Tabela_Padrao_Next.getColumn(e,"padrao").text(t.padrao),$.Tabela_Padrao_Next.getColumn(e,"acao")),n=$.Tabela_Padrao_Next.getColumn(r,"btn_visualizar"),o=$.Tabela_Padrao_Next.getColumn(r,"btn_editar"),s=$.Tabela_Padrao_Next.getColumn(r,"btn_excluir");n.unbind("click").click(function(a){i.evento_visualizar($(this),t)}),o.unbind("click").click(function(a){i.evento_editar($(this),t)}),s.unbind("click").click(function(a){i.evento_excluir($(this),t)}),$.Tabela_Padrao_Next.RenderRow(i.tab_listagem,e)};WS.get({route:"servidor_ldap/listar/",type:"GET",data:i.params,func_response:function(e){if(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.carregar_mais_registros),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-arrow-down"></span>'),e)if(a&&(i.limite=i.limite+i.limite_a_cada),0==e.length)i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.todos_carregados),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-check"></span>'),i.bloqueia_limite=!0;else for(var r=0;r<e.length;r++){var n=e[r];t(0,n)}},html_id:i.html_id,disable_buttons:[i.btn_atualizar,i.btn_limpar_filtros]})}},this.limpar_tabela=function(){$.Tabela_Padrao_Next.clear(i.tab_listagem),i.params.limite=0,i.limite=0,i.bloqueia_limite=!1},this.unload=function(){View.unload(this.html_id)},this.inicializar_componentes=function(){i.container_config.toggle(!1),$.Tabela_Padrao_Next.Filtros.Start(i.tab_listagem,{},function(a,t,e){for(var r in a[e]=t,a)a[r]instanceof Array&&(a[r]=JSON.stringify(a[r]));i.params=extender_parametros(i.params_template,a),setTimeout(function(){i.evento_atualizar()},300)})},this.evento_atualizar=function(){i.limpar_tabela(),i.listar(!0)},this.evento_visualizar=function(a,t){View.load("servidor_ldap/detalhes",function(a,e){var r={tipo:FORMULARIO.VISUALIZAR,servidor_ldap_id:t.id};e.onclose=function(){i.evento_atualizar()},e.show(r)},View.ABA.MULTIPLAS)},this.evento_editar=function(a,t){View.load("servidor_ldap/detalhes",function(a,e){var r={tipo:FORMULARIO.EDITAR,servidor_ldap_id:t.id};e.onclose=function(){i.evento_atualizar()},e.show(r)},View.ABA.MULTIPLAS)},this.evento_excluir=function(a,t){View.load("servidor_ldap/detalhes",function(a,e){var r={tipo:FORMULARIO.EXCLUIR,servidor_ldap_id:t.id};e.onclose=function(){i.evento_atualizar()},e.show(r)},View.ABA.MULTIPLAS)},this.func_organizacao=function(a,t){i.limpar_tabela(),i.params=i.params_template,i.params.orderby=a,i.params.asc=t,console.log(i.params),setTimeout(function(){i.listar(!0)},300)},this.btn_atualizar.unbind("click").click(function(a){i.evento_atualizar()}),this.btn_limpar_filtros.unbind("click").click(function(a){$.tabela_padrao_bp_filtro("clean",i.html_id,i.tab_listagem),i.params=i.params_template,i.limpar_tabela(),i.listar(!0)}),this.btn_novo.unbind("click").click(function(a){View.load("servidor_ldap/detalhes",function(a,t){var e={tipo:FORMULARIO.NOVO,servidor_ldap_id:null};t.onclose=function(){i.evento_atualizar()},t.show(e)},View.ABA.MULTIPLAS)}),this.btn_ordenacao.unbind("click").click(function(a){var t=$(this),e=$(t).attr("data-ordername"),r=$(t).attr("data-asc");if(0===r.length){for(var n=0;n<i.btn_ordenacao.length;n++)if($(i.btn_ordenacao[n])!==$(t)){try{$(i.btn_ordenacao[n]).find(".icon_orderby").removeClass("fa-sort-up fa-sort-down").addClass("hidden fa-sort-down")}catch(a){}$(i.btn_ordenacao[n]).attr("data-asc","")}r=!0,$(t).attr("data-asc",r),$(t).find(".icon_orderby").removeClass("hidden")}else r=!(r="true"==r),$(t).attr("data-asc",r),$(t).find(".icon_orderby").toggleClass("fa-sort-down fa-sort-up");i.func_organizacao(e,r)}),this.btn_config.unbind("click").click(function(a){var t=$(this).prop("data-active");t=!t,$(this).prop("data-active",t),i.container_config.toggle(t)}),this.btn_carregar_mais.unbind("click").click(function(){i.bloqueia_limite||(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-spinner fa-spin">'),i.listar(!0))})}});