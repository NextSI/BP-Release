define([],function(){return function(i){"use strict";var t=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Munic√≠pios",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.btn_filtrar=this.dialog.find(".btn_filtrar"),this.btn_limpar_filtro=this.dialog.find(".btn_limpar_filtro"),this.div_carregar_mais=this.dialog.find(".div_carregar_mais"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.pode_buscar=!0,this.limite=0,this.municipio=null,this.uf=null,this.uf_sigla=null,t.btn_limpar_filtro.hide(),App.temp.municipio_listar||(App.temp.municipio_listar={},App.temp.municipio_listar.municipio="",App.temp.municipio_listar.uf="",App.temp.municipio_listar.uf_sigla=""),t.municipio=App.temp.municipio_listar.municipio,t.uf=App.temp.municipio_listar.uf,t.uf_sigla=App.temp.municipio_listar.uf_sigla,this.listar=function(){var i=t.tab_listagem.find("tbody"),a=i.find("tr:first");if(0===t.limite&&t.tab_listagem.find("tr:gt(1)").remove(),""!=App.temp.municipio_listar.municipio.trim()||""!=App.temp.municipio_listar.uf.trim()||""!=App.temp.municipio_listar.uf_sigla.trim()){var n={municipio:App.temp.municipio_listar.municipio,uf:App.temp.municipio_listar.uf,uf_sigla:App.temp.municipio_listar.uf_sigla,limite:t.limite};WS.get("municipio/listar/",n,function(n){t.div_carregar_mais.removeClass("hidden"),t.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.carregar_mais_registros),t.btn_carregar_mais.find("span.icn_carregar_mais").remove(),t.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-arrow-down"></span>'),0===n.length&&(t.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.todos_carregados),t.btn_carregar_mais.find("span.icn_carregar_mais").remove(),t.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-check"></span>'),t.pode_buscar=!1),t.pode_buscar&&$(n).each(function(n,r){!function(n){var r=a.clone();r.removeAttr("template-row"),r.css("display",""),$(r.find("[template-field='cod_uf']")).text(n.cod_uf?n.cod_uf:""),$(r.find("[template-field='cod_municipio']")).text(n.cod_municipio?n.cod_municipio:""),$(r.find("[template-field='uf']")).text(n.uf?n.uf:""),$(r.find("[template-field='municipio']")).text(n.municipio?n.municipio:""),$(r.find("[template-field='uf_sigla']")).text(n.uf_sigla?n.uf_sigla:"");var s=$(r.find(".btn_visualizar"));s.unbind("click"),s.click(function(){View.load("municipio/detalhes",function(i,t){t.show(n.municipio_id,FORMULARIO.VISUALIZAR)})});var p=$(r.find(".btn_editar")),c=function(){View.load("municipio/detalhes",function(i,a){a.onclose=t.listar,a.show(n.municipio_id,FORMULARIO.EDITAR)})};p.unbind("click"),p.click(c),r.dblclick(c);var l=$(r.find(".btn_excluir"));l.unbind("click"),l.click(function(){View.load("municipio/detalhes",function(i,a){a.onclose=t.listar,a.show(n.municipio_id,FORMULARIO.EXCLUIR)})}),r.appendTo(i)}(r)})})}},this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("municipio/detalhes",function(i,a){a.onclose=t.limpar_listar,a.show(null,FORMULARIO.NOVO)})}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){t.limpar_listar()}),this.btn_filtrar.unbind("click"),this.btn_filtrar.click(function(){View.load("municipio/parametros",function(i,a){a.onclose=t.limpar_listar,a.show(function(i){t.municipio=i.municipio,t.uf=i.uf,t.uf_sigla=i.uf_sigla,App.temp.municipio_listar.municipio=t.municipio,App.temp.municipio_listar.uf=t.uf,App.temp.municipio_listar.uf_sigla=t.uf_sigla},App.temp.municipio_listar.municipio,App.temp.municipio_listar.uf,App.temp.municipio_listar.uf_sigla)})}),this.btn_limpar_filtro.unbind("click"),this.btn_limpar_filtro.click(function(){App.temp.municipio_listar.municipio="",App.temp.municipio_listar.uf="",App.temp.municipio_listar.uf_sigla="",t.municipio="",t.uf="",t.uf_sigla="",t.btn_limpar_filtro.hide(),t.limpar_listar()}),this.limpar_listar=function(){t.limpar_limite(),t.listar()},this.limpar_limite=function(){t.limite=0,t.pode_buscar=!0},this.btn_carregar_mais.unbind("click").click(function(){t.pode_buscar&&(t.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),t.btn_carregar_mais.find("span.icn_carregar_mais").remove(),t.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-spinner fa-spin">'),t.limite=t.limite+100,t.listar())}),this.unload=function(){View.unload(this.html_id)},t.btn_filtrar.click()}});