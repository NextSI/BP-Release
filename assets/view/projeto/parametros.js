define([],function(){return function(t){"use strict";var i=this;this.html_id=t,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.onselect=null,this.onclose=null,this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_pesquisar=this.dialog.find(".btn_pesquisar"),this.cbo_cliente=this.dialog.find(".cbo_cliente"),this.cbo_projeto=this.dialog.find(".cbo_projeto"),this.edt_data_inicio=this.dialog.find(".edt_data_inicio"),this.edt_data_fim=this.dialog.find(".edt_data_fim"),this.cliente_id=null,this.projeto_id=null,this.show=function(t){i.onselect=t,create_combobox(i.cbo_cliente,i.listar_clientes),i.criar_events_cliente(i.cbo_cliente),i.listar_projeto(),show_modal(i.modal.attr("id"))},this.listar_clientes=function(t,e){var o=e.parent(),n=o.find(".edt_combobox");WS.get("cliente/listar_clientes_projeto/",{texto_pesquisa:n.val(),somente_cliente:App.sessao.dados.tipo==USUARIO_TIPO.CLIENTE},function(n){limpar_combobox(e),$(n).each(function(t,i){var o=[];o.Nome=i.nome_fantasia,o["RazÃ£o"]=i.razao_social,o.CNPJ=i.cnpj,add_option_combobox(e,t,i.cliente_id>0?i.cliente_id:null,o)}),t(!0),o.find(".ul_row").click(function(){var t=$(this).parent().attr("id_registro");i.cliente_id=t,i.listar_projeto()})})},this.criar_events_cliente=function(t){var e=t.parent().find(".edt_combobox");e.keypress(function(o){13==o.keyCode?setTimeout(function(){var o=t.parent().find(".ncbo_scroll").find(".row_selected");if(""==e.val().trim())i.cliente_id=null;else{var n=o.attr("id_registro");n>0&&(i.cliente_id=n)}i.listar_projeto(),set_focus(e)},150):13==o.tecla_value&&(i.cliente_id=$(this).attr("selected-value"),i.listar_projeto())})},this.listar_projeto=function(){i.cbo_projeto.find("option").remove(),add_option(i.cbo_projeto,"","-- Todos --"),WS.get("projeto/get_projeto/",{cliente_id:i.cliente_id},function(t){for(var e=0;e<t.length;e++){var o=t[e];add_option(i.cbo_projeto,o.id,o.nome)}i.cbo_projeto.selectpicker("refresh")})},this.close=function(){close_modal(i.modal.attr("id")),void 0!==i.onclose&&i.onclose&&i.onclose()},this.unload=function(){i.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_pesquisar.unbind("click"),this.btn_pesquisar.click(function(){var t={cliente_id:i.cliente_id,projeto_id:i.cbo_projeto.val(),data_inicio:get_datepicker(i.edt_data_inicio),data_fim:get_datepicker(i.edt_data_fim)};i.onselect(t),i.unload()})}});