define(["react","react-dom","./../componentes_react/CboClientes","./../atividade_projeto/ListarAtividadeProjeto"],function(a,e,i,o){return function(n){"use strict";var d=this;this.html_id=n,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.label_modal_evento_agenda_novo=this.dialog.find(".label_modal_evento_agenda_novo"),this.edt_evento_dia=this.dialog.find(".edt_evento_dia"),this.edt_evento_inicio=this.dialog.find(".edt_evento_inicio"),this.edt_evento_fim=this.dialog.find(".edt_evento_fim"),this.edt_evento_notificar_antes=this.dialog.find(".edt_evento_notificar_antes"),this.chk_dia_inteiro=this.dialog.find(".chk_dia_inteiro"),this.div_evento_inicio=this.dialog.find(".div_evento_inicio"),this.div_evento_fim=this.dialog.find(".div_evento_fim"),this.div_evento_notificar_antes=this.dialog.find(".div_evento_notificar_antes"),this.edt_titulo=this.dialog.find(".edt_titulo"),this.edt_evento_descricao=this.dialog.find(".edt_evento_descricao"),this.edt_percentual_atuacao=this.dialog.find(".edt_percentual_atuacao"),this.edt_percentual_competencia=this.dialog.find(".edt_percentual_competencia"),this.edt_valor_atuacao=this.dialog.find(".edt_valor_atuacao"),this.edt_valor_competencia=this.dialog.find(".edt_valor_competencia"),this.tipo_agenda=this.dialog.find(".tipo_agenda"),this.cbo_evento_tipo_agenda=this.dialog.find(".cbo_evento_tipo_agenda"),this.cbo_evento_local=this.dialog.find(".cbo_evento_local"),this.cbo_evento_cliente=this.dialog.find(".cbo_evento_cliente"),this.cbo_evento_fornecedor=this.dialog.find(".cbo_evento_fornecedor"),this.cbo_evento_prospect=this.dialog.find(".cbo_evento_prospect"),this.cbo_evento_empresa=this.dialog.find(".cbo_evento_empresa"),this.cbo_evento_projeto=this.dialog.find(".cbo_evento_projeto"),this.div_componente_convidado=this.dialog.find(".div_componente_convidado"),this.modal_evento=this.dialog.find(".modal_evento"),this.div_projeto=this.dialog.find(".div_projeto"),this.div_atividade_projeto=this.dialog.find(".div_atividade_projeto"),this.div_componente_atividades=this.dialog.find(".div_componente_atividades"),this.tab_historico=this.dialog.find(".tab_historico"),this.tb_convidados=this.dialog.find(".tb_convidados"),this.lbl_tab_historico=this.dialog.find(".lbl_tab_historico"),this.lbl_tab_recorrencia=this.dialog.find(".lbl_tab_recorrencia"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_confirmar=this.dialog.find(".btn_confirmar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.div_load=this.dialog.find(".div_load"),this.btn_ok=this.dialog.find(".btn_ok"),this.div_component_cbo_clientes=this.dialog.find(".div_component_cbo_clientes"),this.cboClientes=a.createElement(i,{initial_values:{placeholder:"Pesquisar por nome/cnpj"}},null),this.ListarAtividadeProjeto=a.createElement(o,null,null),this.div_radio_tipo_recorrencia=this.dialog.find(".div_radio_tipo_recorrencia"),this.div_diario=this.dialog.find(".div_diario"),this.div_semanal=this.dialog.find(".div_semanal"),this.div_mensal=this.dialog.find(".div_mensal"),this.div_anual=this.dialog.find(".div_anual"),this.edt_quantidade_diario=this.dialog.find(".edt_quantidade_diario"),this.edt_quantidade_semanal=this.dialog.find(".edt_quantidade_semanal"),this.chk_mensal_domingo=this.dialog.find(".chk_mensal_domingo"),this.chk_mensal_segunda=this.dialog.find(".chk_mensal_segunda"),this.chk_mensal_terca=this.dialog.find(".chk_mensal_terca"),this.chk_mensal_quarta=this.dialog.find(".chk_mensal_quarta"),this.chk_mensal_quinta=this.dialog.find(".chk_mensal_quinta"),this.chk_mensal_sexta=this.dialog.find(".chk_mensal_sexta"),this.chk_mensal_sabado=this.dialog.find(".chk_mensal_sabado"),this.edt_dia_mes=this.dialog.find(".edt_dia_mes"),this.edt_qtde_mes=this.dialog.find(".edt_qtde_mes"),this.cbo_numero_da_semana=this.dialog.find(".cbo_numero_da_semana"),this.cbo_dia_semana=this.dialog.find(".cbo_dia_semana"),this.edt_mensal_qtde=this.dialog.find(".edt_mensal_qtde"),this.edt_quantidade_ano=this.dialog.find(".edt_quantidade_ano"),this.cbo_anual_meses=this.dialog.find(".cbo_anual_meses"),this.edt_anual_dia=this.dialog.find(".edt_anual_dia"),this.cbo_anual_numero_da_semana=this.dialog.find(".cbo_anual_numero_da_semana"),this.cbo_anual_dia_semana=this.dialog.find(".cbo_anual_dia_semana"),this.cbo_anual_meses2=this.dialog.find(".cbo_anual_meses2"),this.edt_data_inicial=this.dialog.find(".edt_data_inicial"),this.edt_intervalo_recorrencia_quantidade_dias=this.dialog.find(".edt_intervalo_recorrencia_quantidade_dias"),this.div_intervalo_recorrencia=this.dialog.find(".div_intervalo_recorrencia"),this.div_intervalo_recorrencia_geral=this.dialog.find(".div_intervalo_recorrencia_geral"),this.edt_data_final=this.dialog.find(".edt_data_final"),this.div_local_agenda=this.dialog.find(".div_local_agenda"),this.div_dados_projeto=this.dialog.find(".div_dados_projeto"),this.cbo_evento_tipo=this.dialog.find(".cbo_evento_tipo"),this.opt_radio_diario=this.dialog.find('input[name="opt_radio_diario"]'),this.opt_tipo_intervalo_recorrencia=this.dialog.find('input[name="opt_tipo_intervalo_recorrencia"]'),this.opt_radio_mensal=this.dialog.find('input[name="opt_radio_mensal"]'),this.opt_radio_tipo_recorrencia=this.dialog.find('input[name="opt_radio_tipo_recorrencia"]'),this.opt_radio_anual=this.dialog.find('input[name="opt_radio_anual"]'),this.div_chk_semanal=this.dialog.find(".chk_semanal"),this.menu_geral=this.dialog.find(".menu_geral"),this.aba_geral=this.dialog.find(".aba_geral"),this.menu_recorrencia=this.dialog.find(".menu_recorrencia"),this.aba_recorrencia=this.dialog.find(".aba_recorrencia"),this.menu_historico=this.dialog.find(".menu_historico"),this.aba_historico=this.dialog.find(".aba_historico"),this.aba_convidados=this.dialog.find(".aba_convidados"),this.menu_convidados=this.dialog.find(".menu_convidados"),this.menu_responsavel=this.dialog.find(".menu_responsavel"),this.edt_horas_recorrencia=this.dialog.find(".edt_horas_recorrencia"),this.chk_utiliza_calendario_trabalho=this.dialog.find(".chk_utiliza_calendario_trabalho"),this.chk_realizado=this.dialog.find(".chk_realizado"),this.div_horas=this.dialog.find(".div_horas"),this.div_valor=this.dialog.find(".div_valor"),this.div_percentual=this.dialog.find(".div_percentual"),this.tbl_agenda_usuario=this.dialog.find(".tbl_agenda_usuario"),this.chk_notificar_envolvidos=this.dialog.find(".chk_notificar_envolvidos"),this.menu_emails_acompanhamento=this.dialog.find(".menu_emails_acompanhamento"),this.aba_emails_acompanhamento=this.dialog.find(".aba_emails_acompanhamento"),this.grid_emails_acompanhamento=this.dialog.find("#grid_emails_acompanhamento"),this.div_info_feriado=this.dialog.find(".div_info_feriado"),this.sel_evento_id=null,this.sel_usuario_id=null,this.evento_cliente_id=null,this.evento_cliente_nome=null,this.evento_fornecedor_id=null,this.evento_prospect_id=null,this.evento_empresa_id=null,this.evento_projeto_id=null,this.evento_tipo_agenda_id=null,this.projeto_atividade_id=null,this.limite=0,this.arr_agenda_recorrente=null,this.tipo_reprogramacao=null,this.arr_usuarios=[],this.envolvido_tipo=null,this.previsao_inicio=null,this.horas_previstas=null,this.somente_realizado=!1,this.agenda_ativo_id=null,this.sugestao_local_agenda=null,this.sugestao_tipo_agenda=null,this.usuario_nome,this.calendario_trabalho_id=null,this.criado_por=null,this.evento_id=null,this.dia_evento=null,this.convidado_evento=null,this.evento_pessoal=!1,this.forcar_evento_dia=!1,this.filtros=null,this.permite_desabilitar=!1,this.evento_possui_recorrencia=!1,this.permissao_manutencao_agenda_ativo="N",this.emails_acompanhamento=[],this.permissao_alterar=null,this.arr_feriados=[],this.show=function(a,e,i,o,n,t,_,r,l,s){d.forcar_evento_dia=s,"object"==typeof a&&null!=a?(e=a.usuario_id,i=a.dia,d.dia_evento=i,o=a.usuario_nome,d.calendario_trabalho_id=+a.calendario_trabalho_id||0,n=a.obj_dados_projeto,d.agenda_ativo_id=-1==a.agenda_ativo_id?null:a.agenda_ativo_id,d.criado_por=a.criado_por||null,d.evento_id=a,d.convidado_evento=l||"S"==a.convidado_evento||1==a.convidado_evento,d.forcar_evento_dia=a.forcar_evento_dia,d.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo||"N",a=a.evento_id):(d.agenda_ativo_id=t,d.calendario_trabalho_id=+_||0,d.criado_por=r||0),d.usuario_nome=o,d.edt_horas_recorrencia.mask("000:00"),d.edt_valor_atuacao.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),d.edt_valor_competencia.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),d.aba_geral.attr("id","aba_geral"+d.html_id),d.menu_geral.attr("href","#"+d.aba_geral.attr("id")),d.aba_recorrencia.attr("id","aba_recorrencia"+d.html_id),d.menu_recorrencia.attr("href","#"+d.aba_recorrencia.attr("id")),d.aba_historico.attr("id","aba_historico"+d.html_id),d.menu_historico.attr("href","#"+d.aba_historico.attr("id")),d.aba_convidados.attr("id","aba_convidados"+d.html_id),d.menu_convidados.attr("href","#"+d.aba_convidados.attr("id")),d.menu_responsavel.attr("href","#"+d.aba_convidados.attr("id")),d.aba_emails_acompanhamento.attr("id","aba_emails_acompanhamento"+d.html_id),d.menu_emails_acompanhamento.attr("href","#"+d.aba_emails_acompanhamento.attr("id")),d.edt_evento_descricao.attr("id","edt_evento_descricao"+d.html_id),set_datepicker(d.edt_evento_dia),set_datepicker(d.edt_data_inicial),d.label_modal_evento_agenda_novo.hide(),d.limpar_evento(),d.renderizarComponenteConvidado(),create_combobox(d.cbo_evento_projeto,d.listar_projeto);var c={manutencao_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),manutencao_propria_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),manutencao_agenda_ativo:App.verifica_permissao(App.temp.empresa,"manutencao_agenda_ativo")&&("S"==d.permissao_manutencao_agenda_ativo||"P"==d.permissao_manutencao_agenda_ativo&&!a)},p=App.sessao.dados.admin||!(+d.agenda_ativo_id>0)&&c.manutencao_agenda||!(+d.agenda_ativo_id>0)&&c.manutencao_propria_agenda&&+e>0&&+e==App.sessao.dados.usuario_id||+d.agenda_ativo_id>0&&c.manutencao_agenda_ativo;d.permissao_alterar=p,d.permite_alterar(p,d.convidado_evento),0==d.calendario_trabalho_id&&d.chk_utiliza_calendario_trabalho.parent().addClass("hidden"),a?(d.sel_evento_id=a,d.preencher()):(set_tinymce(d.edt_evento_descricao,"",d.permite_desabilitar),d.chk_utiliza_calendario_trabalho.removeClass("template_switch"),App.aplicar_checkbox(d.div_horas),void 0!==n&&null!=n&&(d.evento_cliente_id=n.cliente_id,d.evento_cliente_nome=n.cliente_nome,d.evento_projeto_id=n.projeto_id,d.evento_projeto_nome=n.projeto_nome,d.projeto_atividade_id=n.projeto_atividade_id,d.previsao_inicio=n.previsao_inicio,d.horas_previstas=n.horas_previstas,d.filtros.cliente_id=d.evento_cliente_id,d.filtros.cliente_nome=d.evento_cliente_nome,d.div_projeto.removeClass("hidden"),d.div_atividade_projeto.removeClass("hidden"),d.listar_atividades_projeto(d.evento_projeto_id),set_value_combobox(d.cbo_evento_projeto,d.evento_projeto_id,d.evento_projeto_nome)),d.title.html(" "+App.lang.gestao_agenda.novo_evento+' <span class="small">'+o+"</span>"),d.listar_tipo_agenda(),d.listar_local_agenda(),setTimeout(function(){null!=d.previsao_inicio&&""!=d.previsao_inicio?(set_datepicker(d.edt_evento_dia,d.previsao_inicio),set_datepicker(d.edt_data_inicial,d.previsao_inicio)):(set_datepicker(d.edt_evento_dia,"object"==typeof i?i.dia:i),set_datepicker(d.edt_data_inicial,"object"==typeof i?i.dia:i))},150),null!=d.horas_previstas&&""!=d.horas_previstas&&(d.edt_horas_recorrencia.val(d.horas_previstas),d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="3"]').prop("checked",!0)),d.sel_evento_id=a,d.sel_usuario_id=e,d.label_modal_evento_agenda_novo.show(),d.edt_evento_inicio.val("object"==typeof i?i.hora_inicio:"08:00"),d.edt_evento_fim.val("object"==typeof i?i.hora_fim:"18:00"),d.btn_excluir.hide(),d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').prop("checked",!0),d.div_intervalo_recorrencia_geral.addClass("hidden"),show_modal(d.modal.attr("id")),set_value_combobox(d.cbo_evento_tipo,App.temp.empresa,App.temp.nome_empresa,""),d.evento_empresa_id=App.temp.empresa,d.renderiza_componentes(),+d.agenda_ativo_id>0&&(d.menu_convidados.addClass("hidden"),d.menu_responsavel.removeClass("hidden"),WS.get({route:"agenda_ativo/objeto/",data:{agenda_ativo_id:d.agenda_ativo_id},func_response:function(a){d.sugestao_local_agenda=a.agenda_local_id,d.sugestao_tipo_agenda=a.agenda_motivo_id,d.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo,setTimeout(function(){d.cbo_evento_local.val(d.sugestao_local_agenda).selectpicker("refresh"),d.cbo_evento_tipo_agenda.val(d.sugestao_tipo_agenda).selectpicker("refresh")},400)}}))),d.preencher_emails_acompanhamento(),d.listar_feriados()},this.renderizarComponenteConvidado=function(){var a={aoAlterar:d.select_convidado,limparAoAlterar:!0,dropDownContainer:d.div_componente_convidado[0]};ReactDOM.render(React.createElement(window.components.SelecaoUsuario.default,a),d.div_componente_convidado[0])},this.select_convidado=function(a,e,i){if(a){var o={usuario_id:e.id,nome:e.nome,excluido:e.excluido,email:e.email};d.render_usuarios(o),i.clearFilter()}},this.preencher_emails_acompanhamento=function(){WS.get("agenda_evento/listar_emails_acompanhamento/",{agenda_evento_id:d.sel_evento_id},function(a){d.gridEmailsAcompanhamento(a)})},this.gridEmailsAcompanhamento=function(a){var e=get_icon_class();d.grid_emails_acompanhamento=d.grid_emails_acompanhamento.dxDataGrid({dataSource:a,showBorders:!0,paging:{enabled:!1},editing:{mode:"cell",allowUpdating:d.permissao_alterar,allowDeleting:d.permissao_alterar,allowAdding:d.permissao_alterar},columns:[{dataField:"email",caption:"E-mails adicionais para acompanhamento",dataType:"string",validationRules:[{type:"email"}],fixed:!0,fixedPosition:"left"},{type:"buttons",fixed:!0,fixedPosition:"right",buttons:[{hint:"Remover e-mail",icon:"fa fa-trash",cssClass:e,onClick:function(a){d.permissao_alterar&&d.grid_emails_acompanhamento.deleteRow(a.row.rowIndex)}}]}]}).dxDataGrid("instance")},this.evt_alterar_cliente=function(){switch(d.filtros=spread({},d.filtros,{cliente_id:d.cboClientes.props.ClienteSelecionado.id,cliente_nome:d.cboClientes.props.ClienteSelecionado.nome_fantasia,cliente_tipo:d.cboClientes.props.ClienteSelecionado.tipo}),d.div_atividade_projeto.addClass("hidden"),d.projeto_atividade_id=null,d.evento_projeto_id=null,set_value_combobox(d.cbo_evento_projeto,null,""),d.filtros.cliente_tipo){case"C":d.evento_cliente_id=d.filtros.cliente_id,d.evento_empresa_id=null,d.evento_prospect_id=null,d.evento_fornecedor_id=null,d.div_projeto.removeClass("hidden"),d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.CLIENTE;break;case"E":d.evento_empresa_id=d.filtros.cliente_id,d.evento_cliente_id=null,d.evento_prospect_id=null,d.evento_fornecedor_id=null,d.div_projeto.addClass("hidden"),d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.EMPRESA;break;case"O":d.evento_prospect_id=d.filtros.cliente_id,d.evento_empresa_id=null,d.evento_cliente_id=null,d.evento_fornecedor_id=null,d.div_projeto.addClass("hidden"),d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.PROSPECT;break;case"F":d.evento_fornecedor_id=d.filtros.cliente_id,d.evento_empresa_id=null,d.evento_prospect_id=null,d.evento_cliente_id=null,d.div_projeto.addClass("hidden"),d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.FORNECEDOR}},this.renderiza_componentes=function(){d.renderiza_combobox_cliente(),d.cboClientes.props.setCliente(d.filtros),d.cboClientes.props.setFunctionSelect(d.evt_alterar_cliente)},this.renderiza_combobox_cliente=function(){d.cboClientes.props.initial_values.disabled=d.permite_desabilitar,e.render(d.cboClientes,d.div_component_cbo_clientes[0]),d.cboClientes.props.setConfiguracoes={main_externo:d,exibe_tipo_entidade:!0,WS_params:{limite:0}}},this.render_usuarios=function(a,e){var i=d.tb_convidados.find("tbody"),o=$(i.find('[template-row="convidados"]')),n=function(a,e){var n=o.clone();n.addClass("rows").attr("indice",a).removeAttr("template-row").css("display",""),$(n.find('[template-field="nome"]')).text(e.nome),$(n.find('[template-field="email"]')).text(e.email);var t=$(n.find('[template-button="btn_remover"]'));t.unbind("click"),t.click(function(){e.excluido="S",d.arr_usuarios[a]=e,n.remove()}),n.appendTo(i)};void 0!==e&&!1!==e?a&&a.usuario_id!=d.sel_usuario_id?$(d.arr_usuarios).in_array(a.usuario_id,"usuario_id",function(e,i){"S"==i.excluido&&(n(e,a),a.excluido="N",d.arr_usuarios[e]=a)})||(n(d.arr_usuarios.length,a),d.arr_usuarios.push(a)):(d.tb_convidados.find(".rows").remove(),$(d.arr_usuarios).each(function(a,e){n(a,e)})):d.validar_convidado(a)},this.render_historico=function(){var a=d.tab_historico.find("tbody"),e=a.find("[template-row]");WS.get("agenda_evento/listar_historico/",{agenda_evento_id:d.sel_evento_id,limite:d.limite},function(i){$(i).each(function(i,o){!function(i,o){var n=e.clone();n.removeAttr("template-row"),n.css("display",""),n.addClass(".rows"),n.find(".lbl_acao").text(acao_agenda_nome(o.acao)),n.find(".lbl_detalhes").text(o.detalhes),n.find(".lbl_usuario").text(o.usuario_nome),n.find(".lbl_data").text(o.quando.format_date_time()),n.appendTo(a)}(0,o)}),d.div_load.addClass("hidden")})},this.close=function(){close_modal(d.modal.attr("id")),void 0!==d.onclose&&d.onclose&&d.onclose()},this.unload=function(){d.close(),View.unload(this.html_id)},this.limpar_evento=function(){d.filtros=spread({},d.filtros,{cliente_id:"",cliente_nome:"",cliente_tipo:""}),d.edt_evento_dia.val(""),d.edt_evento_inicio.val(""),d.edt_evento_fim.val(""),d.cbo_evento_tipo_agenda.val(""),d.cbo_evento_local.val(""),set_value_combobox(d.cbo_evento_projeto,null,""),d.edt_titulo.val("")},this.permite_alterar=function(a,e){d.permite_desabilitar=!a,d.edt_evento_dia.prop("readonly",!a),d.edt_evento_inicio.prop("readonly",!a),d.edt_evento_fim.prop("readonly",!a),d.cbo_evento_tipo_agenda.prop("disabled",!a),d.cbo_evento_local.prop("disabled",!a),d.cbo_evento_tipo.parent().find(".edt_combobox").prop("readonly",!a),d.cbo_evento_tipo.parent().find("button").prop("disabled",!a),d.cbo_evento_cliente.prop("disabled",!a),d.edt_titulo.prop("readonly",!a),d.tb_convidados.find('[template-button="btn_remover"]').prop("disabled",!a),d.edt_quantidade_diario.prop("disabled",!a),d.edt_quantidade_semanal.prop("disabled",!a),d.chk_mensal_domingo.prop("disabled",!a),d.chk_mensal_segunda.prop("disabled",!a),d.chk_mensal_terca.prop("disabled",!a),d.chk_mensal_quarta.prop("disabled",!a),d.chk_mensal_quinta.prop("disabled",!a),d.chk_mensal_sexta.prop("disabled",!a),d.chk_mensal_sabado.prop("disabled",!a),d.edt_dia_mes.prop("disabled",!a),d.edt_qtde_mes.prop("disabled",!a),d.cbo_numero_da_semana.prop("disabled",!a),d.cbo_dia_semana.prop("disabled",!a),d.edt_mensal_qtde.prop("disabled",!a),d.edt_quantidade_ano.prop("disabled",!a),d.cbo_anual_meses.prop("disabled",!a),d.edt_anual_dia.prop("disabled",!a),d.cbo_anual_numero_da_semana.prop("disabled",!a),d.cbo_anual_dia_semana.prop("disabled",!a),d.cbo_anual_meses2.prop("disabled",!a),d.edt_data_inicial.prop("disabled",!a),d.div_radio_tipo_recorrencia.find("input").prop("disabled",!a),d.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!a),d.edt_horas_recorrencia.prop("disabled",!a),d.div_intervalo_recorrencia.prop("disabled",!a),d.edt_data_final.prop("disabled",!a),d.chk_realizado.prop("disabled",!e&&!a),d.chk_dia_inteiro.prop("disabled",!a),d.edt_evento_notificar_antes.prop("disabled",!a),d.chk_notificar_envolvidos.prop("disabled",!a),a?(d.btn_excluir.show(),d.btn_confirmar.show(),d.div_componente_convidado.removeClass("hidden")):(d.btn_excluir.hide(),e||(d.btn_confirmar.hide(),d.btn_ok.text("Ok")),d.div_componente_convidado.addClass("hidden"));var i=d.cbo_evento_projeto.parent(),o=i.find(".edt_combobox"),n=i.find("button");o.attr("disabled",!a),o.attr("readonly",!a),n.attr("disabled",!a)},this.preencher=function(){WS.get("agenda_evento/objeto/",{agenda_evento_id:d.sel_evento_id},function(a){d.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo,d.agenda_ativo_id=+a.agenda_ativo_id;var e={manutencao_propria_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),manutencao_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),manutencao_agenda_ativo:App.verifica_permissao(App.temp.empresa,"manutencao_agenda_ativo")&&("S"==d.permissao_manutencao_agenda_ativo||"P"==d.permissao_manutencao_agenda_ativo&&+a.insert_usuario_id==App.sessao.dados.usuario_id)},i=App.sessao.dados.admin||!(+d.agenda_ativo_id>0)&&e.manutencao_agenda||!(+d.agenda_ativo_id>0)&&e.manutencao_propria_agenda&&+a.usuario_id>0&&+a.usuario_id==App.sessao.dados.usuario_id||+d.agenda_ativo_id>0&&e.manutencao_agenda_ativo;d.atuacao_efetiva_resultado_esperado_id=a.atuacao_efetiva_resultado_esperado_id,d.competencias_essenciais_resultado_esperado_id=a.competencias_essenciais_resultado_esperado_id,i&&a.agenda_recorrente?parseInt(a.agenda_recorrente.tipo_recorrencia)==TIPO_AGENDA_RECORRENTE.NENHUMA||d.forcar_evento_dia?(d.forcar_evento_dia||(d.tipo_reprogramacao=1),show_modal(d.modal.attr("id"))):(d.evento_possui_recorrencia=!0,View.load("agenda/reprogramar_agenda_recorrente",function(a,e){e.onsave=function(a){d.tipo_reprogramacao=a,e.unload(),show_modal(d.modal.attr("id"))},e.show()})):show_modal(d.modal.attr("id")),d.sel_usuario_id=a.usuario_id,d.arr_usuarios=a.arr_convidados;var o="";if(o=+d.agenda_ativo_id>0?d.usuario_nome||a.agenda_ativo_nome||"":a.usuario_nome,d.title.html(" "+App.lang.gestao_agenda.evento+' <span class="small">'+o+"</span>"),d.permite_alterar(i,d.convidado_evento),a.tipo_atuacao>0)switch(a.tipo_atuacao){case TIPO_RESULTADO.INFORMATIVO:d.div_valor.addClass("hidden"),d.div_percentual.addClass("hidden");break;case TIPO_RESULTADO.PERCENTUAL:d.div_valor.addClass("hidden"),d.div_percentual.removeClass("hidden"),d.edt_percentual_atuacao.removeClass("hidden"),d.edt_percentual_atuacao.val(a.percentual_alcancado_atuacao);break;case TIPO_RESULTADO.VALOR:d.div_valor.removeClass("hidden"),d.div_percentual.addClass("hidden"),d.edt_valor_atuacao.removeClass("hidden"),d.edt_valor_atuacao.val(a.valor_alcancado_atuacao)}else switch(a.tipo_competencia){case TIPO_RESULTADO.INFORMATIVO:d.div_valor.addClass("hidden"),d.div_percentual.addClass("hidden");break;case TIPO_RESULTADO.PERCENTUAL:d.div_valor.addClass("hidden"),d.div_percentual.removeClass("hidden"),d.edt_percentual_competencia.removeClass("hidden"),d.edt_percentual_competencia.val(a.percentual_alcancado_competencia);break;case TIPO_RESULTADO.VALOR:d.div_valor.removeClass("hidden"),d.edt_percentual_competencia.addClass("hidden"),d.edt_valor_competencia.removeClass("hidden"),d.edt_valor_competencia.val(a.valor_alcancado_competencia)}if(0==+a.agenda_ativo_id)i||d.sel_usuario_id==App.sessao.usuario_id&&(d.chk_realizado.prop("disabled",!1),d.btn_confirmar.show(),d.somente_realizado=!0,d.btn_ok.text("Cancelar"));else if(d.menu_convidados.addClass("hidden"),d.menu_responsavel.removeClass("hidden"),!i){var n=!1;try{a.arr_convidados.filter(function(a){return+a.usuario_id==App.sessao.usuario_id}).length>0&&(n=!0)}catch(a){n=!1}n&&(d.chk_realizado.prop("disabled",!1),d.btn_confirmar.show(),d.somente_realizado=!0,d.btn_ok.text("Cancelar"))}d.render_usuarios(a,!0),(d.sel_usuario_id==App.sessao.usuario_id||!0===App.sessao.dados.admin||App.verifica_permissao(App.temp.empresa,"visualizar_historico"))&&(d.lbl_tab_historico.removeClass("hidden"),d.render_historico()),set_datepicker(d.edt_evento_dia,a.dia),null!=a.hora_inicio&&null!=a.hora_fim&&(d.edt_evento_inicio.val(a.hora_inicio.substr(0,5)),d.edt_evento_fim.val(a.hora_fim.substr(0,5))),null!=a.notificar_antes&&d.edt_evento_notificar_antes.val(a.notificar_antes.substr(0,5)),d.chk_dia_inteiro.prop("checked",a.dia_inteiro).change(),d.listar_tipo_agenda(a.agenda_tipo_id),d.listar_local_agenda(a.agenda_local_id),d.evento_projeto_id=a.projeto_id,d.evento_cliente_id=a.cliente_id,d.evento_empresa_id=a.empresa_id,d.evento_prospect_id=a.prospect_id,d.evento_fornecedor_id=a.fornecedor_id,d.projeto_atividade_id=a.projeto_atividade_id,a.cliente_id>0?(d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.CLIENTE,d.div_projeto.removeClass("hidden"),set_value_combobox(d.cbo_evento_tipo,a.cliente_id,a.cliente_nome),d.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_cliente),d.filtros=spread({},d.filtros,{cliente_id:a.cliente_id,cliente_nome:a.cliente_nome,cliente_tipo:"C"})):a.fornecedor_id>0?(d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.FORNECEDOR,set_value_combobox(d.cbo_evento_tipo,a.fornecedor_id,a.fornecedor_nome),d.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_fornecedor),d.filtros=spread({},d.filtros,{cliente_id:a.fornecedor_id,cliente_nome:a.fornecedor_nome,cliente_tipo:"F"})):a.prospect_id>0?(d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.PROSPECT,set_value_combobox(d.cbo_evento_tipo,a.prospect_id,a.prospect_nome),d.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_organizacao),d.filtros=spread({},d.filtros,{cliente_id:a.prospect_id,cliente_nome:a.prospect_nome,cliente_tipo:"O"})):a.empresa_id>0&&(d.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.EMPRESA,set_value_combobox(d.cbo_evento_tipo,a.empresa_id,a.empresa_nome),d.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_empresa),d.filtros=spread({},d.filtros,{cliente_id:a.empresa_id,cliente_nome:a.empresa_nome,cliente_tipo:"E"})),d.renderiza_componentes(),set_value_combobox(d.cbo_evento_projeto,a.projeto_id,a.projeto_nome),a.projeto_id>0?d.div_atividade_projeto.removeClass("hidden"):d.div_atividade_projeto.addClass("hidden"),d.preencher_atividade_projeto([],a.atividade_simplificada),d.evento_projeto_id&&d.listar_atividades_projeto(d.evento_projeto_id),d.edt_titulo.val(a.descricao),set_tinymce(d.edt_evento_descricao,a.descricao_detalhada,d.permite_desabilitar),d.chk_realizado.prop("checked","S"===a.realizado).change(),d.chk_notificar_envolvidos.prop("checked",!0).change(),a.agenda_recorrente?(0==a.agenda_recorrente.tipo_recorrencia?d.div_intervalo_recorrencia_geral.addClass("hidden"):d.div_intervalo_recorrencia_geral.removeClass("hidden"),d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="'+a.agenda_recorrente.tipo_recorrencia+'"]').prop("checked",!0),d.div_diario.find('input[name="opt_radio_diario"][value="'+parseInt(a.agenda_recorrente.diario_tipo_recorrencia)+'"]').prop("checked",!0),d.edt_quantidade_diario.val(a.agenda_recorrente.diario_quantidade_dias),d.edt_quantidade_semanal.val(a.agenda_recorrente.mensal_quantidade_semanas),d.chk_mensal_domingo.prop("checked",a.agenda_recorrente.mensal_domingo),d.chk_mensal_segunda.prop("checked",a.agenda_recorrente.mensal_segunda),d.chk_mensal_terca.prop("checked",a.agenda_recorrente.mensal_terca),d.chk_mensal_quarta.prop("checked",a.agenda_recorrente.mensal_quarta),d.chk_mensal_quinta.prop("checked",a.agenda_recorrente.mensal_quinta),d.chk_mensal_sexta.prop("checked",a.agenda_recorrente.mensal_sexta),d.chk_mensal_sabado.prop("checked",a.agenda_recorrente.mensal_sabado),d.div_mensal.find('input[name="opt_radio_mensal"][value="'+a.agenda_recorrente.mensal_tipo_recorrencia+'"]').prop("checked",!0),d.edt_dia_mes.val(a.agenda_recorrente.mensal_dia),d.edt_qtde_mes.val(a.agenda_recorrente.mensal_quantidade_meses),d.cbo_numero_da_semana.val(a.agenda_recorrente.mensal_numero_da_semana),d.cbo_dia_semana.val(a.agenda_recorrente.mensal_dia_da_semana),d.edt_mensal_qtde.val(a.agenda_recorrente.mensal_quantidade_meses2),d.div_anual.find('input[name="opt_radio_anual"][value="'+a.agenda_recorrente.anual_tipo_recorrencia+'"]').prop("checked",!0),d.edt_quantidade_ano.val(a.agenda_recorrente.anual_quantidade_anos),d.cbo_anual_meses.val(a.agenda_recorrente.anual_mes),d.edt_anual_dia.val(a.agenda_recorrente.anual_dia),d.cbo_anual_numero_da_semana.val(a.agenda_recorrente.anual_numero_da_semana),d.cbo_anual_dia_semana.val(a.agenda_recorrente.anual_dia_da_semana),d.cbo_anual_meses2.val(a.agenda_recorrente.anual_mes2),d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="'+a.agenda_recorrente.intervalo_recorrencia_tipo_termino+'"]').prop("checked",!0),set_datepicker(d.edt_data_inicial,a.agenda_recorrente.intervalo_recorrencia_data_inicial),d.edt_intervalo_recorrencia_quantidade_dias.val(a.agenda_recorrente.intervalo_recorrencia_quantidade_ocorrencias),set_datepicker(d.edt_data_final,a.agenda_recorrente.intervalo_recorrencia_data_termino),d.edt_horas_recorrencia.val(a.agenda_recorrente.intervalo_recorrencia_horas_termino),d.chk_utiliza_calendario_trabalho.prop("checked",a.agenda_recorrente.utiliza_calendario_trabalho),d.chk_utiliza_calendario_trabalho.removeClass("template_switch"),App.aplicar_checkbox(d.div_horas)):d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').prop("checked",!0),d.inicializa_componentes(a),d.div_radio_tipo_recorrencia.change()},[d.btn_confirmar])},this.listar_tipo_agenda=function(a){d.cbo_evento_tipo_agenda.find("option").remove(),add_option(d.cbo_evento_tipo_agenda,"",App.lang.selectpicker.selecionar),WS.get("tipo_agenda/listar/",null,function(e){for(var i=0;i<e.length;i++){var o=e[i];add_option(d.cbo_evento_tipo_agenda,o.tipo_agenda_id,o.nome)}a&&d.cbo_evento_tipo_agenda.val(a).trigger("change"),d.cbo_evento_tipo_agenda.selectpicker("refresh")})},this.listar_local_agenda=function(a){d.cbo_evento_local.find("option").remove(),add_option(d.cbo_evento_local,"",App.lang.selectpicker.selecionar),WS.get("local_agenda/listar/",null,function(e){for(var i=0;i<e.data.length;i++){var o=e.data[i];add_option(d.cbo_evento_local,o.id,o.nome)}a&&d.cbo_evento_local.val(a).trigger("change"),d.cbo_evento_local.selectpicker("refresh")})},this.function_select_projeto=function(a){d.evento_projeto_id!=a.id&&(d.projeto_atividade_id=null),d.evento_projeto_id=a.id,a.id>0?(d.div_atividade_projeto.removeClass("hidden"),d.listar_atividades_projeto(a.id)):d.div_atividade_projeto.addClass("hidden")},this.listar_projeto=function(a){var e=d.cbo_evento_projeto.parent().find(".edt_combobox");WS.get("projeto/listar/",{cliente_id:d.evento_cliente_id,nome:e.val(),ignorar_concluidos:!0,limite:0},function(e){if(limpar_combobox(d.cbo_evento_projeto),e.length){for(var i=0;i<e.length;i++){var o=e[i],n=[];n.Nome=o.nome,add_option_combobox(d.cbo_evento_projeto,i,o.id>0?o.id:null,n,null,JSON.stringify(o))}a(!0)}$(d.cbo_evento_projeto.parent()).find(".ul_row").click(function(){var a=$(this).parent().attr("dados-adicionais")?JSON.parse($(this).parent().attr("dados-adicionais")):null;d.function_select_projeto(a)}),d.cbo_evento_projeto.parent().find(".edt_combobox").keypress(function(a){if(13==a.keyCode){var e=$(this).attr("dados-adicionais")?JSON.parse($(this).attr("dados-adicionais")):null;d.function_select_projeto(e)}})}),e.keyup(function(a){$(this).val()||d.function_select_projeto({})})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){d.unload()}),this.btn_confirmar.unbind("click"),this.btn_confirmar.click(function(){if(d.emails_acompanhamento=d.grid_emails_acompanhamento.getDataSource().store()._array.map(function(a,e){return a.email}),t(d.edt_horas_recorrencia.val())&&t(d.edt_evento_inicio.val())&&t(d.edt_evento_fim.val())&&_(d.edt_evento_inicio.val(),d.edt_evento_fim.val())){var a={tipo_recorrencia:d.div_radio_tipo_recorrencia.find(":checked").val()>0?d.div_radio_tipo_recorrencia.find(":checked").val():"",diario_tipo_recorrencia:d.div_diario.find(":checked").val()>0?d.div_diario.find(":checked").val():"",diario_quantidade_dias:d.edt_quantidade_diario.val(),mensal_quantidade_semanas:d.edt_quantidade_semanal.val(),mensal_domingo:d.chk_mensal_domingo.prop("checked"),mensal_segunda:d.chk_mensal_segunda.prop("checked"),mensal_terca:d.chk_mensal_terca.prop("checked"),mensal_quarta:d.chk_mensal_quarta.prop("checked"),mensal_quinta:d.chk_mensal_quinta.prop("checked"),mensal_sexta:d.chk_mensal_sexta.prop("checked"),mensal_sabado:d.chk_mensal_sabado.prop("checked"),mensal_tipo_recorrencia:d.div_mensal.find('input[name="opt_radio_mensal"]:checked').val()>0?d.div_mensal.find('input[name="opt_radio_mensal"]:checked').val():"",mensal_dia:d.edt_dia_mes.val(),mensal_quantidade_meses:d.edt_qtde_mes.val(),mensal_numero_da_semana:d.cbo_numero_da_semana.val(),mensal_dia_da_semana:d.cbo_dia_semana.val(),mensal_quantidade_meses2:d.edt_mensal_qtde.val(),anual_tipo_recorrencia:d.div_anual.find('input[name="opt_radio_anual"]:checked').val()>0?d.div_anual.find('input[name="opt_radio_anual"]:checked').val():"",anual_quantidade_anos:d.edt_quantidade_ano.val(),anual_mes:d.cbo_anual_meses.val(),anual_dia:d.edt_anual_dia.val(),anual_numero_da_semana:d.cbo_anual_numero_da_semana.val(),anual_dia_da_semana:d.cbo_anual_dia_semana.val(),anual_mes2:d.cbo_anual_meses2.val(),intervalo_recorrencia_data_inicial:get_datepicker(d.edt_data_inicial),intervalo_recorrencia_tipo_termino:d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val()>0?d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val():"",intervalo_recorrencia_quantidade_ocorrencias:d.edt_intervalo_recorrencia_quantidade_dias.val(),intervalo_recorrencia_data_termino:get_datepicker(d.edt_data_final),intervalo_recorrencia_horas_termino:d.edt_horas_recorrencia.val(),utiliza_calendario_trabalho:d.chk_utiliza_calendario_trabalho.prop("checked")},e={agenda_evento_id:d.sel_evento_id,usuario_id:d.sel_usuario_id,dia:get_datepicker(d.edt_evento_dia),hora_inicio:!0!==d.chk_dia_inteiro.prop("checked")?d.edt_evento_inicio.val():"00:00",hora_fim:!0!==d.chk_dia_inteiro.prop("checked")?d.edt_evento_fim.val():"23:59",notificar_antes:!0!==d.chk_dia_inteiro.prop("checked")?d.edt_evento_notificar_antes.val():"00:00",agenda_tipo_id:d.cbo_evento_tipo_agenda.val(),descricao:d.edt_titulo.val(),descricao_detalhada:get_tinymce(d.edt_evento_descricao),agenda_recorrente:a,tipo_reprogramacao:d.tipo_reprogramacao,arr_convidados:JSON.stringify(d.arr_usuarios),realizado:d.chk_realizado.bootstrapSwitch("state"),agenda_ativo_id:d.agenda_ativo_id,calendario_trabalho_id:d.calendario_trabalho_id,valor_alcancado_atuacao:d.edt_valor_atuacao.maskMoney("unmasked")[0],valor_alcancado_competencia:d.edt_valor_competencia.maskMoney("unmasked")[0],percentual_alcancado_atuacao:d.edt_percentual_atuacao.val(),percentual_alcancado_competencia:d.edt_percentual_competencia.val(),atuacao_efetiva_resultado_esperado_id:d.atuacao_efetiva_resultado_esperado_id,competencias_essenciais_resultado_esperado_id:d.competencias_essenciais_resultado_esperado_id,convidado_evento:d.convidado_evento,evento_pessoal:d.evento_pessoal,dia_inteiro:d.chk_dia_inteiro.prop("checked"),emails_acompanhamento:JSON.stringify(d.emails_acompanhamento),notificar_envolvidos:d.chk_notificar_envolvidos.bootstrapSwitch("state"),agenda_local_id:d.evento_pessoal?null:d.cbo_evento_local.val(),cliente_id:d.evento_pessoal?null:d.evento_cliente_id,projeto_id:d.evento_pessoal?null:d.evento_projeto_id,projeto_atividade_id:d.evento_pessoal?null:d.div_componente_atividades.find(".div_listagem_atividade_projeto").attr("id"),fornecedor_id:d.evento_pessoal?null:d.evento_fornecedor_id,prospect_id:d.evento_pessoal?null:d.evento_prospect_id,empresa_id:d.evento_pessoal?null:d.evento_empresa_id},i=function(a){var i=App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),o=App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),n=function(e){WS.post({route:"agenda_evento/salvar",type:"POST",data:e,func_response:function(e){void 0!==d.onsave&&d.onsave&&d.onsave(),void 0!==a&&null!=a&&a(e)},func_fail:function(a){d.btn_confirmar.removeClass("disabled").removeAttr("disabled"),d.btn_cancelar.removeClass("disabled").removeAttr("disabled")},disable_buttons:[d.btn_confirmar,d.btn_excluir]})};!d.convidado_evento||i||o?WS.get("agenda_ativo/get_parametros/",null,function(a){0==a.eventos_simultaneos?WS.get("agenda_evento/validar_agenda_ativo/",{agenda_evento_id:e.agenda_evento_id,agenda_ativo_id:e.agenda_ativo_id,hora_inicio:e.hora_inicio,hora_fim:e.hora_fim,dia:e.dia},function(a){1==a?alert_modal("Agenda ativo","Este ativo não está disponível no horário selecionado, por favor, escolha outro horário.","Ok",function(){}):n(e)}):WS.get("agenda_evento/validar_agenda_ativo/",{agenda_evento_id:e.agenda_evento_id,agenda_ativo_id:e.agenda_ativo_id,hora_inicio:e.hora_inicio,hora_fim:e.hora_fim,dia:e.dia},function(a){1==a?alert_modal("Agenda ativo","Este ativo não está disponível no horário selecionado, Deseja continuar?","Sim",function(){n(e)},!0,"Não",function(){}):n(e)})}):n(e)},o=function(){if(d.somente_realizado||a.tipo_recorrencia==TIPO_AGENDA_RECORRENTE.NENHUMA||(!d.evento_possui_recorrencia||e.tipo_reprogramacao==TIPO_REPROGRAMACAO.SOMENTE)&&d.evento_possui_recorrencia)i(function(){d.btn_confirmar.addClass("disabled").attr("disabled","true"),d.btn_cancelar.addClass("disabled").attr("disabled","true"),d.unload()});else if(d.valida_tipo_recorrencia()&&d.valida_intervalo_recorrencia()){var o=function(a){d.btn_confirmar.addClass("disabled").attr("disabled","true"),d.btn_cancelar.addClass("disabled").attr("disabled","true"),View.load("agenda/confirmar_recorrencia",function(i,o){var n={usuario_id:d.sel_usuario_id,agenda_recorrente_id:a.agenda_recorrente.id,agenda_ativo_id:a.agenda_ativo_id,agenda_evento_origem_id:a.id,tipo_reprogramacao:e.tipo_reprogramacao,dia_evento:d.dia_evento,hora_inicio:!0!==d.chk_dia_inteiro.prop("checked")?d.edt_evento_inicio.val():"00:00",hora_fim:!0!==d.chk_dia_inteiro.prop("checked")?d.edt_evento_fim.val():"23:59"};o.onclose=function(){d.unload()},o.show(n)})};d.evento_id?alert_modal("Alterar recorrência","Tem certeza que deseja aplicar estas alterações nessa recorrência? Esta ação não poderá ser desfeita","Aplicar",function(){i(o)},!0,"Cancelar",function(){}):i(o)}};new Validation,d.somente_realizado?o():WS.post("agenda_evento/validar_evento_agenda/",e,function(a){if(a)if(!1===d.chk_realizado.prop("checked")){var e=new Validation;e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,App.lang.modal_validacao.evento_agenda_data_horario)),alert_modal(App.lang.modal_validacao.validacao,e,App.lang.modal_validacao.sim,function(){o()},!0,App.lang.modal_validacao.nao,null,function(){d.btn_confirmar.removeClass("disabled").removeAttr("disabled"),d.btn_cancelar.removeClass("disabled").removeAttr("disabled")})}else o();else o()},[d.btn_confirmar,d.btn_excluir])}}),this.validar_convidado=function(a){d.tbl_agenda_usuario.addClass("hidden");var e={tipo_recorrencia:d.div_radio_tipo_recorrencia.find(":checked").val()>0?d.div_radio_tipo_recorrencia.find(":checked").val():"",diario_tipo_recorrencia:d.div_diario.find(":checked").val()>0?d.div_diario.find(":checked").val():"",diario_quantidade_dias:d.edt_quantidade_diario.val(),mensal_quantidade_semanas:d.edt_quantidade_semanal.val(),mensal_domingo:d.chk_mensal_domingo.prop("checked"),mensal_segunda:d.chk_mensal_segunda.prop("checked"),mensal_terca:d.chk_mensal_terca.prop("checked"),mensal_quarta:d.chk_mensal_quarta.prop("checked"),mensal_quinta:d.chk_mensal_quinta.prop("checked"),mensal_sexta:d.chk_mensal_sexta.prop("checked"),mensal_sabado:d.chk_mensal_sabado.prop("checked"),mensal_tipo_recorrencia:d.div_mensal.find('input[name="opt_radio_mensal"]:checked').val()>0?d.div_mensal.find('input[name="opt_radio_mensal"]:checked').val():"",mensal_dia:d.edt_dia_mes.val(),mensal_quantidade_meses:d.edt_qtde_mes.val(),mensal_numero_da_semana:d.cbo_numero_da_semana.val(),mensal_dia_da_semana:d.cbo_dia_semana.val(),mensal_quantidade_meses2:d.edt_mensal_qtde.val(),anual_tipo_recorrencia:d.div_anual.find('input[name="opt_radio_anual"]:checked').val()>0?d.div_anual.find('input[name="opt_radio_anual"]:checked').val():"",anual_quantidade_anos:d.edt_quantidade_ano.val(),anual_mes:d.cbo_anual_meses.val(),anual_dia:d.edt_anual_dia.val(),anual_numero_da_semana:d.cbo_anual_numero_da_semana.val(),anual_dia_da_semana:d.cbo_anual_dia_semana.val(),anual_mes2:d.cbo_anual_meses2.val(),intervalo_recorrencia_data_inicial:get_datepicker(d.edt_data_inicial),intervalo_recorrencia_tipo_termino:d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val()>0?d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val():"",intervalo_recorrencia_quantidade_ocorrencias:d.edt_intervalo_recorrencia_quantidade_dias.val(),intervalo_recorrencia_data_termino:get_datepicker(d.edt_data_final),intervalo_recorrencia_horas_termino:d.edt_horas_recorrencia.val(),utiliza_calendario_trabalho:d.chk_utiliza_calendario_trabalho.prop("checked")},i={agenda_evento_id:d.sel_evento_id,usuario_id:a.usuario_id,dia:get_datepicker(d.edt_evento_dia),hora_inicio:d.edt_evento_inicio.val(),hora_fim:d.edt_evento_fim.val(),agenda_tipo_id:d.cbo_evento_tipo_agenda.val(),agenda_local_id:d.cbo_evento_local.val(),cliente_id:d.evento_cliente_id,projeto_id:d.cbo_evento_projeto.val(),descricao:d.edt_evento_descricao.val(),descricao_detalhada:get_tinymce(d.edt_evento_descricao),projeto_atividade_id:d.div_componente_atividades.find(".div_listagem_atividade_projeto").attr("id"),fornecedor_id:d.evento_fornecedor_id,prospect_id:d.evento_prospect_id,empresa_id:d.evento_empresa_id,agenda_recorrente:e,tipo_reprogramacao:d.tipo_reprogramacao,arr_convidados:JSON.stringify(d.arr_usuarios),evento_pessoal:d.evento_pessoal,ignorar_validacao:!0};WS.post("agenda_evento/validar_evento_agenda/",i,function(e){e?View.load("agenda/modal_info",function(e,i){i.show(get_datepicker(d.edt_evento_dia),JSON.stringify([a.usuario_id])),i.onclose=function(e){e&&d.render_usuarios(a,!0)}}):d.render_usuarios(a,!0)})},this.preencher_atividade_projeto=function(a,i){e.render(d.ListarAtividadeProjeto,d.div_componente_atividades[0]),d.ListarAtividadeProjeto.props.setParams({div:d.div_componente_atividades,html_id:d.html_id,data:a,dialog:d.dialog,dropdown:!0,dropdown_disabled:d.permite_desabilitar,somente_leitura:!0,atividade_selecionada:i,parametro_usuario:"atividade_projeto_agenda"})},this.listar_atividades_projeto=function(a){WS.get({route:"atividade_projeto/listar/",data:{projeto_id:a},func_response:function(a){a.atividades.push({atividade_simplificada:a.projeto.nome,id:"raiz",projeto_atividade_sintetica_pai_id:null,tipo_atividade:"P",marco:!1,horas_previstas:"000:00"}),d.preencher_atividade_projeto(a,d.projeto_atividade_id)},html_id:d.html_id})},this.aba_historico.unbind("scroll"),this.aba_historico.scroll(function(){d.aba_historico.scrollTop()+d.aba_historico.height()==d.aba_historico.get(0).scrollHeight&&(d.div_load.removeClass("hidden"),d.limite=d.limite+50,d.render_historico())}),this.btn_excluir.unbind("click"),this.btn_excluir.click(function(){var a={agenda_evento_id:d.sel_evento_id,tipo_reprogramacao:d.tipo_reprogramacao};WS.post("agenda_evento/excluir",a,function(a){void 0!==d.onsave&&d.onsave&&d.onsave(),alert_saved(App.lang.alert_saved.agenda_evento+a.id+App.lang.alert_saved.excluido),d.unload()})}),this.div_radio_tipo_recorrencia.unbind("change"),this.div_radio_tipo_recorrencia.change(function(){switch(d.div_diario.addClass("hidden"),d.div_semanal.addClass("hidden"),d.div_mensal.addClass("hidden"),d.div_anual.addClass("hidden"),parseInt(d.div_radio_tipo_recorrencia.find(":checked").val())){case TIPO_AGENDA_RECORRENTE.NENHUMA:break;case TIPO_AGENDA_RECORRENTE.DIARIO:d.div_diario.removeClass("hidden"),void 0===d.div_diario.find('input[name="opt_radio_diario"]').val()&&d.div_diario.find('input[name="opt_radio_diario"][value="1"]').prop("checked",!0);break;case TIPO_AGENDA_RECORRENTE.SEMANAL:d.div_semanal.removeClass("hidden");break;case TIPO_AGENDA_RECORRENTE.MENSAL:d.div_mensal.removeClass("hidden"),void 0===d.div_mensal.find('input[name="opt_radio_mensal"]').val()&&d.div_mensal.find('input[name="opt_radio_mensal"][value="1"]').prop("checked",!0);break;case TIPO_AGENDA_RECORRENTE.ANUAL:d.div_anual.removeClass("hidden"),void 0===d.div_anual.find('input[name="opt_radio_anual"]').val()&&d.div_anual.find('input[name="opt_radio_anual"][value="1"]').prop("checked",!0)}}),this.cbo_evento_tipo_agenda.unbind("change").change(function(){WS.get("tipo_agenda/objeto/",{tipo_agenda_id:$(this).val()},function(a){"S"==a.particular||1==a.particular?(d.div_local_agenda.hide(),d.div_dados_projeto.hide(),d.evento_pessoal=!0):(d.div_local_agenda.show(),d.div_dados_projeto.show(),d.evento_pessoal=!1),a.notificar_antes&&(+d.evento_tipo_agenda_id>0||d.evento_id&&0==+d.evento_id.evento_id)&&(""!==d.edt_evento_notificar_antes.val()&&a.notificar_antes.substr(0,5)!==d.edt_evento_notificar_antes.val()?DevExpress.ui.dialog.confirm("Deseja definir a notificação para "+a.notificar_antes.substr(0,5)+" antes do evento?","Notificar Antes").done(function(e){e&&d.edt_evento_notificar_antes.val(a.notificar_antes?a.notificar_antes.substr(0,5):"")}):d.edt_evento_notificar_antes.val(a.notificar_antes?a.notificar_antes.substr(0,5):"")),d.evento_tipo_agenda_id=a.id},[d.btn_confirmar,d.btn_excluir])}),this.exibir_edt_hora=function(){1==d.chk_dia_inteiro.prop("checked")?(d.div_evento_inicio.hide(),d.div_evento_fim.hide(),d.edt_evento_inicio.hide(),d.edt_evento_fim.hide(),d.div_evento_notificar_antes.hide(),d.edt_evento_notificar_antes.hide()):(d.div_evento_inicio.show(),d.div_evento_fim.show(),d.edt_evento_inicio.show(),d.edt_evento_fim.show(),d.div_evento_notificar_antes.show(),d.edt_evento_notificar_antes.show())},this.chk_dia_inteiro.unbind("change").change(function(){d.exibir_edt_hora()});var t=function(a){var e=new Validation,i=a.split(":"),o=i[1];if(i.length,o>59||a.length>0&&6!=a.length&&5!=a.length)return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" inválido!')),alert_modal(App.lang.modal_validacao.validacao,e),!1;if(a.length>5){if(a>"838:59")return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" deve ser menor que 838:59 horas!')),alert_modal(App.lang.modal_validacao.validacao,e),!1}else if(a>="24:00")return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" deve ser menor que 24:00 horas!')),alert_modal(App.lang.modal_validacao.validacao,e),!1;return!0},_=function(a,e){var i=new Validation;return""==a||""==e?(i.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Preencha a Hora Inicial e/ou Hora Final")),alert_modal(App.lang.modal_validacao.validacao,i),!1):!(a>e&&(i.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"A hora inicial não deve ser maior que a hora final")),alert_modal(App.lang.modal_validacao.validacao,i),1))};this.inicializa_componentes=function(a){a.agenda_recorrente&&(null!=d.evento_id?void 0!==a&&"0"!=a.agenda_recorrente.tipo_recorrencia&&(d.valida_componentes("opt_radio_diario",a.agenda_recorrente.diario_tipo_recorrencia),d.valida_componentes("opt_radio_mensal",a.agenda_recorrente.mensal_tipo_recorrencia),d.valida_componentes("opt_radio_anual",a.agenda_recorrente.anual_tipo_recorrencia),d.valida_componentes("opt_tipo_intervalo_recorrencia",a.agenda_recorrente.intervalo_recorrencia_tipo_termino)):(d.edt_quantidade_diario.prop("disabled",!0),d.edt_quantidade_diario.prop("disabled",!0),d.edt_quantidade_diario.prop("disabled",!0)))},this.valida_componentes=function(a,e){switch(a){case"opt_radio_diario":"1"==e?(d.edt_quantidade_diario.prop("disabled",!1),d.edt_quantidade_diario.focus()):(d.edt_quantidade_diario.prop("disabled",!0),d.edt_quantidade_diario.val("").change());break;case"opt_radio_mensal":"1"==e?(d.edt_dia_mes.prop("disabled",!1),d.edt_qtde_mes.prop("disabled",!1),d.edt_dia_mes.focus(),d.cbo_numero_da_semana.prop("disabled",!0),d.cbo_dia_semana.prop("disabled",!0),d.edt_mensal_qtde.val(""),d.edt_mensal_qtde.prop("disabled",!0)):"2"==e&&(d.edt_dia_mes.val(""),d.edt_qtde_mes.val(""),d.edt_dia_mes.prop("disabled",!0),d.edt_qtde_mes.prop("disabled",!0),d.cbo_numero_da_semana.prop("disabled",!1),d.cbo_dia_semana.prop("disabled",!1),d.edt_mensal_qtde.prop("disabled",!1));break;case"opt_radio_anual":"1"==e?(d.edt_quantidade_ano.prop("disabled",!1),d.edt_quantidade_ano.focus(),d.cbo_anual_meses.prop("disabled",!0),d.edt_anual_dia.prop("disabled",!0),d.edt_anual_dia.val(""),d.cbo_anual_numero_da_semana.prop("disabled",!0),d.cbo_anual_dia_semana.prop("disabled",!0),d.cbo_anual_meses2.prop("disabled",!0)):"2"==e?(d.edt_quantidade_ano.prop("disabled",!0),d.edt_quantidade_ano.val(""),d.cbo_anual_meses.prop("disabled",!1),d.edt_anual_dia.prop("disabled",!1),d.cbo_anual_numero_da_semana.prop("disabled",!0),d.cbo_anual_dia_semana.prop("disabled",!0),d.cbo_anual_meses2.prop("disabled",!0)):(d.edt_quantidade_ano.prop("disabled",!0),d.edt_quantidade_ano.val(""),d.cbo_anual_meses.prop("disabled",!0),d.edt_anual_dia.prop("disabled",!0),d.edt_anual_dia.val(""),d.cbo_anual_numero_da_semana.prop("disabled",!1),d.cbo_anual_dia_semana.prop("disabled",!1),d.cbo_anual_meses2.prop("disabled",!1));break;case"opt_tipo_intervalo_recorrencia":"1"==e?(d.edt_data_final.prop("disabled",!0),d.edt_horas_recorrencia.prop("disabled",!0),d.chk_utiliza_calendario_trabalho.prop("disabled")||(d.chk_utiliza_calendario_trabalho.prop("checked",!1).change(),d.chk_utiliza_calendario_trabalho.prop("disabled",!0)),d.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!1),d.edt_intervalo_recorrencia_quantidade_dias.focus()):"2"==e?(d.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!0),d.edt_intervalo_recorrencia_quantidade_dias.val("").change(),d.edt_horas_recorrencia.prop("disabled",!0),d.edt_horas_recorrencia.val("").change(),d.chk_utiliza_calendario_trabalho.prop("disabled")||(d.chk_utiliza_calendario_trabalho.prop("checked",!1).change(),d.chk_utiliza_calendario_trabalho.prop("disabled",!0)),d.edt_data_final.prop("disabled",!1),d.edt_data_final.focus()):(d.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!0),d.edt_intervalo_recorrencia_quantidade_dias.val("").change(),d.edt_data_final.prop("disabled",!0),d.edt_horas_recorrencia.prop("disabled",!1),d.chk_utiliza_calendario_trabalho.prop("disabled",!1),d.edt_horas_recorrencia.focus())}},this.valida_tipo_recorrencia=function(){var a=new Validation;if(d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').is(":checked"))d.div_intervalo_recorrencia_geral.addClass("hidden");else if(d.div_intervalo_recorrencia_geral.removeClass("hidden"),d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="1"]').is(":checked")){if(!d.div_diario.find('input[name="opt_radio_diario"][value="1"]').is(":checked")&&!d.div_diario.find('input[name="opt_radio_diario"][value="2"]').is(":checked"))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a periodicidade da recorrência da agenda")),alert_modal(App.lang.modal_validacao.validacao,a),d.div_diario.find('input[name="opt_radio_diario"][value="1"]').prop("checked",!0),setTimeout(function(){d.edt_quantidade_diario.focus()},2e3),!1;if(d.div_diario.find('input[name="opt_radio_diario"][value="1"]').is(":checked")&&""==d.edt_quantidade_diario.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de dias para recorrência")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){d.edt_quantidade_diario.focus()},2e3),!1}else if(d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="2"]').is(":checked")){if(!(""!=d.edt_quantidade_semanal.val()&&parseInt(d.edt_quantidade_semanal.val(),10)>0))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de semanas para recorrência")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){d.edt_quantidade_semanal.focus()},2e3),!1;if(!d.semana_selecionada())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe ao menos um dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="3"]').is(":checked"))if(d.div_mensal.find('input[name="opt_radio_mensal"][value="1"]').is(":checked")){if(""==d.edt_dia_mes.val()||d.edt_dia_mes.val()<1&&d.edt_dia_mes.val()>31)return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"O dia informado deve estar entre 1 e 31.")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){d.edt_quantidade_diario.focus()},2e3),!1}else{if(""==d.edt_mensal_qtde.val()&&d.edt_mensal_qtde.val()<"1")return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de mês(meses).")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==d.cbo_numero_da_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==d.cbo_dia_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="4"]').is(":checked"))if(d.div_anual.find('input[name="opt_radio_anual"][value="1"]').is(":checked")){if(""==d.edt_quantidade_ano.val()&&d.edt_quantidade_ano.val()<"1")return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de ano(s).")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(d.div_diario.find('input[name="opt_radio_anual"][value="2"]').is(":checked")){if(""==d.cbo_anual_meses.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==d.edt_anual_dia.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else{if(""==d.cbo_anual_numero_da_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==d.cbo_anual_dia_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==d.cbo_anual_meses2.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}return!0},this.semana_selecionada=function(){return!!(d.div_chk_semanal.find(".chk_mensal_domingo").is(":checked")||d.div_chk_semanal.find(".chk_mensal_segunda").is(":checked")||d.div_chk_semanal.find(".chk_mensal_terca").is(":checked")||d.div_chk_semanal.find(".chk_mensal_quarta").is(":checked")||d.div_chk_semanal.find(".chk_mensal_quinta").is(":checked")||d.div_chk_semanal.find(".chk_mensal_sexta").is(":checked")||d.div_chk_semanal.find(".chk_mensal_sabado").is(":checked"))},this.valida_intervalo_recorrencia=function(){var a=new Validation;if(!d.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').is(":checked")){if(!(d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="1"]').is(":checked")||d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="2"]').is(":checked")||d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="3"]').is(":checked")))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Selecione ao menos uma opção para término da recorrência.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="1"]').is(":checked")){if(""==d.edt_intervalo_recorrencia_quantidade_dias.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Termina após".')),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(d.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="2"]').is(":checked")){if(""==get_datepicker(d.edt_data_final))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Termina dia".')),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(get_datepicker(d.edt_data_final)<get_datepicker(d.edt_data_inicial))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"A data de término não pode ser menor que a data de início")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(""==d.edt_horas_recorrencia.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Horas".')),alert_modal(App.lang.modal_validacao.validacao,a),!1}return!0},this.listar_feriados=function(){WS.get("feriado/listar/",null,function(a){a.length>0&&(d.arr_feriados=a,d.edt_evento_dia.trigger("change"))})},this.edt_evento_dia.on("change",function(){d.arr_feriados.length>0&&d.arr_feriados.forEach(function(a,e){d.edt_evento_dia.val()==a.data_feriado?d.div_info_feriado.show():d.div_info_feriado.hide()})}),d.div_info_feriado.on("click",function(){View.load("agenda/modal_info",function(a,e){e.show(null,null,!0,d.arr_feriados.filter(function(a){return a.data_feriado==d.edt_evento_dia.val()}))})}),this.edt_quantidade_diario.keyup(function(){somenteNumeros(this.value,this)}),this.edt_intervalo_recorrencia_quantidade_dias.keyup(function(){somenteNumeros(this.value,this)}),this.edt_quantidade_semanal.keyup(function(){somenteNumeros(this.value,this)}),this.edt_dia_mes.keyup(function(){somenteNumeros(this.value,this)}),this.edt_qtde_mes.keyup(function(){somenteNumeros(this.value,this)}),this.edt_mensal_qtde.keyup(function(){somenteNumeros(this.value,this)}),this.edt_quantidade_ano.keyup(function(){somenteNumeros(this.value,this)}),this.edt_anual_dia.keyup(function(){somenteNumeros(this.value,this)}),this.opt_radio_diario.unbind("click"),this.opt_radio_diario.click(function(){d.valida_componentes("opt_radio_diario",$(this).val())}),this.opt_tipo_intervalo_recorrencia.unbind("click"),this.opt_tipo_intervalo_recorrencia.click(function(){d.valida_componentes("opt_tipo_intervalo_recorrencia",$(this).val())}),this.opt_radio_tipo_recorrencia.unbind("click"),this.opt_radio_tipo_recorrencia.click(function(){"2"==$(this).val()?(setTimeout(function(){d.edt_quantidade_semanal.focus()},900),d.div_intervalo_recorrencia_geral.removeClass("hidden")):"0"==$(this).val()?d.div_intervalo_recorrencia_geral.addClass("hidden"):d.div_intervalo_recorrencia_geral.removeClass("hidden")}),this.opt_radio_mensal.unbind("click"),this.opt_radio_mensal.click(function(){d.valida_componentes("opt_radio_mensal",$(this).val())}),this.opt_radio_anual.unbind("click"),this.opt_radio_anual.click(function(){d.valida_componentes("opt_radio_anual",$(this).val())})}});