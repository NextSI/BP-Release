define([],function(){return function(i){"use strict";var o=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.tab_listagem=this.dialog.find(".tab_listagem"),this.txt_info_filtro_processos=this.dialog.find(".txt_info_filtro_processos"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_novo=this.dialog.find(".btn_novo"),this.codigo_tela=null,this.formulario_personalizado_id=null,this.show=function(i,t){i==TELAS.LISTAGEM_SOLICITACAO.codigo&&o.txt_info_filtro_processos.show(),o.codigo_tela=i,o.formulario_personalizado_id=t,o.listar(),show_modal(o.modal.attr("id"))},this.listar=function(){var i=o.tab_listagem.find("tbody"),t=i.find("[template-row]");WS.get("filtro_usuario/listar/",{codigo_tela:o.codigo_tela},function(a){o.tab_listagem.find(".rows").remove(),$(a).each(function(a,l){!function(a,l){var e=t.clone();e.removeAttr("template-row"),e.css("display",""),e.addClass("rows");var n=$(e.find('[template-field="ativo-tooltip"]')),s=$(e.find('[template-field="ativo"]'));s.removeClass("template_switch"),"S"===l.ativo||"S"===l.ativo_permanentemente?s.prop("checked",!0).trigger("change"):s.prop("checked",!1).trigger("change"),"S"==l.ativo_permanentemente&&(s.prop("disabled",!0),n.attr("title",'Executar sempre esse filtro. Para desativa-lo clique em "Editar" '),n.tooltip()),s.on("change",function(i){var o=this;WS.post("filtro_usuario/salvar",{filtro_usuario_id:l.filtro_usuario_id,descricao:l.descricao,codigo_tela:l.codigo_tela,condicao_consulta:l.condicao_consulta,ativo:$(this).prop("checked"),ativo_permanentemente:"S"==l.ativo_permanentemente,valor:l.valor,tipo_valor:l.tipo_valor,operador:l.operador,campo_id:l.campo_id,campo_tipo:l.campo_tipo},function(i){alert_saved(1==$(o).prop("checked")?"Filtro Ativo":"Filtro desativado")})}),App.aplicar_checkbox(n),$(e.find('[template-field="descricao"]')).text(l.descricao);var r=$(e.find(".btn_editar"));r.unbind("click"),r.click(function(){View.load("filtro_usuario/detalhes",function(i,t){t.onclose=o.listar,t.show(l.filtro_usuario_id,FORMULARIO.EDITAR,o.codigo_tela,o.formulario_personalizado_id)})});var d=$(e.find(".btn_visualizar"));d.unbind("click"),d.click(function(){View.load("filtro_usuario/detalhes",function(i,t){t.onclose=o.listar,t.show(l.filtro_usuario_id,FORMULARIO.VISUALIZAR,o.codigo_tela,o.formulario_personalizado_id)})});var c=$(e.find(".btn_excluir"));c.unbind("click"),c.click(function(){View.load("filtro_usuario/detalhes",function(i,t){t.onclose=o.listar,t.show(l.filtro_usuario_id,FORMULARIO.EXCLUIR,o.codigo_tela,o.formulario_personalizado_id)})}),e.dblclick(function(){View.load("filtro_usuario/detalhes",function(i,t){t.onclose=o.listar,t.show(l.filtro_usuario_id,FORMULARIO.EDITAR,o.codigo_tela,o.formulario_personalizado_id)})}),e.appendTo(i)}(0,l)})})},this.close=function(){close_modal(o.modal.attr("id")),void 0!==o.onclose&&o.onclose&&o.onclose()},this.unload=function(){o.close(),View.unload(this.html_id)},this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("filtro_usuario/detalhes",function(i,t){t.onclose=o.listar,t.show(null,FORMULARIO.NOVO,o.codigo_tela,o.formulario_personalizado_id)})}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){o.unload()})}});