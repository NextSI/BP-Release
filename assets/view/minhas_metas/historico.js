define([],function(){return function(a){"use strict";var t=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.modal_body=this.dialog.find(".modal-body"),this.tab_listagem=this.dialog.find(".tab_listagem"),this.atuacao_efetiva_resultado_esperado_id=null,this.competencias_essenciais_resultado_esperado_id=null,this.tipo=null,this.table_body=t.tab_listagem.find("tbody"),this.template_row=this.table_body.find("tr:first"),this.show=function(a){var e="";"competencia"==a.tipo?e="Histórico Ações - Competência Essencial":"atuacao"==a.tipo&&(e="Histórico Ações - Atuação Efetitva"),t.title.text(e),t.atuacao_efetiva_resultado_esperado_id=a.atuacao_efetiva_resultado_esperado_id,t.competencias_essenciais_resultado_esperado_id=a.competencias_essenciais_resultado_esperado_id,t.tipo=a.tipo,t.listar_acoes(),show_modal(t.modal.attr("id"))},this.listar_acoes=function(){var a="",e={};"atuacao"==t.tipo?(a="/atuacao_efetiva_resultado_esperado/historico/",e.atuacao_efetiva_resultado_esperado_id=t.atuacao_efetiva_resultado_esperado_id):"competencia"==t.tipo&&(a="/competencias_essenciais_resultado_esperado/historico/",e.competencias_essenciais_resultado_esperado_id=t.competencias_essenciais_resultado_esperado_id),WS.get(a,e,function(a){$(t.table_body).find("tr").not("[template-row]"),$.each(a,function(a,e){t.add_row(e)})})},this.add_row=function(a){var e=t.template_row.clone();e.removeAttr("template-row"),e.css({display:"",cursor:"default"});var i=$(e.find("[template-field='valor']")),o=$(e.find("[template-field='valor_atual']")),s=$(e.find("[template-field='data_alteracao']")),l=$(e.find("[template-field='usuario']")),d=a.valor,n=0;switch(+a.tipo){case TIPO_OBJETIVO.INFORMATIVO:d=" Informativo",n=" Informativo";break;case TIPO_OBJETIVO.VALOR:d="R$ "+(d=a.valor.format_number(2,!0)),n="R$ "+(n=a.valor_alcancado?a.valor_alcancado.format_number(2,!0):"0");break;case TIPO_OBJETIVO.PERCENTUAL:d=a.valor.format_number(),d+="%",n=a.percentual_alcancado?a.percentual_alcancado.format_number():"0",n+="%"}l.text(a.nome_usuario),i.text(d),o.text(n||0),s.text(a.data_alteracao?a.data_alteracao.format_date_time():""),e.appendTo(t.table_body)},this.unload=function(){t.close(),View.unload(this.html_id)},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()})}});