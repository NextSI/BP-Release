define([],function(){return function(i){"use strict";var a=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Tabela de Pre√ßos",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.btn_configuracao=this.dialog.find(".btn_configuracao"),this.somente_leitura=this.dialog.find(".somente_leitura"),this.somente_visualizar=this.dialog.find(".somente_visualizar"),this.div_carregar_mais=this.dialog.find(".div_carregar_mais"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.txt_carregar_mais=this.dialog.find(".txt_carregar_mais"),this.edt_filtro_descricao=this.dialog.find(".edt_filtro_descricao"),this.btn_limpar_filtro=this.dialog.find(".btn_limpar_filtro"),this.btn_filtra_descricao=this.dialog.find(".btn_filtra_descricao"),this.somente_consulta_tabela_precos="N",this.limite=0,this.limite_a_cada=30,this.bloqueia_limite=!0,this.show=function(){a.listar(!0),a.verifica_config()},this.verifica_config=function(){!0===App.sessao.dados.admin?a.btn_configuracao.removeClass("hidden"):a.btn_configuracao.addClass("hidden"),WS.get("tabela_precos/get_parametros/",null,function(i){a.somente_consulta_tabela_precos=i.somente_consulta_tabela_precos,"S"==a.somente_consulta_tabela_precos?(a.somente_leitura.addClass("hidden"),a.somente_visualizar.removeClass("hidden")):(a.somente_leitura.removeClass("hidden"),a.somente_visualizar.addClass("hidden"))})},this.listar=function(i){var t=a.tab_listagem.find("tbody"),e=t.find("tr:first");WS.get("tabela_precos/listar/",{limite:a.limite,limite_a_cada:a.limite_a_cada,filtro_descricao:a.edt_filtro_descricao.val()},function(n){a.div_carregar_mais.removeClass("hidden"),a.div_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.carregar_mais_registros),a.div_carregar_mais.find("span.btn_carregar_mais").find("span.icn_carregar_mais").remove(),a.div_carregar_mais.find("span.btn_carregar_mais").append('<span class="icn_carregar_mais fa fa-arrow-down"></span>'),n.length<a.limite_a_cada?a.bloqueia_limite=!0:a.bloqueia_limite=!1,i&&a.tab_listagem.find("tr:gt(1)").remove(),$(n).each(function(i,n){!function(i){var n=e.clone();n.removeAttr("template-row"),n.css("display",""),$(n.find("[template-field='descricao']")).text(i.descricao),$(n.find("[template-field='regiao_vendas_nome']")).text(null!=i.regiao_vendas_nome?i.regiao_vendas_nome:""),$(n.find(".btn_editar")).click(function(){"N"==a.somente_consulta_tabela_precos&&View.load("tabela_precos/detalhes",function(t,e){e.onclose=function(){a.listar(!0)},e.show(i.tabela_precos_id,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS)}),$(n.find(".btn_visualizar")).click(function(){View.load("tabela_precos/detalhes",function(t,e){e.onclose=function(){a.listar(!0)},e.show(i.tabela_precos_id,FORMULARIO.VISUALIZAR)},View.ABA.MULTIPLAS)}),$(n.find(".btn_excluir")).click(function(){"N"==a.somente_consulta_tabela_precos&&View.load("tabela_precos/detalhes",function(t,e){e.onclose=function(){a.listar(!0)},e.show(i.tabela_precos_id,FORMULARIO.EXCLUIR)},View.ABA.MULTIPLAS)}),n.appendTo(t)}(n)})})},this.btn_carregar_mais.unbind("click").click(function(){a.bloqueia_limite||($(this).find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),a.div_carregar_mais.find("span.btn_carregar_mais").find("span.icn_carregar_mais").remove(),a.div_carregar_mais.find("span.btn_carregar_mais").append('<span class="icn_carregar_mais fa fa-spinner fa-spin"></span>'),a.limite+=a.limite_a_cada,a.listar(!1))}),this.btn_filtra_descricao.unbind("click").click(function(i){a.listar(!0)}),this.btn_limpar_filtro.unbind("click"),this.btn_limpar_filtro.click(function(i){a.edt_filtro_descricao.val(""),a.listar(!0)}),this.btn_novo.unbind("click"),this.btn_novo.click(function(){"N"==a.somente_consulta_tabela_precos&&View.load("tabela_precos/detalhes",function(i,t){t.onclose=function(){a.listar(!0)},t.show(null,FORMULARIO.NOVO)},View.ABA.MULTIPLAS)}),this.btn_configuracao.unbind("click"),this.btn_configuracao.click(function(){View.load("tabela_precos/configuracoes",function(i,t){t.onclose=function(){a.verifica_config(),a.listar(!0)},t.show(null,FORMULARIO.NOVO)})}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){a.limite=0,a.listar(!0)}),this.unload=function(){View.unload(this.html_id)}}});