define([],function(){return function(t){"use strict";var i=this;this.html_id=t,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.onselect=null,this.onclose=null,this.tab_listagem=this.dialog.find(".tab_listagem"),this.edt_razao_social=this.dialog.find(".edt_razao_social"),this.edt_nome_fantasia=this.dialog.find(".edt_nome_fantasia"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_novo_cliente=this.dialog.find(".btn_novo_cliente"),this.edt_codigo=this.dialog.find(".edt_codigo"),this.usuario_id=null,this.arr_clientes=[],this.apenas_projetos=!1,this.show=function(t,a){i.onselect=t,show_modal(i.modal.attr("id")),set_focus(i.edt_nome_fantasia),void 0!==a&&null!=a&&""!=a&&(i.apenas_projetos=a)},this.close=function(){close_modal(i.modal.attr("id")),void 0!==i.onclose&&i.onclose&&i.onclose()},this.unload=function(){i.close(),View.unload(this.html_id)},this.listar=function(t){if(i.arr_clientes=[],""!=i.edt_razao_social.val().trim()||""!=i.edt_nome_fantasia.val().trim()||""!=i.edt_codigo.val().trim()){var a=i.apenas_projetos?"cliente/listar_clientes_projeto/":"cliente/listar/",e={razao_social:i.edt_razao_social.val(),nome_fantasia:i.edt_nome_fantasia.val(),codigo:i.edt_codigo.val()};WS.get(a,e,function(t){i.arr_clientes=t,i.render_lista()})}else i.render_lista()},this.render_lista=function(){var t=i.tab_listagem.find("tbody"),a=t.find("tr:first");i.tab_listagem.find("tr:gt(1)").remove(),$(i.arr_clientes).each(function(e,n){!function(e){var n=a.clone();n.removeAttr("template-row"),n.css("display",""),$(n.find("[template-field='codigo']")).text(e.codigo),$(n.find("[template-field='nome_fantasia']")).text(e.nome_fantasia),$(n.find("[template-field='razao_social']")).text(e.razao_social),$(n.find("[template-field='cnpj']")).text(e.cnpj);var o=$(n.find(".btn_selecionar")),l=function(){i.onselect(e),i.unload()};o.unbind("click"),o.click(l),n.dblclick(l),n.appendTo(t)}(n)})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_novo_cliente.unbind("click"),this.btn_novo_cliente.click(function(){View.load("cliente/detalhes",function(t,a){i.unload(),a.onclose=i.listar,a.show(null,FORMULARIO.NOVO)},View.ABA.MULTIPLAS)}),this.edt_codigo.unbind("keyup"),this.edt_codigo.keyup($.debounce(500,i.listar)),this.edt_razao_social.unbind("keyup"),this.edt_razao_social.keyup($.debounce(500,i.listar)),this.edt_nome_fantasia.unbind("keyup"),this.edt_nome_fantasia.keyup($.debounce(500,i.listar))}});