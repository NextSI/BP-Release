define([],function(){return function(i){"use strict";var t=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.onselect=null,this.onclose=null,this.edt_nome=this.dialog.find(".edt_nome"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.div_listar_tudo=this.dialog.find(".div_listar_tudo"),this.modal_selecionar=this.dialog.find(".modal_selecionar"),this.div_load=this.dialog.find(".div_load"),this.row_img=this.dialog.find('[template-row="img"]'),this.pasta_id=null,this.arr_documentos=[],this.limite=0,this.arr_documentos_total=[],this.show=function(i,o){t.onselect=i,t.pasta_id=o,show_modal(t.modal.attr("id")),set_focus(t.edt_nome_fantasia),t.listar()},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.listar=function(){var i={documento_pasta_id:t.pasta_id,limite:t.limite,documento_nome:t.edt_nome.val()};WS.get("documento/listar/",i,function(i){t.render_lista(i.documentos)})},this.render_lista=function(i){$(i).each(function(i,o){!function(i){var o=t.row_img.clone();o.removeAttr("template-row"),o.css("display",""),o.addClass("div_imgs");var e=$(o.find("[template-img='carrega_img']")),l=cripto(WS.token),n=WS_URI+"documento/download/?documento_revisao_id="+i.documento_revisao_id+"&token_publico="+l+"&tipo=S";"image/png"==i.mime_type||"image/bmp"==i.mime_type||"image/jpeg"==i.mime_type||"image/jpg"==i.mime_type||"image/gif"==i.mime_type?e.attr("src",n):e.attr("src","assets/img/icones_bp/file.svg"),$(o.find("[template-field='nome']")).text(i.nome);var a=function(){t.onselect(i),t.unload()};o.attr("title",i.nome),o.unbind("click"),o.click(a),o.dblclick(a),o.appendTo(t.div_listar_tudo)}(o)}),t.div_load.addClass("hidden")},this.modal_selecionar.unbind("scroll"),this.modal_selecionar.scroll(function(){t.modal_selecionar.scrollTop()+t.modal_selecionar.height()==t.modal_selecionar.get(0).scrollHeight&&(t.div_load.removeClass("hidden"),t.limite=t.limite+50,t.listar())}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()}),this.edt_nome.unbind("keyup"),this.edt_nome.keyup($.debounce(500,function(){t.div_listar_tudo.find(".div_imgs").remove(),t.limite=0,t.listar()}))}});