define([],function(){return function(a){"use strict";var t=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.div_alert=this.dialog.find(".div_alert"),this.tab_chamados=this.dialog.find(".tab_chamados"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.modal_atividade_id=null,this.show=function(a,i,s){t.modal_atividade_id=s,t.listar(a,i),show_modal(t.modal.attr("id"))},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.listar=function(a,i){var s=t.tab_chamados.find("tbody").find("tr:first");WS.get("chamado/listar/",{projeto_id:a,projeto_atividade_id:i},function(a){a.chamados.length<1?t.div_alert.removeClass("hidden"):t.div_alert.addClass("hidden"),$(a.chamados).each(function(a,i){!function(a){var i=s.clone();i.removeAttr("template-row"),i.css("display","");var e=null,o=a.data_abertura.substring(0,4),d=a.data_abertura.substring(5,7),n=a.data_abertura.substring(8,10)+"/"+d+"/"+o;if(null!=a.data_previsao_retorno){var l=a.data_previsao_retorno.substring(0,4),r=a.data_previsao_retorno.substring(5,7);e=a.data_previsao_retorno.substring(8,10)+"/"+r+"/"+l}var c=$(i.find("[template-field='detalhes']")).find(".btn_detalhes");c.addClass("btn"),c.addClass("btn-default"),c.addClass("btn_ver_chamado"),c.attr("value",a.id),c.append('<span class="glyphicon glyphicon-comment"></span>'),c.click(function(){close_modal(t.modal_atividade_id),t.unload(),View.loadReact(window.views.chamado.Detalhes.default,{chamadoId:a.id,onClose:function(){t.show()}},function(a,t){},View.ABA.MULTIPLAS)}),$('<span class="small">'),$(i.find("[template-field='id']")).append("#"+a.id+'<span class="small text-muted"> <br> Aberto em: <br>'+n+"</span>");var m=$(i.find("[template-field='cliente_fornecedor']"));null!=a.cliente_nome?m.text(a.cliente_nome):null!=a.fornecedor_nome&&m.text(a.fornecedor_nome),m.append('<br><span class="small text-muted">Responsável: <br>'+(a.usuario_responsavel_nome?a.usuario_responsavel_nome:"-")+"</span>");var _=Colors(a.motivo_cor);$(i.find("[template-field='motivo']")).append('<span class="badge"  style="background: '+_.hex+"; color: "+_.nome_hex+'; font-size: x-small">'+a.motivo+"</span><br>"+a.assunto),$(i.find("[template-field='situacao']")).append('<img src="assets/img/legenda/'+ChamadoImgSituacao(parseInt(a.situacao,10),"mini")+'">'+ChamadoDescSituacaoHumano(a.situacao,App.sessao.dados.tipo)+(4==a.situacao?"":'<br><span class="text-muted">Previsão de Retorno: <br>'+(a.data_previsao_retorno?e:"-")+"</span><br>"+(a.data_previsao_retorno?'<span style="padding-left: 4px;" class="label label-'+a.diff_datas.span+'">'+a.diff_datas.day_text+"</span>":"-"))),i.appendTo(t.tab_chamados)}(i)})})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()})}});