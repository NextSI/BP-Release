define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title=App.lang.tipo_item.aba_listar,this.onclose=null,this.params={limite:0},this.params_template={limite:0,considerar_bloqueado:!1},this.limite=0,this.incrementar_limite=!1,this.limite_a_cada=50,this.controle_ignore_error=!1,this.ultimo_limite_incrementado=0,this.bloqueia_limite=!1,this.btn_novo=this.dialog.find(".btn_novo"),this.btn_atualizar=this.dialog.find(".btn_atualizar"),this.btn_limpar_filtros=this.dialog.find(".btn_limpar_filtros"),this.btn_ordenacao=this.dialog.find(".orderbypointer"),this.btn_config=this.dialog.find(".btn_config"),this.btn_filtro=this.dialog.find(".btn_filtro"),this.container_filtro=this.dialog.find("[filtro]"),this.chk_mostrar_bloqueados=this.dialog.find(".chk_mostrar_bloqueados"),this.chk_codigo_automatico=this.dialog.find(".chk_codigo_automatico"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.tab_listagem=this.dialog.find(".tab_listagem").Tabela_Padrao_Next(),this.show=function(){i.inicializar_componentes(),i.listar(!0)},this.listar=function(a){if(void 0!==a&&"boolean"==typeof a||(a=!1),!i.bloqueia_limite){i.params.limite=i.limite,i.params.considerar_bloqueado=i.chk_mostrar_bloqueados.prop("checked");var t=function(a,t){t=extender_parametros({codigo:"-",descricao:"-"},t);var n=$.Tabela_Padrao_Next.create_row(i.tab_listagem),e=($.Tabela_Padrao_Next.getColumn(n,"codigo").text(t.codigo),$.Tabela_Padrao_Next.getColumn(n,"descricao").text(t.descricao),$.Tabela_Padrao_Next.getColumn(n,"acao")),o=$.Tabela_Padrao_Next.getColumn(e,"btn_visualizar"),r=$.Tabela_Padrao_Next.getColumn(e,"btn_editar"),s=$.Tabela_Padrao_Next.getColumn(e,"btn_excluir");o.unbind("click").click(function(a){i.evento_visualizar($(this),t)}),r.unbind("click").click(function(a){i.evento_editar($(this),t)}),s.unbind("click").click(function(a){i.evento_excluir($(this),t)}),$.Tabela_Padrao_Next.RenderRow(i.tab_listagem,n)};WS.get({route:"tipo_itens/listar/",data:i.params,func_response:function(n){if(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.carregar_mais_registros),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append(' <span class="icn_carregar_mais fa fa-arrow-down"></span>'),n){a&&(i.limite=i.limite+i.limite_a_cada);for(var e=0;e<n.length;e++){var o=n[e];t(0,o)}0==n.length&&(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.todos_carregados),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-check"></span>'),i.bloqueia_limite=!0)}},html_id:i.html_id,disable_buttons:[i.btn_atualizar,i.btn_limpar_filtros]})}},this.limpar_tabela=function(){$.Tabela_Padrao_Next.clear(i.tab_listagem),i.params.limite=0,i.limite=0,i.bloqueia_limite=!1},this.unload=function(){View.unload(this.html_id)},this.inicializar_componentes=function(){i.container_filtro.toggle(!1),0==App.sessao.dados.admin&&i.btn_config.remove(),$.Tabela_Padrao_Next.Filtros.Start(i.tab_listagem,{},function(a,t,n){i.params=extender_parametros(i.params_template,a),setTimeout(function(){i.evento_atualizar()},300)})},this.evento_atualizar=function(){i.limpar_tabela(),i.listar(!0)},this.evento_visualizar=function(a,t){View.load("tipo_itens/detalhes",function(a,n){var e={tipo:FORMULARIO.VISUALIZAR,tipo_itens_id:t.tipo_itens_id};n.onclose=function(){i.evento_atualizar()},n.show(e)},View.ABA.SIM)},this.evento_editar=function(a,t){View.load("tipo_itens/detalhes",function(a,n){var e={tipo:FORMULARIO.EDITAR,tipo_itens_id:t.tipo_itens_id};n.onclose=function(){i.evento_atualizar()},n.show(e)},View.ABA.SIM)},this.evento_excluir=function(a,t){View.load("tipo_itens/detalhes",function(a,n){var e={tipo:FORMULARIO.EXCLUIR,tipo_itens_id:t.tipo_itens_id};n.onclose=function(){i.evento_atualizar()},n.show(e)},View.ABA.SIM)},this.func_organizacao=function(a,t){i.limpar_tabela(),i.params=i.params_template,i.params.orderby=a,i.params.asc=t,setTimeout(function(){i.listar(!0)},300)},this.btn_atualizar.unbind("click").click(function(a){i.evento_atualizar()}),this.btn_limpar_filtros.unbind("click").click(function(a){$.tabela_padrao_bp_filtro("clean",i.html_id,i.tab_listagem),i.chk_mostrar_bloqueados.prop("checked",!1).trigger("change"),i.params=i.params_template,i.limpar_tabela(),i.listar(!0)}),this.btn_novo.unbind("click").click(function(a){View.load("tipo_itens/detalhes",function(a,t){t.onclose=function(){i.evento_atualizar()},t.show()},View.ABA.SIM)}),this.btn_ordenacao.unbind("click").click(function(a){var t=$(this),n=$(t).attr("data-ordername"),e=$(t).attr("data-asc");if(0===e.length){for(var o=0;o<i.btn_ordenacao.length;o++)if($(i.btn_ordenacao[o])!==$(t)){try{$(i.btn_ordenacao[o]).find(".icon_orderby").removeClass("fa-sort-up fa-sort-down").addClass("hidden fa-sort-down")}catch(a){}$(i.btn_ordenacao[o]).attr("data-asc","")}e=!0,$(t).attr("data-asc",e),$(t).find(".icon_orderby").removeClass("hidden")}else e=!(e="true"==e),$(t).attr("data-asc",e),$(t).find(".icon_orderby").toggleClass("fa-sort-down fa-sort-up");i.func_organizacao(n,e)}),this.btn_filtro.unbind("click").click(function(a){var t=$(this).prop("data-active");t=!t,$(this).prop("data-active",t),i.container_filtro.toggle(t)}),this.btn_config.unbind("click").click(function(a){View.load("tipo_itens/configuracao",function(a,i){i.show()})}),this.btn_carregar_mais.unbind("click").click(function(){i.bloqueia_limite||(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-spinner fa-spin">'),i.listar(!0))}),i.show()}});