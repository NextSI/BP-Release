define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.edt_data_feriado=this.dialog.find(".edt_data_feriado"),this.edt_feriado_inicio=this.dialog.find(".edt_feriado_inicio"),this.edt_feriado_fim=this.dialog.find(".edt_feriado_fim"),this.edt_nome_feriado=this.dialog.find(".edt_nome_feriado"),this.edt_descricao=this.dialog.find(".edt_descricao"),this.cbo_calendario_trabalho=this.dialog.find(".cbo_calendario_trabalho"),this.div_calendario_trabalho=this.dialog.find(".div_calendario_trabalho"),this.clockpicker=this.dialog.find(".clockpicker"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.id=null,this.show=function(a,e){switch(i.clockpicker.clockpicker(),e){case FORMULARIO.NOVO:i.btn_salvar.show(),i.btn_excluir.hide(),i.edt_feriado_inicio.val("00:00:00"),i.edt_feriado_fim.val("23:59:59"),i.permite_alterar(!0);break;case FORMULARIO.EDITAR:i.btn_salvar.show(),i.btn_excluir.hide(),i.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:i.btn_salvar.hide(),i.btn_excluir.hide(),i.permite_alterar(!1);break;case FORMULARIO.EXCLUIR:i.btn_salvar.hide(),i.btn_excluir.show(),i.permite_alterar(!1)}i.id=a,i.tipo=e,show_modal(i.modal.attr("id")),i.listar_calendario_trabalho()},this.preencher=function(){null!=i.id&&WS.get("feriado/objeto/",{id:i.id},function(a){set_datepicker(i.edt_data_feriado,a.data_feriado),i.edt_feriado_inicio.val(format_time(a.hora_inicio).substring(1)),i.edt_feriado_fim.val(format_time(a.hora_fim).substring(1)),i.edt_nome_feriado.val(a.nome),i.edt_descricao.val(a.descricao);for(var e=[],o=0;o<a.calendario_trabalho.length;o++){var d=a.calendario_trabalho[o];e.push(d.calendario_trabalho_id)}i.cbo_calendario_trabalho.selectpicker("val",e)})},this.permite_alterar=function(a){i.edt_data_feriado.prop("readonly",!a),i.edt_feriado_inicio.prop("readonly",!a),i.edt_feriado_fim.prop("readonly",!a),i.edt_nome_feriado.prop("readonly",!a),i.edt_descricao.prop("readonly",!a),i.cbo_calendario_trabalho.prop("disabled",!a)},this.listar_calendario_trabalho=function(){WS.get("calendario_trabalho/listar/",null,function(a){for(var e=0;e<a.length;e++){var o=a[e];add_option(i.cbo_calendario_trabalho,o.calendario_trabalho_id,o.nome)}i.cbo_calendario_trabalho.selectpicker({countSelectedText:function(a,i){return a+" calendários selecionados"}}),i.cbo_calendario_trabalho.selectpicker("refresh"),i.div_calendario_trabalho.removeClass("hidden"),i.preencher()})},this.close=function(){close_modal(i.modal.attr("id")),void 0!==i.onclose&&i.onclose&&i.onclose()},this.unload=function(){i.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){var a=new Validation;if(""!=get_datepicker(i.edt_data_feriado)&&null!=get_datepicker(i.edt_data_feriado)||a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Data do feriado"')),i.edt_feriado_inicio.val()||a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Hora início"')),i.edt_feriado_fim.val()||a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Hora fim"')),i.edt_nome_feriado.val()||a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Nome do feriado"')),i.cbo_calendario_trabalho.val().length||a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Calendário de trabalho"')),!a.is_valid())return alert_modal("Validação",a),!1;var e={id:i.id,data_feriado:get_datepicker(i.edt_data_feriado),hora_inicio:i.edt_feriado_inicio.val(),hora_fim:i.edt_feriado_fim.val(),nome:i.edt_nome_feriado.val(),descricao:i.edt_descricao.val(),calendario_trabalho:JSON.stringify(i.cbo_calendario_trabalho.val())};WS.post("feriado/salvar",e,function(a){alert_saved("Feriado salvo com sucesso"),i.unload()})}),this.btn_excluir.unbind("click").click(function(){WS.post("feriado/excluir",{id:i.id},function(a){alert_saved("Feriado "+a.nome+" excluído com sucesso"),i.unload()})})}});