define([],function(){return function(i){"use strict";var t=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.edt_email_atividade=this.dialog.find(".edt_email_atividade"),this.edt_mensagem=this.dialog.find(".edt_mensagem"),this.edt_mensagem_count=this.dialog.find(".edt_mensagem_count"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_enviar=this.dialog.find(".btn_enviar"),this.projeto_id=null,this.email_cliente=null,this.equipe=null,this.show=function(i,e,a){t.projeto_id=i,t.email_cliente=e,t.equipe=a,t.get_email(),show_modal(t.modal.attr("id")),set_focus(t.edt_email_atividade)},this.get_email=function(){var i=new Array;for(var e in t.edt_email_atividade.val(""),t.equipe)if("clean"!=e){var a=t.equipe[e];i.push(a.email),t.edt_email_atividade.val(t.email_cliente?t.email_cliente+";"+i:i)}},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.count_msg=function(){msg_count(t.edt_mensagem,t.edt_mensagem_count,500)},this.edt_mensagem.keyup(function(){t.count_msg()}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()}),this.btn_enviar.unbind("click"),this.btn_enviar.click(function(){WS.post("atividade_projeto/todas_atividades_email/",{mensagem:t.edt_mensagem.val(),emails:t.edt_email_atividade.val(),projeto_id:t.projeto_id},function(i){alert_saved("E-mails enviados com sucesso"),t.unload()},[t.btn_enviar,t.btn_cancelar])})}});