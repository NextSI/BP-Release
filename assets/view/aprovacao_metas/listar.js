define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Aprovação de Metas",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.filtro_atividades=this.dialog.find(".filtro_atividades"),this.div_carregar_mais=this.dialog.find(".div_carregar_mais"),this.btn_carregar_mais=this.dialog.find(".btn_carregar_mais"),this.status=0,this.pode_buscar=!0,this.limite=0,this.listar=function(){var a=i.tab_listagem.find("tbody"),t=a.find("tr:first");WS.get("atuacao_efetiva_possibilidade_acao/listar/",{status:i.status,acoes_24_horas:!0,limite:i.limite},function(s){i.div_carregar_mais.removeClass("hidden"),i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.carregar_mais_registros),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-arrow-down"></span>'),0==i.limite&&i.tab_listagem.find("tr:gt(1)").remove(),0===s.length&&(i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.todos_carregados),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-check"></span>'),i.pode_buscar=!1),i.pode_buscar&&s.length>0&&$.each(s,function(s,r){!function(s){var r=t.clone();r.removeAttr("template-row"),r.css("display","");var n=$(r.find("[template-field='unidade_medida']")),e="";switch(+s.tipo){case TIPO_OBJETIVO.INFORMATIVO:e="Informativo";break;case TIPO_OBJETIVO.PERCENTUAL:e="Percentual";break;case TIPO_OBJETIVO.VALOR:e="Valor";break;default:e=""}n.text(e);var _=$(r.find("[template-field='descricao']"));_.text(s.descricao),$(r.find("[template-field='meta_acao_24_horas']")).text(null!=s.meta_acao_24_horas&&""!=s.meta_acao_24_horas?s.meta_acao_24_horas:"<Sem descrição>"),$(r.find("[template-field='autor']")).text(null!=s.autor&&""!=s.autor?s.autor:"<Sem descrição>");var o=$(r.find(".btn_visualizar"));$(r.find(".btn_aprovar")),$(r.find(".btn_reprovar")),+s.status==STATUS_INDICADORES.EM_APROVACAO?(r.addClass("borda_neutro"),_.append('<span class="span_status cor_neutro">Em aprovação</span>')):+s.status==STATUS_INDICADORES.EM_ANDAMENTO?(r.addClass("borda_aprovado"),_.append('<span class="span_status cor_aprovado">Aprovado</span>')):+s.status==STATUS_INDICADORES.NAO_APROVADO?(r.addClass("borda_reprovado"),_.append('<span class="span_status cor_reprovado">Reprovado</span>')):(r.addClass("borda_neutro"),_.append('<span class="span_status cor_aguardando">Aguardando aprovação</span>')),o.unbind("click"),o.click(function(){View.load("atuacao_efetiva/metas_indicador_atuacao",function(a,t){t.show(s.id,s.atuacao_efetiva_id,s.indicador_id,s.atuacao_efetiva_avaliacao_id,s.status,s.descricao,s.usuario_id),t.onsave=function(a){i.listar()}})}),r.appendTo(a)}(r)})})},this.btn_carregar_mais.unbind("click").click(function(){i.btn_carregar_mais.find("span.txt_carregar_mais").text(App.lang.btn_carregar_mais.aguarde),i.btn_carregar_mais.find("span.icn_carregar_mais").remove(),i.btn_carregar_mais.append('<span class="icn_carregar_mais fa fa-spinner fa-spin">'),i.pode_buscar&&(i.limite=i.limite+20),i.listar()}),this.filtro_atividades.unbind("click"),this.filtro_atividades.change(function(a){i.status=$(a.target).val(),i.listar()}),this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("area/detalhes",function(a,t){t.onclose=i.listar,t.show(null,FORMULARIO.NOVO)})}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){i.listar()}),this.unload=function(){View.unload(this.html_id)}}});