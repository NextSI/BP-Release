define([],function(){return function(a){"use strict";var t=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.grid_pdca_atividade_historico=this.dialog.find(".grid_pdca_atividade_historico"),this.show=function(a,i){t.listar(a,i),show_modal(t.modal.attr("id"))},this.listar=function(a,i){var d={pdca_atividade_id:a,pdca_id:i};WS.get("pdca_atividade_historico/listar/",d,function(a){t.monta_grid(a)})},this.monta_grid=function(a){t.grid_pdca_atividade_historico.dxDataGrid({dataSource:a,rowAlternationEnabled:!1,showRowLines:!0,showBorders:!0,selection:{mode:"single"},noDataText:App.lang.dxDataGrid.noDataText,filterRow:{visible:!0},masterDetail:{enabled:!0,template:function(a,t){var i=t.data;$("<div>").dxDataGrid({columns:[{dataField:"situacao",customizeText:function(a){var t="";if(void 0!==a.value&&void 0!==a.target&&("filterPanel"==a.target||"row"==a.target)){switch(a.value){case PDCA_ATIVIDADE_SITUACAO.ABERTO:t="Aberto";break;case PDCA_ATIVIDADE_SITUACAO.ATRASADO:t="Atrasado";break;case PDCA_ATIVIDADE_SITUACAO.STANDBY:t="Stand By";break;case PDCA_ATIVIDADE_SITUACAO.CANCELADO:t="Cancelado";break;case PDCA_ATIVIDADE_SITUACAO.CONCLUIDO:t="Concluído";break;default:t=""}return t}}},{dataField:"ordem"},{dataField:"que"},{dataField:"porque",caption:"Por Quê"},{dataField:"quem"},{dataField:"onde"},{dataField:"data_inicio",dataType:"date",format:"dd/MM/yyyy",caption:"Data Início"},{dataField:"data_fim",dataType:"date",format:"dd/MM/yyyy"},{dataField:"como"},{dataField:"quanto",format:"decimal fixedPoint"},{dataField:"conclusao",caption:"Conclusão"},{dataField:"data_conclusao",caption:"Data Conclusão",dataType:"date",format:"dd/MM/yyyy"}],columnAutoWidth:!0,showBorders:!0,dataSource:[JSON.parse(i.colunas_alteradas)]}).appendTo(a)}},columns:[{caption:"Usuário",dataField:"nome"},{dataField:"data_alteracao",caption:"Data Alteração",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss"}]})},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()})}});