define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.btn_avaliar=this.dialog.find(".btn_avaliar"),this.optradio_sete_dias=this.dialog.find("[name=optradio_sete_dias]"),this.optradio_catorze_dias=this.dialog.find("[name=optradio_catorze_dias]"),this.optradio_vinte_um_dias=this.dialog.find("[name=optradio_vinte_um_dias]"),this.optradio_vinte_oito_dias=this.dialog.find("[name=optradio_vinte_oito_dias]"),this.optradio_trinta_dias=this.dialog.find("[name=optradio_trinta_dias]"),this.edt_data_base=this.dialog.find(".edt_data_base"),this.cbo_informativa_sete_dias=this.dialog.find(".cbo_informativa_sete_dias"),this.cbo_informativa_catorze_dias=this.dialog.find(".cbo_informativa_catorze_dias"),this.cbo_informativa_vinte_um_dias=this.dialog.find(".cbo_informativa_vinte_um_dias"),this.cbo_informativa_vinte_oito_dias=this.dialog.find(".cbo_informativa_vinte_oito_dias"),this.cbo_informativa_trinta_dias=this.dialog.find(".cbo_informativa_trinta_dias"),this.percentual_sete_dias=this.dialog.find(".percentual_sete_dias"),this.percentual_catorze_dias=this.dialog.find(".percentual_catorze_dias"),this.percentual_vinte_um_dias=this.dialog.find(".percentual_vinte_um_dias"),this.percentual_vinte_oito_dias=this.dialog.find(".percentual_vinte_oito_dias"),this.percentual_trinta_dias=this.dialog.find(".percentual_trinta_dias"),this.valor_sete_dias=this.dialog.find(".valor_sete_dias"),this.valor_catorze_dias=this.dialog.find(".valor_catorze_dias"),this.valor_vinte_um_dias=this.dialog.find(".valor_vinte_um_dias"),this.valor_vinte_oito_dias=this.dialog.find(".valor_vinte_oito_dias"),this.valor_trinta_dias=this.dialog.find(".valor_trinta_dias"),this.edt_percentual_sete_dias=this.dialog.find(".edt_percentual_sete_dias"),this.edt_percentual_catorze_dias=this.dialog.find(".edt_percentual_catorze_dias"),this.edt_percentual_vinte_um_dias=this.dialog.find(".edt_percentual_vinte_um_dias"),this.edt_percentual_vinte_oito_dias=this.dialog.find(".edt_percentual_vinte_oito_dias"),this.edt_percentual_trinta_dias=this.dialog.find(".edt_percentual_trinta_dias"),this.edt_valor_sete_dias=this.dialog.find(".edt_valor_sete_dias"),this.edt_valor_catorze_dias=this.dialog.find(".edt_valor_catorze_dias"),this.edt_valor_vinte_um_dias=this.dialog.find(".edt_valor_vinte_um_dias"),this.edt_valor_vinte_oito_dias=this.dialog.find(".edt_valor_vinte_oito_dias"),this.edt_valor_trinta_dias=this.dialog.find(".edt_valor_trinta_dias"),this.edt_acao_sete_dias=this.dialog.find(".edt_acao_sete_dias"),this.edt_acao_catorze_dias=this.dialog.find(".edt_acao_catorze_dias"),this.edt_acao_vinte_um_dias=this.dialog.find(".edt_acao_vinte_um_dias"),this.edt_acao_vinte_oito_dias=this.dialog.find(".edt_acao_vinte_oito_dias"),this.edt_acao_trinta_dias=this.dialog.find(".edt_acao_trinta_dias"),this.data_sete_dias=this.dialog.find(".data_sete_dias"),this.data_catorze_dias=this.dialog.find(".data_catorze_dias"),this.data_vinte_um_dias=this.dialog.find(".data_vinte_um_dias"),this.data_vinte_oito_dias=this.dialog.find(".data_vinte_oito_dias"),this.data_trinta_dias=this.dialog.find(".data_trinta_dias"),this.responsabilidade_escolhida=this.dialog.find(".responsabilidade_escolhida"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_salvar_enviar=this.dialog.find(".btn_salvar_enviar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.acao_id=0,this.competencias_essenciais_id=0,this.habilidade_id=0,this.avaliacao_id=0,this.usuario_id=0,this.agenda_gerada=null,this.selected_cbo_competencias_essenciais_id=null,this.show=function(a,e,t,_,d,s,o){i.usuario_id=s,i.agenda_gerada=o,i.avaliacao_id=d,i.btn_avaliar.addClass("hidden"),"S"!=App.sessao.dados.supervisor_empenho&&1!=App.sessao.dados.admin||i.btn_avaliar.removeClass("hidden"),i.competencias_essenciais_id=t,i.acao_id=e,i.habilidade_id=_,i.responsabilidade_escolhida.text(a),i.carrega_acoes_metas(),show_modal(i.modal.attr("id")),set_datepicker(i.edt_data_base,getDateNow(!0)),i.muda_data(new Date),i.edt_percentual_sete_dias.maskMoney({thousands:"",decimal:"",allowZero:!0,suffix:"",precision:0}),i.edt_percentual_catorze_dias.maskMoney({thousands:"",decimal:"",allowZero:!0,suffix:"",precision:0}),i.edt_percentual_vinte_um_dias.maskMoney({thousands:"",decimal:"",allowZero:!0,suffix:"",precision:0}),i.edt_percentual_vinte_oito_dias.maskMoney({thousands:"",decimal:"",allowZero:!0,suffix:"",precision:0}),i.edt_percentual_trinta_dias.maskMoney({thousands:"",decimal:"",allowZero:!0,suffix:"",precision:0}),i.edt_valor_sete_dias.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),i.edt_valor_catorze_dias.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),i.edt_valor_vinte_um_dias.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),i.edt_valor_vinte_oito_dias.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),i.edt_valor_trinta_dias.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),$('[name="optradio_sete_dias"]').change(function(a){var e=+$(this).filter('[name="optradio_sete_dias"]:checked').val();+e==TIPO_RESULTADO.INFORMATIVO?(i.percentual_sete_dias.hide(),i.valor_sete_dias.hide()):+e==TIPO_RESULTADO.PERCENTUAL?(i.percentual_sete_dias.show(),i.valor_sete_dias.hide()):+e==TIPO_RESULTADO.VALOR?(i.percentual_sete_dias.hide(),i.valor_sete_dias.show()):e==TIPO_RESULTADO.SEM_ACAO&&$('[name="optradio_sete_dias"]:last').prop("checked","checked")}),$('[name="optradio_catorze_dias"]').change(function(a){var e=+$(this).filter('[name="optradio_catorze_dias"]:checked').val();e==TIPO_RESULTADO.INFORMATIVO?(i.percentual_catorze_dias.hide(),i.valor_catorze_dias.hide()):e==TIPO_RESULTADO.PERCENTUAL?(i.percentual_catorze_dias.show(),i.valor_catorze_dias.hide()):e==TIPO_RESULTADO.VALOR?(i.percentual_catorze_dias.hide(),i.valor_catorze_dias.show()):e==TIPO_RESULTADO.SEM_ACAO&&$('[name="optradio_catorze_dias"]:last').prop("checked","checked")}),$('[name="optradio_vinte_um_dias"]').change(function(a){var e=+$(this).filter('[name="optradio_vinte_um_dias"]:checked').val();e==TIPO_RESULTADO.INFORMATIVO?(i.percentual_vinte_um_dias.hide(),i.valor_vinte_um_dias.hide()):e==TIPO_RESULTADO.PERCENTUAL?(i.percentual_vinte_um_dias.show(),i.valor_vinte_um_dias.hide()):e==TIPO_RESULTADO.VALOR?(i.percentual_vinte_um_dias.hide(),i.valor_vinte_um_dias.show()):e==TIPO_RESULTADO.SEM_ACAO&&$('[name="optradio_vinte_um_dias"]:last').prop("checked","checked")}),$('[name="optradio_vinte_oito_dias"]').change(function(a){var e=+$(this).filter('[name="optradio_vinte_oito_dias"]:checked').val();e==TIPO_RESULTADO.INFORMATIVO?(i.percentual_vinte_oito_dias.hide(),i.valor_vinte_oito_dias.hide()):e==TIPO_RESULTADO.PERCENTUAL?(i.percentual_vinte_oito_dias.show(),i.valor_vinte_oito_dias.hide()):e==TIPO_RESULTADO.VALOR?(i.percentual_vinte_oito_dias.hide(),i.valor_vinte_oito_dias.show()):e==TIPO_RESULTADO.SEM_ACAO&&$('[name="optradio_vinte_oito_dias"]:last').prop("checked","checked")}),$('[name="optradio_trinta_dias"]').change(function(a){var e=+$(this).filter('[name="optradio_trinta_dias"]:checked').val();e==TIPO_RESULTADO.INFORMATIVO?(i.percentual_trinta_dias.hide(),i.valor_trinta_dias.hide()):e==TIPO_RESULTADO.PERCENTUAL?(i.percentual_trinta_dias.show(),i.valor_trinta_dias.hide()):e==TIPO_RESULTADO.VALOR?(i.percentual_trinta_dias.hide(),i.valor_trinta_dias.show()):e==TIPO_RESULTADO.SEM_ACAO&&$('[name="optradio_trinta_dias"]:last').prop("checked","checked")})},i.edt_data_base.change(function(a){var e,t,_,d,s=a.currentTarget.value,o=(s=s.replace(/\//g,"-")).split("-");navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)?(d=o[2],_=+o[1]-1,t=o[0]):(d=o[0],_=o[1],t=o[2]),e=new Date(d,_,t),i.muda_data(e)}),this.muda_data=function(a){var e="";if(""!=a&&a instanceof Date)e=a;else{var t=a.split("-"),_=t[0],d=+t[1]-1,s=t[2].substring(0,2);e=new Date(_,d,s)}var o=new Date(e.addDay(7)),n=new Date(e.addDay(14)),r=new Date(e.addDay(21)),l=new Date(e.addDay(28)),c=new Date(e.addDay(30));i.data_sete_dias.text(new Date(o).toISOString().slice(0,10)),i.data_catorze_dias.text(new Date(n).toISOString().slice(0,10)),i.data_vinte_um_dias.text(new Date(r).toISOString().slice(0,10)),i.data_vinte_oito_dias.text(new Date(l).toISOString().slice(0,10)),i.data_trinta_dias.text(new Date(c).toISOString().slice(0,10)),i.data_sete_dias.text(new Date(o).today()),i.data_catorze_dias.text(new Date(n).today()),i.data_vinte_oito_dias.text(new Date(l).today()),i.data_trinta_dias.text(new Date(c).today()),i.data_vinte_um_dias.text(new Date(r).today())},this.btn_avaliar.unbind("click"),this.btn_avaliar.click(function(a){View.load("competencias_essenciais/avaliar",function(a,e){e.show(i.competencias_essenciais_id,i.habilidade_id,i.avaliacao_id,i.acao_id),e.onsave=function(a){i.onsave(a),i.unload()}})}),this.carrega_acoes_metas=function(){WS.get("competencias_essenciais_resultado_esperado/listar/",{competencias_essenciais_id:i.competencias_essenciais_id,habilidade_id:i.habilidade_id,avaliacao_id:i.avaliacao_id,acao_id:i.acao_id},function(a){var e=a;if(void 0!==e){var t=e.length>0?e[0].status:1;void 0!==e&&e.length>0&&(i.muda_data(e[0].data_base),set_datepicker(i.edt_data_base,e[0].data_base)),i.btn_avaliar.prop("disabled",!0),t==STATUS_INDICADORES.EM_APROVACAO&&(i.btn_salvar.addClass("hidden"),i.btn_salvar_enviar.addClass("hidden")),t!=STATUS_INDICADORES.EM_ANDAMENTO&&"S"!=App.sessao.dados.supervisor_empenho&&i.btn_avaliar.prop("disabled",!1),"S"!=App.sessao.dados.supervisor_empenho||1!=App.sessao.dados.admin?(i.btn_avaliar.prop("disabled",!0),t==STATUS_INDICADORES.NAO_INICIADO||t==STATUS_INDICADORES.NAO_APROVADO?(i.btn_salvar.removeClass("hidden"),i.btn_salvar_enviar.removeClass("hidden")):t!=STATUS_INDICADORES.EM_ANDAMENTO&&t!=STATUS_INDICADORES.EM_APROVACAO||(i.btn_salvar.addClass("hidden"),i.btn_salvar_enviar.addClass("hidden"),i.permite_alterar(!1))):(t==STATUS_INDICADORES.EM_ANDAMENTO||t==STATUS_INDICADORES.NAO_APROVADO?i.btn_avaliar.prop("disabled",!0):t==STATUS_INDICADORES.EM_APROVACAO&&i.btn_avaliar.prop("disabled",!1),App.sessao.dados.usuario_id==i.usuario_id?(i.btn_avaliar.addClass("hidden"),i.btn_salvar_enviar.addClass("hidden")):(i.btn_salvar.addClass("hidden"),i.btn_salvar_enviar.addClass("hidden"))),"S"==i.agenda_gerada&&(i.permite_alterar(!1),i.btn_salvar.prop("disabled",!0)),$.each(e,function(a,e){e.dias_periodo==RESULTADO_ESPERADO.SETE_DIAS?(i.edt_acao_sete_dias.val(e.descricao_acao).attr("competencias_essenciais_resultado_esperado_id",e.competencias_essenciais_resultado_esperado_id),i.cbo_informativa_sete_dias.val(e.informativa),i.edt_percentual_sete_dias.val(e.percentual),i.edt_valor_sete_dias.val(e.valor),$('[name="optradio_sete_dias"]').val([e.tipo]).change()):e.dias_periodo==RESULTADO_ESPERADO.CATORZE_DIAS?(i.edt_acao_catorze_dias.val(e.descricao_acao).attr("competencias_essenciais_resultado_esperado_id",e.competencias_essenciais_resultado_esperado_id),i.cbo_informativa_catorze_dias.val(e.informativa),i.edt_percentual_catorze_dias.val(e.percentual),i.edt_valor_catorze_dias.val(e.valor),$('[name="optradio_catorze_dias"]').val([e.tipo]).change()):e.dias_periodo==RESULTADO_ESPERADO.VINTE_UM_DIAS?(i.edt_acao_vinte_um_dias.val(e.descricao_acao).attr("competencias_essenciais_resultado_esperado_id",e.competencias_essenciais_resultado_esperado_id),i.cbo_informativa_vinte_um_dias.val(e.informativa),i.edt_percentual_vinte_um_dias.val(e.percentual),i.edt_valor_vinte_um_dias.val(e.valor),$('[name="optradio_vinte_um_dias"]').val([e.tipo]).change()):e.dias_periodo==RESULTADO_ESPERADO.VINTE_OITO_DIAS?(i.edt_acao_vinte_oito_dias.val(e.descricao_acao).attr("competencias_essenciais_resultado_esperado_id",e.competencias_essenciais_resultado_esperado_id),i.cbo_informativa_vinte_oito_dias.val(e.informativa),i.edt_percentual_vinte_oito_dias.val(e.percentual),i.edt_valor_vinte_oito_dias.val(e.valor),$('[name="optradio_vinte_oito_dias"]').val([e.tipo]).change()):e.dias_periodo==RESULTADO_ESPERADO.TRINTA_DIAS&&(i.edt_acao_trinta_dias.val(e.descricao_acao).attr("competencias_essenciais_resultado_esperado_id",e.competencias_essenciais_resultado_esperado_id),i.cbo_informativa_trinta_dias.val(e.informativa),i.edt_percentual_trinta_dias.val(e.percentual),i.edt_valor_trinta_dias.val(e.valor),$('[name="optradio_trinta_dias"]').val([e.tipo]).change())})}})},this.salva_dados_acoes_metas=function(a){var e=[{id:i.edt_acao_sete_dias.attr("competencias_essenciais_resultado_esperado_id"),descricao_acao:i.edt_acao_sete_dias.val(),tipo:i.optradio_sete_dias.filter(":checked").val(),informativa:"0"==i.optradio_sete_dias.filter(":checked").val()?"S":"N",percentual:i.edt_percentual_sete_dias.val(),valor:i.edt_valor_sete_dias.maskMoney("unmasked")[0],dias_periodo:RESULTADO_ESPERADO.SETE_DIAS},{id:i.edt_acao_catorze_dias.attr("competencias_essenciais_resultado_esperado_id"),descricao_acao:i.edt_acao_catorze_dias.val(),tipo:i.optradio_catorze_dias.filter(":checked").val(),informativa:"0"==i.optradio_catorze_dias.filter(":checked").val()?"S":"N",percentual:i.edt_percentual_catorze_dias.val(),valor:i.edt_valor_catorze_dias.maskMoney("unmasked")[0],dias_periodo:RESULTADO_ESPERADO.CATORZE_DIAS},{id:i.edt_acao_vinte_um_dias.attr("competencias_essenciais_resultado_esperado_id"),descricao_acao:i.edt_acao_vinte_um_dias.val(),tipo:i.optradio_vinte_um_dias.filter(":checked").val(),informativa:"0"==i.optradio_vinte_um_dias.filter(":checked").val()?"S":"N",percentual:i.edt_percentual_vinte_um_dias.val(),valor:i.edt_valor_vinte_um_dias.maskMoney("unmasked")[0],dias_periodo:RESULTADO_ESPERADO.VINTE_UM_DIAS},{id:i.edt_acao_vinte_oito_dias.attr("competencias_essenciais_resultado_esperado_id"),descricao_acao:i.edt_acao_vinte_oito_dias.val(),tipo:i.optradio_vinte_oito_dias.filter(":checked").val(),informativa:"0"==i.optradio_vinte_oito_dias.filter(":checked").val()?"S":"N",percentual:i.edt_percentual_vinte_oito_dias.val(),valor:i.edt_valor_vinte_oito_dias.maskMoney("unmasked")[0],dias_periodo:RESULTADO_ESPERADO.VINTE_OITO_DIAS},{id:i.edt_acao_trinta_dias.attr("competencias_essenciais_resultado_esperado_id"),descricao_acao:i.edt_acao_trinta_dias.val(),tipo:i.optradio_trinta_dias.filter(":checked").val(),informativa:"0"==i.optradio_trinta_dias.filter(":checked").val()?"S":"N",percentual:i.edt_percentual_trinta_dias.val(),valor:i.edt_valor_trinta_dias.maskMoney("unmasked")[0],dias_periodo:RESULTADO_ESPERADO.TRINTA_DIAS}];WS.post("competencias_essenciais_resultado_esperado/salvar/",{acoes:JSON.stringify(e),competencias_essenciais_id:i.competencias_essenciais_id,habilidade_id:i.habilidade_id,acao_id:i.acao_id,status:a,avaliacao_id:i.avaliacao_id,data_base:get_datepicker(i.edt_data_base)},function(e){alert_saved("Salvo com sucesso"),i.unload(a)})},this.close=function(a){close_modal(i.modal.attr("id")),void 0!==i.onclose&&i.onclose&&i.onclose(a)},this.unload=function(a){i.close(a),View.unload(this.html_id)},this.permite_alterar=function(a){$("[name='optradio_sete_dias']").prop("disabled",!a),$("[name='optradio_catorze_dias']").prop("disabled",!a),$("[name='optradio_vinte_um_dias']").prop("disabled",!a),$("[name='optradio_vinte_oito_dias']").prop("disabled",!a),$("[name='optradio_trinta_dias']").prop("disabled",!a),i.edt_percentual_sete_dias.prop("readonly",!a),i.edt_percentual_catorze_dias.prop("readonly",!a),i.edt_percentual_vinte_um_dias.prop("readonly",!a),i.edt_percentual_vinte_oito_dias.prop("readonly",!a),i.edt_percentual_trinta_dias.prop("readonly",!a),i.edt_acao_sete_dias.prop("readonly",!a),i.edt_acao_catorze_dias.prop("readonly",!a),i.edt_acao_vinte_um_dias.prop("readonly",!a),i.edt_acao_vinte_oito_dias.prop("readonly",!a),i.edt_acao_trinta_dias.prop("readonly",!a),i.edt_valor_trinta_dias.prop("readonly",!a),i.edt_valor_sete_dias.prop("readonly",!a),i.edt_data_base.prop("readonly",!a),i.edt_valor_vinte_oito_dias.prop("readonly",!a),i.edt_valor_catorze_dias.prop("readonly",!a),i.edt_valor_vinte_um_dias.prop("readonly",!a)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){i.salva_dados_acoes_metas()}),this.btn_salvar_enviar.unbind("click"),this.btn_salvar_enviar.click(function(){i.salva_dados_acoes_metas(STATUS_INDICADORES.EM_APROVACAO)})}});