define([],function(){return function(e){"use strict";var i=this;this.html_id=e,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.edt_nome=this.dialog.find(".edt_nome"),this.cbo_cor=this.dialog.find(".cbo_cor"),this.cor_exemplo=this.dialog.find(".cor_exemplo"),this.edt_notificar_antes=this.dialog.find(".edt_notificar_antes"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.chk_endereco_cliente=this.dialog.find(".chk_endereco_cliente"),this.div_endereco_cliente=this.dialog.find(".div_endereco_cliente"),this.chk_particular=this.dialog.find(".chk_particular"),this.tipo_agenda_id=null,this.show=function(e,t){for(var n=new Colors,a=0;a<n.length;a++)i.cbo_cor.append('<option value="'+n[a].hex+'" style="background:'+n[a].hex+"; color: "+n[a].nome_hex+'">'+n[a].nome+"</option>");switch(t){case FORMULARIO.NOVO:i.btn_salvar.show(),i.btn_excluir.hide(),i.permite_alterar(!0),i.cbo_cor.val("");break;case FORMULARIO.EDITAR:i.btn_salvar.show(),i.btn_excluir.hide(),i.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:i.btn_salvar.hide(),i.btn_excluir.hide(),i.permite_alterar(!1);break;case FORMULARIO.EXCLUIR:i.btn_salvar.hide(),i.btn_excluir.show(),i.permite_alterar(!1)}i.tipo=t,void 0!==e&&e&&(i.tipo_agenda_id=e,i.preencher()),show_modal(i.modal.attr("id")),set_focus(i.edt_nome)},this.close=function(){close_modal(i.modal.attr("id")),void 0!==i.onclose&&i.onclose&&i.onclose()},this.unload=function(){i.close(),View.unload(this.html_id)},this.cbo_cor_change=function(){i.cor_exemplo.css("background",i.cbo_cor.val()?i.cbo_cor.val():"")},this.permite_alterar=function(e){i.edt_nome.prop("readonly",!e),i.cbo_cor.prop("disabled",!e),i.cor_exemplo.prop("readonly",!e),i.chk_particular.prop("disabled",!e)},this.preencher=function(){WS.get("tipo_agenda/objeto/",{tipo_agenda_id:i.tipo_agenda_id},function(e){i.edt_nome.val(e.nome),i.cbo_cor.val(e.cor),i.chk_particular.prop("checked",e.particular).change(),i.chk_endereco_cliente.prop("checked",e.exibir_endereco_cliente).change(),i.edt_notificar_antes.val(e.notificar_antes?e.notificar_antes.substr(0,5):""),i.cbo_cor_change()})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){WS.post("tipo_agenda/salvar",{tipo_agenda_id:i.tipo_agenda_id,nome:i.edt_nome.val(),cor:i.cbo_cor.val(),particular:i.chk_particular.prop("checked"),exibir_endereco_cliente:i.chk_endereco_cliente.prop("checked"),notificar_antes:i.edt_notificar_antes.val()},function(e){i.tipo_agenda_id=e.tipo_agenda_id,alert_saved(e.nome+App.lang.alert_saved.salvo),i.unload()},[i.btn_salvar,i.btn_cancelar,i.btn_excluir])}),this.btn_excluir.unbind("click"),this.btn_excluir.click(function(){WS.post("tipo_agenda/excluir",{tipo_agenda_id:i.tipo_agenda_id},function(e){alert_saved(e.nome+App.lang.alert_saved.excluido),i.unload()},[i.btn_salvar,i.btn_cancelar,i.btn_excluir])}),this.chk_particular.unbind("change").change(function(){1==i.chk_particular.prop("checked")?i.div_endereco_cliente.hide():i.div_endereco_cliente.show()}),this.cbo_cor.change(function(){i.cbo_cor_change()})}});