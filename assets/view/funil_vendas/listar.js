define([],function(){return function(i){"use strict";var n=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Funil de Vendas",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.listar=function(){var i=n.tab_listagem.find("tbody"),t=i.find("tr:first");WS.get("funil_vendas/listar/",null,function(l){n.tab_listagem.find("tr:gt(1)").remove(),$(l).each(function(l,a){!function(l){var a=t.clone();a.removeAttr("template-row"),a.css("display",""),$(a.find("[template-field='nome']")).text(l.nome);var e=$(a.find("[template-field='padrao']"));"S"==l.padrao&&e.addClass("glyphicon-ok");var o=$(a.find(".btn_etiquetas"));o.unbind("click"),o.click(function(i){View.loadReact(window.views.etiqueta.Listagem.default,{pai_tabela:"funil_vendas",pai_id:l.id,titulo:l.nome},i=>{},View.ABA.MULTIPLAS)});var s=$(a.find(".btn_visualizar"));s.unbind("click"),s.click(function(){View.load("funil_vendas/detalhes",function(i,n){n.show(l.id,FORMULARIO.VISUALIZAR)})});var d=$(a.find(".btn_editar")),c=function(){View.load("funil_vendas/detalhes",function(i,t){t.onclose=n.listar,t.show(l.id,FORMULARIO.EDITAR,l.nome)},View.ABA.MULTIPLAS)};d.unbind("click"),d.click(c),a.dblclick(c);var u=$(a.find(".btn_excluir"));u.unbind("click"),u.click(function(){View.load("funil_vendas/detalhes",function(i,t){t.onclose=n.listar,t.show(l.id,FORMULARIO.EXCLUIR,l.nome)},View.ABA.MULTIPLAS)});var f=$(a.find(".btn_clonar"));f.unbind("click"),f.click(function(){View.load("funil_vendas/clonar",function(i,t){t.onclose=n.listar,t.show(l.nome,l.id)})});var r="";$(l.arr_etapas).each(function(i,n){r=r+n.nome+" > "}),null!=r&&(r=r.substring(r.length-2,0)),$(a.find("[template-field='etapas']")).text(r),a.appendTo(i)}(a)})})},this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("funil_vendas/detalhes",function(i,t){t.onclose=n.listar,t.show(null,FORMULARIO.NOVO)},View.ABA.MULTIPLAS)}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){n.listar()}),this.unload=function(){View.unload(this.html_id)},this.listar()}});