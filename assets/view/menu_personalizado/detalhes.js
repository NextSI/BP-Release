define(["react","react-dom"],function(e,a){return function(e){"use strict";var a=this;this.html_id=e,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.edt_nome_menu_personalizado=this.dialog.find(".edt_nome_menu_personalizado"),this.edt_url_menu_personalizado=this.dialog.find(".edt_url_menu_personalizado"),this.icone_menu=this.dialog.find(".icone_menu"),this.img_preview_icone=this.dialog.find(".img_preview_icone"),this.divPermissaoNecessaria=this.dialog.find(".divPermissaoNecessaria"),this.chk_menu_personalizado_ativo=this.dialog.find(".chk_menu_personalizado_ativo"),this.chk_aba_navegador=this.dialog.find(".chk_aba_navegador"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.id=null,this.tipo=null,this.permissao_necessaria=null,this.show=function(e,i){switch(i){case FORMULARIO.NOVO:a.chk_menu_personalizado_ativo.prop("checked",!0).trigger("change"),a.btn_salvar.show(),a.btn_excluir.hide(),a.permite_alterar(!0);break;case FORMULARIO.EDITAR:a.btn_salvar.show(),a.btn_excluir.hide(),a.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:a.btn_salvar.hide(),a.btn_excluir.hide(),a.permite_alterar(!1);break;case FORMULARIO.EXCLUIR:a.btn_salvar.hide(),a.btn_excluir.show(),a.permite_alterar(!1)}a.id=e,a.tipo=i,show_modal(a.modal.attr("id")),a.preencher()},this.preencher=function(){null!=a.id?WS.get("menu_personalizado/objeto/",{id:a.id},function(e){if(a.edt_nome_menu_personalizado.val(e.nome),a.edt_url_menu_personalizado.val(e.url_menu_personalizado),a.render_lista_permissoes(e.permissao_necessaria),a.chk_aba_navegador.prop("checked","S"==e.aba_navegador).trigger("change"),a.chk_menu_personalizado_ativo.prop("checked","S"==e.menu_personalizado_ativo).trigger("change"),null!==e.imagem_id&&""!==e.imagem_id&&+e.imagem_id>0){var i=WS_URI+"documento/midia/?&tamanho=20&documento_id="+e.imagem_id+"&token_midia="+App.sessao.token_midia;a.img_preview_icone.attr("src",i)}else null!==e.url_menu_img&&""!==e.url_menu_img?a.img_preview_icone.attr("src",e.url_menu_img):a.img_preview_icone.attr("src","assets/img/integracao.svg")}):(a.img_preview_icone.attr("src","assets/img/integracao.svg"),a.render_lista_permissoes())},this.permite_alterar=function(e){a.edt_nome_menu_personalizado.prop("readonly",!e),a.edt_url_menu_personalizado.prop("readonly",!e),a.icone_menu.prop("disabled",!e),a.chk_menu_personalizado_ativo.prop("disabled",!e),a.chk_aba_navegador.prop("disabled",!e)},this.render_lista_permissoes=function(e){e&&(a.permissao_necessaria=e),ReactDOM.render(React.createElement(window.components.ListagemPermissoes.default,{selecionado:e,aoAlterar:a.aoAlterarPermissao,readOnly:a.tipo!==FORMULARIO.EDITAR&&a.tipo!==FORMULARIO.NOVO,dropDownContainer:a.modal}),a.divPermissaoNecessaria[0])},this.aoAlterarPermissao=function(e,i){a.permissao_necessaria=e.chave||i.chave},this.aoAlterarIcone=function(e){var i=e.target.files[0],o=new FileReader;o.onload=function(e){a.img_preview_icone.attr("src",e.target.result)},o.readAsDataURL(i)},this.close=function(){close_modal(a.modal.attr("id")),void 0!==a.onclose&&a.onclose&&a.onclose()},this.unload=function(){a.close(),View.unload(this.html_id)},this.btn_cancelar.on("click",function(){a.unload()}),this.btn_salvar.on("click",function(){var e=new Validation;if(a.edt_nome_menu_personalizado.val()||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "Nome do menu"')),a.edt_url_menu_personalizado.val()||e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Preencha o campo: "URL do menu"')),!e.is_valid())return alert_modal("Validação",e),!1;var i=null;$.each(a.icone_menu,function(e,a){a.files.length>0&&(i=a.files[0])}),WS.post("menu_personalizado/salvar",{id:a.id,nome_menu_personalizado:a.edt_nome_menu_personalizado.val(),url_menu_personalizado:a.edt_url_menu_personalizado.val(),permissao_necessaria:a.permissao_necessaria,menu_personalizado_ativo:a.chk_menu_personalizado_ativo.prop("checked")?"S":"N",aba_navegador:a.chk_aba_navegador.prop("checked")?"S":"N",imagem_id:i},function(e){alert_saved("Menu salvo com sucesso"),a.unload()},[a.btn_salvar],null,!0)}),this.btn_excluir.on("click",function(){WS.post("menu_personalizado/excluir",{id:a.id},function(e){alert_saved("Menu "+e.nome+" excluído com sucesso"),a.unload()})}),this.icone_menu[0].addEventListener("change",a.aoAlterarIcone,!1)}});