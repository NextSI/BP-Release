define([],function(){return function(i){"use strict";var t=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Novo Substituto",this.cbo_usuario_substituido=this.dialog.find(".cbo_usuario_substituido"),this.cbo_usuario_substituto=this.dialog.find(".cbo_usuario_substituto"),this.edt_periodo_inicio=this.dialog.find(".edt_periodo_inicio"),this.edt_periodo_fim=this.dialog.find(".edt_periodo_fim"),this.substituto_documentos=this.dialog.find(".substituto_documentos"),this.substituto_processos=this.dialog.find(".substituto_processos"),this.substituto_projetos=this.dialog.find(".substituto_projetos"),this.substituto_chamados=this.dialog.find(".substituto_chamados"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.id=null,this.show=function(i,o){switch(o){case FORMULARIO.NOVO:t.btn_salvar.show(),t.btn_excluir.hide();break;case FORMULARIO.EDITAR:t.btn_salvar.show(),t.btn_excluir.show();break;case FORMULARIO.VISUALIZAR:t.btn_salvar.hide(),t.btn_excluir.hide();break;case FORMULARIO.EXCLUIR:t.btn_salvar.hide(),t.btn_excluir.show()}t.id=i,t.tipo=o,create_combobox(t.cbo_usuario_substituido,t.listar_usuario_substituido),create_combobox(t.cbo_usuario_substituto,t.listar_usuario_substituto),t.cbo_usuario_substituido.parent().find(".edt_combobox").attr("required","true"),t.cbo_usuario_substituto.parent().find(".edt_combobox").attr("required","true"),t.substituto_documentos.dxSwitch(),t.substituto_processos.dxSwitch(),t.substituto_projetos.dxSwitch(),t.substituto_chamados.dxSwitch(),t.preencher()},this.listar_usuario_substituido=function(i){var o={nome:t.cbo_usuario_substituido.parent().find(".edt_combobox").val(),modulo:MODULOS.DOCUMENTO,limite:0};WS.get("usuario/listar/",o,function(o){limpar_combobox(t.cbo_usuario_substituido),$(o).each(function(i,o){var s=[];s.Nome=o.nome;var u=$('<span class="label lb_tipo" style="margin: 5px;"></span>');u.addClass("label-info"),u.text("U"),u.attr("tipo","usuarios"),u.tooltip(),add_option_combobox(t.cbo_usuario_substituido,i,o.usuario_id>0?o.usuario_id:null,s,u,JSON.stringify(o))}),o.length>0&&i(!0)})},this.listar_usuario_substituto=function(i){var o={nome:t.cbo_usuario_substituto.parent().find(".edt_combobox").val(),modulo:MODULOS.DOCUMENTO,limite:0};WS.get("usuario/listar/",o,function(o){limpar_combobox(t.cbo_usuario_substituto),$(o).each(function(i,o){var s=[];s.Nome=o.nome;var u=$('<span class="label lb_tipo" style="margin: 5px;"></span>');u.addClass("label-info"),u.text("U"),u.attr("tipo","usuarios"),u.tooltip(),add_option_combobox(t.cbo_usuario_substituto,i,o.usuario_id>0?o.usuario_id:null,s,u,JSON.stringify(o))}),o.length>0&&i(!0)})},this.preencher=function(){null!=t.id&&WS.get("substituto/objeto/",{id:t.id},function(i){t.title=i.usuario_substituido_nome+" > "+i.usuario_substituto_nome,App.titulo_aba(t.html_id,t.title),set_value_combobox(t.cbo_usuario_substituido,i.usuario_substituido_id,i.usuario_substituido_nome),set_value_combobox(t.cbo_usuario_substituto,i.usuario_substituto_id,i.usuario_substituto_nome),set_datepicker(t.edt_periodo_inicio,i.periodo_inicio),set_datepicker(t.edt_periodo_fim,i.periodo_fim),t.substituto_documentos.dxSwitch("instance").option("value","S"==i.substituir_modulo_ged),t.substituto_processos.dxSwitch("instance").option("value","S"==i.substituir_modulo_processos),t.substituto_projetos.dxSwitch("instance").option("value","S"==i.substituir_modulo_projetos),t.substituto_chamados.dxSwitch("instance").option("value","S"==i.substituir_modulo_chamados)})},this.close=function(){void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){if(validateForm())alert_fail("Preencha os campos obrigatórios");else{var i={id:t.id,usuario_substituido_id:get_value_combobox(t.cbo_usuario_substituido),usuario_substituto_id:get_value_combobox(t.cbo_usuario_substituto),periodo_inicio:get_datepicker(t.edt_periodo_inicio),periodo_fim:get_datepicker(t.edt_periodo_fim),substituir_modulo_ged:t.substituto_documentos.dxSwitch("instance").option("value")?"S":"N",substituir_modulo_processos:t.substituto_processos.dxSwitch("instance").option("value")?"S":"N",substituir_modulo_projetos:t.substituto_projetos.dxSwitch("instance").option("value")?"S":"N",substituir_modulo_chamados:t.substituto_chamados.dxSwitch("instance").option("value")?"S":"N"};if(i.periodo_inicio>i.periodo_fim)return alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Data Inválida !'," Atenção a data de Fim do período não pode ser maior que o Inicio do período."),!1;WS.post("substituto/salvar",i,function(i){alert_saved("Usuario substito salvo com sucesso"),t.unload()})}}),this.btn_excluir.unbind("click").click(function(){$(function(){DevExpress.ui.dialog.confirm("<i>"+App.lang.generico.questionar_apagar_registro+"</i>",App.lang.generico.apagar_registro).done(function(i){i&&WS.post("substituto/excluir",{id:t.id},function(i){alert_saved("Substituto excluido com sucesso"),t.unload()})})})})}});